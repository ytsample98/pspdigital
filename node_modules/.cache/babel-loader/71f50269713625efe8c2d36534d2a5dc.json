{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\College\\\\admin\\\\StarAdmin-Free-React-Admin-Template-master\\\\template\\\\demo_1\\\\src\\\\app\\\\panelone\\\\Quote.js\";\nimport React, { Component } from 'react';\nimport { Form } from 'react-bootstrap';\nimport bsCustomFileInput from 'bs-custom-file-input';\nimport { db } from '../../firebase';\nimport { collection, getDocs, addDoc, doc, updateDoc } from 'firebase/firestore';\nimport { withRouter } from 'react-router-dom';\nimport html2canvas from 'html2canvas';\nimport { jsPDF } from 'jspdf';\nimport { recalculateTotals, getTaxDetailsFromGroup } from './calculation';\nimport { toWords } from 'number-to-words';\nconst amount = 12345678;\nconst amountWords = `INR ${toWords(amount)} Only`;\nconsole.log(amountWords);\n\nclass Quote extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      activeTab: 'co',\n      quotes: [],\n      customers: [],\n      products: [],\n      despatchModes: [],\n      paymentTerms: [],\n      showForm: false,\n      showTaxOverlay: false,\n      currentTaxLineIdx: null,\n      editingId: null,\n      overlayType: '',\n      overlaySearch: '',\n      productOverlayVisible: false,\n      productOverlaySearch: '',\n      selectedProductIds: [],\n      selectedTaxGroups: [],\n      taxComponents: [],\n      taxGroups: [],\n      previewMode: false,\n      selectedQuote: null,\n      breakdownItems: [],\n      breakdownType: 'Percentage',\n      breakdownSelectAll: false,\n      showSubProductDialog: false,\n      currentBreakdownIdx: null,\n      subProductForm: {\n        name: '',\n        value: '',\n        type: 'Amount',\n        dueDate: ''\n      },\n      formData: {\n        quoteNo: '',\n        quoteDate: new Date().toISOString().split('T')[0],\n        quoteType: 'Standard',\n        customer: '',\n        status: 'Entered',\n        // Static 'Entered'\n        choose: 'Service',\n        qrefNo: '',\n        impExp: 'None',\n        currency: '',\n        conversionRate: '',\n        taxAmount: '',\n        quoteValue: '',\n        billTo: '',\n        shipTo: '',\n        despatchMode: 'By Air',\n        paymentTerms: '',\n        freightCharges: '',\n        freighttaxAmount: '',\n        taxPercent: '',\n        packingCharges: '',\n        lineItems: []\n      }\n    };\n    this.customerInputRef = React.createRef();\n\n    this.formatAddress = addr => {\n      if (!addr) return '';\n      if (typeof addr === 'string') return addr;\n      return [addr.address, [addr.city, addr.state, addr.country].filter(Boolean).join(', '), addr.zip].filter(Boolean).join('\\n');\n    };\n\n    this.handleLineItemChange = (idx, field, value) => {\n      const updatedItems = [...this.state.formData.lineItems];\n      updatedItems[idx] = { ...updatedItems[idx],\n        [field]: value\n      };\n      const {\n        updatedLineItems,\n        freighttaxAmount,\n        taxAmount,\n        quoteValue\n      } = recalculateTotals({\n        lineItems: updatedItems,\n        freightCharges: this.state.formData.freightCharges,\n        packingCharges: this.state.formData.packingCharges,\n        taxPercent: this.state.formData.taxPercent,\n        taxGroups: this.state.taxGroups\n      });\n      this.setState(prev => ({\n        formData: { ...prev.formData,\n          lineItems: updatedLineItems,\n          freighttaxAmount,\n          taxAmount,\n          quoteValue\n        }\n      }));\n    };\n\n    this.fetchTaxGroups = async () => {\n      const snap = await getDocs(collection(db, 'taxGroups'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        taxGroups: data\n      });\n    };\n\n    this.fetchQuotes = async () => {\n      const snap = await getDocs(collection(db, 'quotes'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        quotes: data.reverse()\n      });\n    };\n\n    this.fetchCustomers = async () => {\n      const snap = await getDocs(collection(db, 'customers'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        customers: data\n      });\n    };\n\n    this.fetchProducts = async () => {\n      const snap = await getDocs(collection(db, 'products'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        products: data\n      });\n    };\n\n    this.fetchDespatchModes = async () => {\n      const snap = await getDocs(collection(db, 'modes'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        despatchModes: data\n      });\n    };\n\n    this.fetchPaymentTerms = async () => {\n      const snap = await getDocs(collection(db, 'paymentTerms'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        paymentTerms: data\n      });\n    };\n\n    this.toggleTaxGroupSelection = (groupName, lineIdx, checked) => {\n      this.setState(prev => {\n        const lineItems = [...prev.formData.lineItems];\n        const item = { ...lineItems[lineIdx]\n        };\n        let taxGroupNames = Array.isArray(item.taxGroupNames) ? [...item.taxGroupNames] : [];\n\n        if (checked) {\n          if (!taxGroupNames.includes(groupName)) taxGroupNames.push(groupName);\n        } else {\n          taxGroupNames = taxGroupNames.filter(g => g !== groupName);\n        }\n\n        item.taxGroupNames = taxGroupNames;\n        item.taxGroupName = taxGroupNames.join(', ');\n        lineItems[lineIdx] = item;\n        const {\n          updatedLineItems,\n          freighttaxAmount,\n          taxAmount,\n          quoteValue\n        } = recalculateTotals({\n          lineItems,\n          freightCharges: prev.formData.freightCharges,\n          packingCharges: prev.formData.packingCharges,\n          taxPercent: prev.formData.taxPercent,\n          taxGroups: prev.taxGroups\n        });\n        return {\n          formData: { ...prev.formData,\n            lineItems: updatedLineItems,\n            freighttaxAmount,\n            taxAmount,\n            quoteValue\n          }\n        };\n      });\n    };\n\n    this.handleInputChange = (field, value) => {\n      this.setState(prev => ({\n        formData: { ...prev.formData,\n          [field]: value\n        }\n      }), () => {\n        if (['freightCharges', 'taxPercent', 'packingCharges'].includes(field)) {\n          const {\n            updatedLineItems,\n            freighttaxAmount,\n            taxAmount,\n            quoteValue\n          } = recalculateTotals({\n            lineItems: this.state.formData.lineItems,\n            freightCharges: this.state.formData.freightCharges,\n            packingCharges: this.state.formData.packingCharges,\n            taxPercent: this.state.formData.taxPercent,\n            taxGroups: this.state.taxGroups\n          });\n          this.setState(prev => ({\n            formData: { ...prev.formData,\n              lineItems: updatedLineItems,\n              freighttaxAmount,\n              taxAmount,\n              quoteValue\n            }\n          }));\n        }\n      });\n    };\n\n    this.handleBreakdownSelectAll = checked => {\n      this.setState(prev => ({\n        breakdownSelectAll: checked,\n        breakdownItems: prev.breakdownItems.map(item => ({ ...item,\n          selected: checked\n        }))\n      }));\n    };\n\n    this.handleBreakdownRowSelect = (idx, checked) => {\n      this.setState(prev => {\n        const items = [...prev.breakdownItems];\n        items[idx].selected = checked;\n        return {\n          breakdownItems: items\n        };\n      });\n    };\n\n    this.handleBreakdownTypeChange = type => {\n      this.setState({\n        breakdownType: type\n      });\n    };\n\n    this.handleBreakdownValueChange = (idx, value) => {\n      this.setState(prev => {\n        const items = [...prev.breakdownItems];\n        items[idx].value = value;\n        return {\n          breakdownItems: items\n        };\n      });\n    };\n\n    this.handleBreakdownDateChange = (idx, value) => {\n      this.setState(prev => {\n        const items = [...prev.breakdownItems];\n        items[idx].lastDate = value;\n        return {\n          breakdownItems: items\n        };\n      });\n    };\n\n    this.saveBreakdownToSession = () => {\n      sessionStorage.setItem('breakdownItems', JSON.stringify(this.state.breakdownItems));\n    };\n\n    this.loadBreakdownFromSession = () => {\n      const data = sessionStorage.getItem('breakdownItems');\n      if (data) this.setState({\n        breakdownItems: JSON.parse(data)\n      });\n    };\n\n    this.handleSubmit = async e => {\n      e.preventDefault();\n      const {\n        editingId,\n        formData,\n        quotes\n      } = this.state;\n      if (!formData.customer) return alert(\"Customer is required\");\n      if (formData.lineItems.length === 0) return alert(\"At least one line item is required\");\n\n      if (editingId) {\n        await updateDoc(doc(db, 'quotes', editingId), formData);\n      } else {\n        formData.quoteNo = `QT${1000 + quotes.length}`;\n        await addDoc(collection(db, 'quotes'), formData);\n      }\n\n      this.setState({\n        showForm: false,\n        editingId: null\n      });\n      this.fetchQuotes();\n    };\n\n    this.loadQuotePreview = q => {\n      this.setState({\n        selectedQuote: q,\n        previewMode: true\n      });\n    };\n\n    this.loadQuoteForEdit = quote => {\n      this.setState({\n        formData: { ...quote,\n          lineItems: Array.isArray(quote.lineItems) ? quote.lineItems : [] // Ensure array\n\n        },\n        editingId: quote.id,\n        showForm: true,\n        previewMode: false,\n        activeTab: 'co'\n      }, () => {\n        if (this.customerInputRef.current) {\n          this.customerInputRef.current.value = quote.customer;\n        }\n      });\n    };\n\n    this.convertToOrder = quote => {\n      // Save quote in sessionStorage (or navigate with state via router if you use react-router)\n      sessionStorage.setItem('quoteToConvert', JSON.stringify(quote));\n      this.props.history.push('/panelone/Order');\n    };\n\n    this.showQuotePDFWithOrg = async quote => {\n      var _orgSnap$docs$, _quote$billTo, _quote$shipTo;\n\n      if (!quote || !Array.isArray(quote.lineItems) || quote.lineItems.length === 0) {\n        alert(\"Quote data is incomplete.\");\n        return;\n      } // 1. Fetch org and customer data\n\n\n      const orgSnap = await getDocs(collection(db, 'businessGroups'));\n      const org = ((_orgSnap$docs$ = orgSnap.docs[0]) === null || _orgSnap$docs$ === void 0 ? void 0 : _orgSnap$docs$.data()) || {};\n      const customer = this.state.customers.find(c => c.custshortName === quote.customer || c.custname === quote.customer) || {}; // GST State Map for Place of Supply\n\n      const gstStateMap = {\n        \"01\": \"Jammu & Kashmir\",\n        \"02\": \"Himachal Pradesh\",\n        \"03\": \"Punjab\",\n        \"04\": \"Chandigarh\",\n        \"05\": \"Uttarakhand\",\n        \"06\": \"Haryana\",\n        \"07\": \"Delhi\",\n        \"08\": \"Rajasthan\",\n        \"09\": \"Uttar Pradesh\",\n        \"10\": \"Bihar\",\n        \"11\": \"Sikkim\",\n        \"12\": \"Arunachal Pradesh\",\n        \"13\": \"Nagaland\",\n        \"14\": \"Manipur\",\n        \"15\": \"Mizoram\",\n        \"16\": \"Tripura\",\n        \"17\": \"Meghalaya\",\n        \"18\": \"Assam\",\n        \"19\": \"West Bengal\",\n        \"20\": \"Jharkhand\",\n        \"21\": \"Odisha\",\n        \"22\": \"Chhattisgarh\",\n        \"23\": \"Madhya Pradesh\",\n        \"24\": \"Gujarat\",\n        \"25\": \"Daman and Diu\",\n        \"26\": \"Dadra and Nagar Haveli\",\n        \"27\": \"Maharashtra\",\n        \"28\": \"Andhra Pradesh (Old)\",\n        \"29\": \"Karnataka\",\n        \"30\": \"Goa\",\n        \"31\": \"Lakshadweep\",\n        \"32\": \"Kerala\",\n        \"33\": \"Tamil Nadu\",\n        \"34\": \"Puducherry\",\n        \"35\": \"Andaman and Nicobar Islands\",\n        \"36\": \"Telangana\",\n        \"37\": \"Andhra Pradesh\",\n        \"97\": \"Other Territory\"\n      }; // Helper for Place of Supply\n\n      const getPlaceOfSupply = gstin => {\n        if (!gstin || gstin.length < 2) return '';\n        const code = gstin.substring(0, 2);\n        const state = gstStateMap[code];\n        return state ? `${code} - ${state}` : '';\n      }; // 2. Enrich line items\n\n\n      const enrichedItems = quote.lineItems.map(item => {\n        const product = this.state.products.find(p => p.productId === item.itemCode) || {};\n        return { ...item,\n          ptshortName: product.ptshortName || '',\n          hsnCode: product.hsnCode || '',\n          uom: product.stockingUOM || '',\n          cgst: item.cgst || 0,\n          sgst: item.sgst || 0,\n          igst: item.igst || 0,\n          taxGroupNames: item.taxGroupNames || (item.taxGroupName ? item.taxGroupName.split(',').map(s => s.trim()) : [])\n        };\n      }); // 3. Subtotal (without tax)\n\n      const subtotal = enrichedItems.reduce((sum, item) => sum + (parseFloat(item.unitPrice) || 0) * (parseFloat(item.qty) || 0), 0);\n      const freightCharges = parseFloat(quote.freightCharges || 0);\n      const freightTax = parseFloat(quote.freighttaxAmount || 0);\n      const totalTaxAmount = parseFloat(quote.taxAmount || 0);\n      const grandTotal = parseFloat(quote.quoteValue || subtotal + totalTaxAmount);\n      const amountWords = `INR ${toWords(Math.floor(grandTotal))} Only`; // 4. Tax breakdown by group\n\n      let taxBreakdown = {};\n      let taxGroupDetails = [];\n      let sno = 1;\n      enrichedItems.forEach(item => {\n        const qty = parseFloat(item.qty || 0);\n        const unitPrice = parseFloat(item.unitPrice || 0);\n        const base = qty * unitPrice;\n        (item.taxGroupNames || []).forEach(tgName => {\n          // Find group in taxGroups\n          const group = (this.state.taxGroups || []).find(g => g.groupName === tgName);\n\n          if (group) {\n            group.lineItems.forEach(li => {\n              const key = `${tgName} - ${li.component} (${li.percentOrAmt}${li.type === 'Amount' ? '' : '%'})`;\n              let taxAmt = 0;\n              if (li.type === 'Amount') taxAmt = parseFloat(li.percentOrAmt || 0);else taxAmt = base * parseFloat(li.percentOrAmt || 0) / 100;\n              taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\n              taxGroupDetails.push({\n                sno: sno++,\n                group: tgName,\n                peramt: `${li.percentOrAmt}${li.type === 'Amount' ? '' : '%'}`,\n                taxAmt: taxAmt.toFixed(2)\n              });\n            });\n          }\n        }); // Legacy support for cgst/sgst/igst\n\n        if (item.cgst) {\n          const key = `CGST ${item.cgst}%`;\n          const taxAmt = base * item.cgst / 100;\n          taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\n          taxGroupDetails.push({\n            sno: sno++,\n            group: key,\n            peramt: `${item.cgst}%`,\n            taxAmt: taxAmt.toFixed(2)\n          });\n        }\n\n        if (item.sgst) {\n          const key = `SGST ${item.sgst}%`;\n          const taxAmt = base * item.sgst / 100;\n          taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\n          taxGroupDetails.push({\n            sno: sno++,\n            group: key,\n            peramt: `${item.sgst}%`,\n            taxAmt: taxAmt.toFixed(2)\n          });\n        }\n\n        if (item.igst) {\n          const key = `IGST ${item.igst}%`;\n          const taxAmt = base * item.igst / 100;\n          taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\n          taxGroupDetails.push({\n            sno: sno++,\n            group: key,\n            peramt: `${item.igst}%`,\n            taxAmt: taxAmt.toFixed(2)\n          });\n        }\n      });\n\n      if (freightTax > 0) {\n        taxBreakdown[\"Freight Tax\"] = freightTax;\n        taxGroupDetails.push({\n          sno: sno++,\n          group: \"Freight Tax\",\n          peramt: \"-\",\n          taxAmt: freightTax.toFixed(2)\n        });\n      } // 5. Milestone breakdown (with subproducts)\n\n\n      const {\n        breakdownItems,\n        breakdownType\n      } = this.state; // 6. Build HTML for PDF\n\n      const container = document.createElement('div');\n      container.id = 'pdf-preview-container';\n      container.style.width = '794px';\n      container.style.padding = '40px';\n      container.style.fontFamily = 'Arial'; // 7. Main PDF content\n\n      container.innerHTML = `\n    <div style=\"display:flex; justify-content:space-between; align-items:center;\">\n      <img src=\"${org.logoUrl || ''}\" style=\"height:50px;\" />\n      <div style=\"font-size:18px; font-weight:bold;\">QUOTATION</div>\n    </div>\n    <hr/>\n    <div style=\"display:flex; justify-content:space-between; font-size:11px;\">\n      <div style=\"line-height:1.5; width:50%;\">\n        <b>${org.bgName || ''}</b><br/>\n        ${org.address || ''}<br/>\n        <b>Email:</b> ${org.email || ''}<br/>\n        <b>Website:</b> ${org.website || ''}<br/>\n        <b>GSTIN:</b> ${org.gstin || ''}<br/>\n        <b>Mobile:</b> ${org.mobile || ''}<br/>\n        <b>CIN:</b> ${org.cin || ''}\n      </div>\n      <table style=\"font-size:11px; text-align:left;\">\n        <tr><td><b>Quote No</b></td><td>: ${quote.quoteNo}</td></tr>\n        <tr><td><b>Quote Date</b></td><td>: ${quote.quoteDate}</td></tr>\n        <tr><td><b>Currency</b></td><td>: ${quote.currency || 'INR'}</td></tr>\n        <tr><td><b>Despatch</b></td><td>: ${quote.despatchMode || ''}</td></tr>\n      </table>\n    </div>\n\n    <div style=\"margin-top:15px; display:flex; justify-content:space-between; font-size:11px;\">\n      <div style=\"width:48%;\">\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Bill To</b>\n        <div style=\"border:1px solid #ccc; padding:6px;\">\n         <b>${quote.customer || ''}</b><br/>\n          ${((_quote$billTo = quote.billTo) === null || _quote$billTo === void 0 ? void 0 : _quote$billTo.replace(/\\n/g, '<br/>')) || ''}\n        </div>\n        <div style=\"font-size:10px; margin-top:6px;\">\n            <b>GSTIN:</b> ${customer.gstin || ''}<br/>\n            <b>Email:</b> ${customer.email || ''}<br/>\n            <b>Contact:</b> ${customer.contactPerson || ''}<br/>\n            <b>Phone:</b> ${customer.phone || ''}\n        </div>\n      </div>\n      <div style=\"width:48%;\">\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Ship To</b>\n        <div style=\"border:1px solid #ccc; padding:6px;\">\n         <b>${quote.customer || ''}</b><br/>\n          ${((_quote$shipTo = quote.shipTo) === null || _quote$shipTo === void 0 ? void 0 : _quote$shipTo.replace(/\\n/g, '<br/>')) || ''}\n        </div>\n        <div style=\"font-size:10px; margin-top:6px;\">\n          <b>Place of Supply:</b> ${getPlaceOfSupply(customer.gstin || '')}\n        </div>\n      </div>\n    </div>\n\n    <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\n      <thead>\n        <tr style=\"background:#f4f6fa;\">\n          <th style=\"border:1px solid #011b56;\">Item Code</th>\n          <th style=\"border:1px solid #011b56;\">Description</th>\n          <th style=\"border:1px solid #011b56;\">HSN</th>\n          <th style=\"border:1px solid #011b56;\">UOM</th>\n          <th style=\"border:1px solid #011b56;\">Qty</th>\n          <th style=\"border:1px solid #011b56;\">Unit Price</th>\n          <th style=\"border:1px solid #011b56;\">GST%</th>\n          <th style=\"border:1px solid #011b56;\">Item Total</th>\n        </tr>\n      </thead>\n      <tbody>\n        ${enrichedItems.map(item => {\n        const gstLabel = item.taxGroupNames && item.taxGroupNames.length ? item.taxGroupNames.join(', ') : item.taxGroupName || item.taxId || '-';\n        return `\n            <tr>\n              <td style=\"border:1px solid #011b56;\">${item.itemCode}</td>\n              <td style=\"border:1px solid #011b56;\">${item.itemDescription}</td>\n              <td style=\"border:1px solid #011b56;\">${item.hsnCode}</td>\n              <td style=\"border:1px solid #011b56;\">${item.uom}</td>\n              <td style=\"border:1px solid #011b56;\">${item.qty}</td>\n              <td style=\"border:1px solid #011b56;\">${item.unitPrice}</td>\n              <td style=\"border:1px solid #011b56;\">${gstLabel}</td>\n              <td style=\"border:1px solid #011b56;\">${item.total}</td>\n            </tr>`;\n      }).join('')}\n        <tr>\n          <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Subtotal</b></td>\n          <td style=\"border:1px solid #011b56;\"><b>${subtotal.toFixed(2)}</b></td>\n        </tr>\n        ${Object.entries(taxBreakdown).map(([key, val]) => `\n          <tr>\n            <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>${key}</b></td>\n            <td style=\"border:1px solid #011b56;\">${val.toFixed(2)}</td>\n          </tr>\n        `).join('')}\n        <tr>\n          <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td>\n          <td style=\"border:1px solid #011b56;\"><b>${totalTaxAmount.toFixed(2)}</b></td>\n        </tr>\n        <tr>\n          <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Grand Total</b></td>\n          <td style=\"border:1px solid #011b56;\"><b>${grandTotal.toFixed(2)}</b></td>\n        </tr>\n      </tbody>\n    </table>\n    <div style=\"margin-top:8px; font-size:11px;\"><b>Amount in Words:</b> ${amountWords}</div>\n    <div style=\"margin-top:20px; text-align:right; font-size:10px;\">Printed on ${new Date().toLocaleString()}</div>\n  `;\n      document.body.appendChild(container);\n      const canvas = await html2canvas(container, {\n        scale: 2,\n        useCORS: true\n      });\n      const imgData = canvas.toDataURL('image/png');\n      const pdf = new jsPDF('p', 'pt', 'a4');\n      const width = 595.28;\n      const height = canvas.height * width / canvas.width;\n      pdf.addImage(imgData, 'PNG', 0, 0, width, height);\n      document.body.removeChild(container); // ...existing code...\n      // 8. Milestone breakdown and tax breakdown on the same page, same style as quote table\n\n      if (breakdownItems && breakdownItems.length > 0) {\n        pdf.addPage();\n        let milestoneRows = breakdownItems.filter(bi => bi.selected !== false).map((item, idx) => {\n          const mainItem = enrichedItems.find(li => li.itemCode === item.productId);\n          const mainItemTotal = mainItem ? parseFloat(mainItem.total) || 0 : 0;\n          return `\n      <tr>\n        <td style=\"border:1px solid #011b56;\">${item.sno}</td>\n        <td style=\"border:1px solid #011b56;\">${item.productId}</td>\n        <td style=\"border:1px solid #011b56;\">${item.desc}</td>\n        <td style=\"border:1px solid #011b56;\">${item.value} ${breakdownType === 'Percentage' ? '%' : '₹'}</td>\n        <td style=\"border:1px solid #011b56;\">${item.lastDate}</td>\n        <td style=\"border:1px solid #011b56;\">${mainItemTotal.toFixed(2)}</td>\n      </tr>\n      ${(item.subProducts || []).map(sp => {\n            let spTotal = 0;\n            if (sp.type === 'Amount') spTotal = parseFloat(sp.value || 0);else if (sp.type === 'Percentage') spTotal = mainItemTotal * parseFloat(sp.value || 0) / 100;\n            return `\n          <tr style=\"background: #f9f9f9;\">\n            <td style=\"border:1px solid #011b56;\"></td>\n            <td style=\"border:1px solid #011b56;\" colspan=\"2\" style=\"padding-left: 40px;\">→ ${sp.name}</td>\n            <td style=\"border:1px solid #011b56;\">${sp.type === 'Amount' ? `₹${sp.value}` : `${sp.value}%`}</td>\n            <td style=\"border:1px solid #011b56;\">${sp.dueDate}</td>\n            <td style=\"border:1px solid #011b56;\">${spTotal.toFixed(2)}</td>\n          </tr>\n        `;\n          }).join('')}\n    `;\n        }).join('');\n        let taxRows = taxGroupDetails.map(row => {\n          let groupLabel = row.group;\n\n          if (groupLabel.includes('-')) {\n            var _groupLabel$split$;\n\n            groupLabel = ((_groupLabel$split$ = groupLabel.split('-')[1]) === null || _groupLabel$split$ === void 0 ? void 0 : _groupLabel$split$.trim()) || groupLabel;\n          }\n\n          return `\n      <tr>\n        <td style=\"border:1px solid #011b56;\">${row.sno}</td>\n        <td style=\"border:1px solid #011b56;\">${groupLabel}</td>\n        <td style=\"border:1px solid #011b56;\">${row.peramt}</td>\n        <td style=\"border:1px solid #011b56;\">${row.taxAmt}</td>\n      </tr>\n    `;\n        }).join('');\n        let combinedHtml = `\n    <div style=\"font-family:Arial; padding:40px; width:100%;\">\n      <h3 style=\"margin-bottom:10px; font-size:16px;\">Milestone Breakdown</h3>\n      <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\n        <thead>\n          <tr style=\"background:#f4f6fa;\">\n            <th style=\"border:1px solid #011b56;\">S.No</th>\n            <th style=\"border:1px solid #011b56;\">Item ID</th>\n            <th style=\"border:1px solid #011b56;\">Desc</th>\n            <th style=\"border:1px solid #011b56;\">${breakdownType}</th>\n            <th style=\"border:1px solid #011b56;\">Last Date</th>\n            <th style=\"border:1px solid #011b56;\">Item Total</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${milestoneRows}\n        </tbody>\n      </table>\n      <h3 style=\"margin-bottom:10px; margin-top:30px; font-size:16px;\">Tax Breakdown</h3>\n      <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\n        <thead>\n          <tr style=\"background:#f4f6fa;\">\n            <th style=\"border:1px solid #011b56;\">S.No</th>\n            <th style=\"border:1px solid #011b56;\">Tax Group</th>\n            <th style=\"border:1px solid #011b56;\">Per/Amt</th>\n            <th style=\"border:1px solid #011b56;\">Tax Amt</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${taxRows}\n          <tr>\n            <td colspan=\"3\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td>\n            <td style=\"border:1px solid #011b56;\"><b>${totalTaxAmount.toFixed(2)}</b></td>\n          </tr>\n        </tbody>\n      </table>\n      <div style=\"margin-top:40px; text-align:right; font-size:11px;\">\n        For ${org.bgName || ''}<br/>\n        Authorized Signatory\n      </div>\n    </div>\n  `;\n        const combinedContainer = document.createElement('div');\n        combinedContainer.innerHTML = combinedHtml;\n        document.body.appendChild(combinedContainer);\n        const combinedCanvas = await html2canvas(combinedContainer, {\n          scale: 2,\n          useCORS: true\n        });\n        const combinedImg = combinedCanvas.toDataURL('image/png');\n        pdf.addImage(combinedImg, 'PNG', 0, 0, width, combinedCanvas.height * width / combinedCanvas.width);\n        document.body.removeChild(combinedContainer);\n      }\n\n      pdf.setFontSize(11);\n      pdf.text(`For ${org.bgName || ''}`, width - 200, 780);\n      pdf.text('Authorized Signatory', width - 200, 800); // 11. Show PDF\n\n      const blob = pdf.output('blob');\n      const url = URL.createObjectURL(blob);\n      const newWin = window.open();\n      newWin.document.write(`\n    <html><head><title>Quote PDF Preview</title></head>\n    <body style=\"margin:0;\">\n      <iframe width=\"100%\" height=\"100%\" style=\"border:none;\" src=\"${url}\"></iframe>\n      <button onclick=\"document.querySelector('iframe').contentWindow.print()\" style=\"position:fixed;top:10px;right:110px;\"></button>\n      <a href=\"${url}\" download=\"Quote_${quote.quoteNo || 'PDF'}.pdf\" style=\"position:fixed;top:10px;right:10px;\"></a>\n    </body></html>\n  `);\n      newWin.document.close();\n    };\n\n    this.showOverlay = type => this.setState({\n      overlayType: type,\n      overlaySearch: ''\n    });\n\n    this.hideOverlay = () => this.setState({\n      overlayType: '',\n      overlaySearch: ''\n    });\n\n    this.selectOverlayValue = value => {\n      if (this.state.overlayType === 'customer') {\n        this.setState(prev => ({\n          formData: { ...prev.formData,\n            customer: value.custname || value.custcode || '',\n            // Use custname or custcode\n            billTo: this.formatAddress(value.billTo),\n            shipTo: this.formatAddress(value.shipTo),\n            currency: value.currency || '' // despatchMode: value.despatchMode || '', // No auto-fill for despatch mode\n            // paymentTerms: value.paymentTerms || '' // No auto-fill for payment terms\n\n          },\n          overlayType: '',\n          overlaySearch: ''\n        }), () => {\n          if (this.customerInputRef.current) {\n            this.customerInputRef.current.value = value.custname || value.custcode || '';\n          }\n        });\n      }\n    };\n\n    this.renderTaxOverlay = () => {\n      const {\n        taxGroups,\n        currentTaxLineIdx,\n        formData\n      } = this.state;\n      if (currentTaxLineIdx === null) return null;\n      const item = formData.lineItems[currentTaxLineIdx];\n      const selected = new Set(item.taxGroupNames || []);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          position: 'absolute',\n          zIndex: 9999,\n          top: '10%',\n          left: '20%',\n          background: '#fff',\n          border: '1px solid #ccc',\n          padding: '20px',\n          boxShadow: '0 0 10px rgba(0,0,0,0.3)',\n          width: '800px',\n          maxHeight: '60vh',\n          overflowY: 'auto'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 722,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"h5\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 735,\n          columnNumber: 7\n        }\n      }, \"Select Tax Groups\"), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-sm table-bordered\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 736,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 737,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 738,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 738,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 738,\n          columnNumber: 24\n        }\n      }, \"Group\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 738,\n          columnNumber: 38\n        }\n      }, \"Type\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 738,\n          columnNumber: 51\n        }\n      }, \"%\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 740,\n          columnNumber: 9\n        }\n      }, taxGroups.map(tg => /*#__PURE__*/React.createElement(\"tr\", {\n        key: tg.groupName,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 742,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 743,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        checked: selected.has(tg.groupName),\n        onChange: e => this.toggleTaxGroupSelection(tg.groupName, currentTaxLineIdx, e.target.checked),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 744,\n          columnNumber: 17\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 750,\n          columnNumber: 15\n        }\n      }, tg.groupName), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 751,\n          columnNumber: 15\n        }\n      }, tg.lineItems.map(li => li.component).join(', ')), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 752,\n          columnNumber: 15\n        }\n      }, tg.lineItems.map(li => li.percentOrAmt).join(', ')))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-right mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 757,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-sm btn-primary\",\n        onClick: () => this.setState({\n          showTaxOverlay: false\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 758,\n          columnNumber: 9\n        }\n      }, \"Done\")));\n    };\n\n    this.renderOverlay = () => {\n      const {\n        overlayType,\n        overlaySearch,\n        customers,\n        despatchModes,\n        paymentTerms\n      } = this.state;\n\n      const getFilteredRows = (list, nameKey = 'name', codeKey = 'shortName') => list.filter(item => (item[nameKey] || '').toLowerCase().includes((overlaySearch || '').toLowerCase()) || (item[codeKey] || '').toLowerCase().includes((overlaySearch || '').toLowerCase()));\n\n      const handleSelect = item => {\n        if (overlayType === 'customer') {\n          this.selectOverlayValue(item);\n        } else if (overlayType === 'despatchMode') {\n          this.setState(prev => ({\n            formData: { ...prev.formData,\n              despatchMode: item.name\n            },\n            overlayType: '',\n            overlaySearch: ''\n          }));\n        } else if (overlayType === 'paymentTerms') {\n          this.setState(prev => ({\n            formData: { ...prev.formData,\n              paymentTerms: item.name\n            },\n            overlayType: '',\n            overlaySearch: ''\n          }));\n        }\n      };\n\n      let title = '';\n      let headers = [];\n      let rows = [];\n\n      if (overlayType === 'customer') {\n        title = 'Select Customer';\n        headers = ['Name', 'Code', 'Short Name'];\n        rows = getFilteredRows(customers, 'custname', 'custcode');\n      } else if (overlayType === 'despatchMode') {\n        title = 'Select Despatch Mode';\n        headers = ['Name', 'Short Name'];\n        rows = getFilteredRows(despatchModes);\n      } else if (overlayType === 'paymentTerms') {\n        title = 'Select Payment Terms';\n        headers = ['Name', 'Short Name'];\n        rows = getFilteredRows(paymentTerms);\n      } else {\n        return null;\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 822,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 823,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 824,\n          columnNumber: 9\n        }\n      }, title), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control mb-2\",\n        placeholder: `Search ${overlayType}...`,\n        value: overlaySearch,\n        onChange: e => this.setState({\n          overlaySearch: e.target.value\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 825,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          maxHeight: 300,\n          overflowY: 'auto'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 832,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered table-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 833,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 834,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 835,\n          columnNumber: 15\n        }\n      }, headers.map((h, i) => /*#__PURE__*/React.createElement(\"th\", {\n        key: i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 836,\n          columnNumber: 40\n        }\n      }, h)))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 839,\n          columnNumber: 13\n        }\n      }, rows.map((item, i) => /*#__PURE__*/React.createElement(\"tr\", {\n        key: item.id || i,\n        onClick: () => handleSelect(item),\n        style: {\n          cursor: 'pointer'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 841,\n          columnNumber: 17\n        }\n      }, headers.map((h, j) => /*#__PURE__*/React.createElement(\"td\", {\n        key: j,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 843,\n          columnNumber: 21\n        }\n      }, overlayType === 'customer' ? h === 'Name' ? item.custname : h === 'Code' ? item.custcode : item.custshortName : h === 'Name' ? item.name : item.shortName)))), rows.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 855,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        colSpan: headers.length,\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 856,\n          columnNumber: 19\n        }\n      }, \"No records found\"))))), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-secondary btn-sm mt-2\",\n        onClick: this.hideOverlay,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 862,\n          columnNumber: 9\n        }\n      }, \"Cancel\")));\n    };\n\n    this.renderProductOverlay = () => {\n      const {\n        products,\n        productOverlaySearch,\n        selectedProductIds\n      } = this.state;\n      const filtered = products.filter(p => (p.ptshortName || '').toLowerCase().includes(productOverlaySearch.toLowerCase()) || (p.ptdescription || '').toLowerCase().includes(productOverlaySearch.toLowerCase()) || (p.itemCode || '').toLowerCase().includes(productOverlaySearch.toLowerCase()));\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 876,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 877,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 878,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 879,\n          columnNumber: 13\n        }\n      }, \"Select Products\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-success btn-sm\",\n        onClick: () => {\n          const selectedProducts = products.filter(p => this.state.selectedProductIds.includes(p.id));\n          this.setState(prev => ({\n            formData: { ...prev.formData,\n              lineItems: [...prev.formData.lineItems, ...selectedProducts.filter(p => !prev.formData.lineItems.some(item => item.id === p.id)).map(p => ({\n                id: p.id,\n                itemCode: p.productId || '',\n                itemDescription: p.ptdescription || '',\n                itemType: p.itemType || '',\n                materialType: p.materialType || '',\n                onHand: p.onHand || 0,\n                taxGroup: p.taxGroup || '',\n                taxGroupName: p.taxGroup || '',\n                custPartNo: p.custPartNo || '',\n                hsnNo: p.hsnNo || '',\n                unitPrice: p.unitPrice || 0,\n                qty: 1,\n                total: (p.unitPrice || 0).toFixed(2)\n              }))]\n            },\n            productOverlayVisible: false,\n            selectedProductIds: []\n          }));\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 880,\n          columnNumber: 13\n        }\n      }, \"Add Selected\")), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control mb-2\",\n        placeholder: \"Search products...\",\n        value: productOverlaySearch,\n        onChange: e => this.setState({\n          productOverlaySearch: e.target.value\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 914,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          maxHeight: 300,\n          overflowY: 'auto'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 921,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered table-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 922,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 923,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 924,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 925,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 926,\n          columnNumber: 19\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 927,\n          columnNumber: 19\n        }\n      }, \"Item Desc\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 928,\n          columnNumber: 19\n        }\n      }, \"Item Type\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 929,\n          columnNumber: 19\n        }\n      }, \"Material Type\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 930,\n          columnNumber: 19\n        }\n      }, \"On Hand\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 931,\n          columnNumber: 19\n        }\n      }, \"Tax Grp\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 932,\n          columnNumber: 19\n        }\n      }, \"Cust Part No\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 935,\n          columnNumber: 15\n        }\n      }, filtered.map(p => /*#__PURE__*/React.createElement(\"tr\", {\n        key: p.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 937,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 938,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        checked: selectedProductIds.includes(p.id),\n        onChange: e => {\n          const checked = e.target.checked;\n          this.setState(prev => ({\n            selectedProductIds: checked ? [...prev.selectedProductIds, p.id] : prev.selectedProductIds.filter(id => id !== p.id)\n          }));\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 939,\n          columnNumber: 23\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 952,\n          columnNumber: 21\n        }\n      }, p.productId), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 953,\n          columnNumber: 21\n        }\n      }, p.ptdescription || ''), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 954,\n          columnNumber: 21\n        }\n      }, p.itemType || ''), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 955,\n          columnNumber: 21\n        }\n      }, p.materialType || ''), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 956,\n          columnNumber: 21\n        }\n      }, p.onHand || 0), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 957,\n          columnNumber: 21\n        }\n      }, p.taxGroup || ''), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 958,\n          columnNumber: 21\n        }\n      }, p.custPartNo || ''))), filtered.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 962,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        colSpan: \"8\",\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 963,\n          columnNumber: 21\n        }\n      }, \"No products found\"))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 970,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 971,\n          columnNumber: 13\n        }\n      }, \"Page 1 of 1\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-secondary btn-sm\",\n        onClick: () => this.setState({\n          productOverlayVisible: false,\n          selectedProductIds: []\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 972,\n          columnNumber: 13\n        }\n      }, \"Cancel\"))));\n    };\n\n    this.renderBreakdownTab = () => {\n      const {\n        breakdownItems,\n        breakdownType,\n        formData\n      } = this.state; // Get item totals from lineItems (with tax)\n\n      const itemTotals = (formData.lineItems || []).reduce((acc, li) => {\n        acc[li.itemCode] = parseFloat(li.total || 0);\n        return acc;\n      }, {}); // Sum of all item totals\n\n      const sumOfItemTotals = Object.values(itemTotals).reduce((sum, val) => sum + val, 0);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 992,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"h5\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 993,\n          columnNumber: 7\n        }\n      }, \"Add Milestone\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row mb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 994,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 995,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 995,\n          columnNumber: 30\n        }\n      }, \"Quote Value:\"), \" \", formData.quoteValue), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 996,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 996,\n          columnNumber: 30\n        }\n      }, \"Tax Amount:\"), \" \", formData.taxAmount), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 997,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 997,\n          columnNumber: 30\n        }\n      }, \"Sum of Item Totals:\"), \" \", sumOfItemTotals.toFixed(2))), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 999,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1000,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1001,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1002,\n          columnNumber: 13\n        }\n      }, \"S.No\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1003,\n          columnNumber: 13\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1004,\n          columnNumber: 13\n        }\n      }, \"Desc\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1005,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1006,\n          columnNumber: 15\n        }\n      }, \"Per/Amt\"), /*#__PURE__*/React.createElement(\"select\", {\n        value: breakdownType,\n        onChange: e => this.handleBreakdownTypeChange(e.target.value),\n        className: \"form-control form-control-sm font-weight-bold\",\n        style: {\n          fontWeight: 'bold',\n          display: 'inline-block',\n          width: 'auto',\n          marginLeft: 8\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1007,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        value: \"Percentage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1013,\n          columnNumber: 17\n        }\n      }, \"%\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"Amount\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1014,\n          columnNumber: 17\n        }\n      }, \"\\u20B9\"))), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1017,\n          columnNumber: 13\n        }\n      }, \"Due Date\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1018,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1019,\n          columnNumber: 15\n        }\n      }, \"Item Total\")), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1021,\n          columnNumber: 13\n        }\n      }, \"Actions\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1024,\n          columnNumber: 9\n        }\n      }, breakdownItems.map((item, idx) => {\n        // Main item total (with tax) from lineItems\n        const mainItemTotal = itemTotals[item.productId] || 0; // Sub-product sum logic\n\n        const subTotal = (item.subProducts || []).reduce((sum, sp) => {\n          if (sp.type === 'Amount') return sum + parseFloat(sp.value || 0);\n          if (sp.type === 'Percentage') return sum + mainItemTotal * parseFloat(sp.value || 0) / 100;\n          return sum;\n        }, 0);\n        const isSatisfied = Math.abs(mainItemTotal - subTotal) < 0.01 && subTotal > 0;\n        return /*#__PURE__*/React.createElement(React.Fragment, {\n          key: idx,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1039,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"tr\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1040,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1041,\n            columnNumber: 19\n          }\n        }, item.sno), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1042,\n            columnNumber: 19\n          }\n        }, item.productId), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1043,\n            columnNumber: 19\n          }\n        }, item.desc), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1044,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"input-group input-group-sm\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1045,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"input-group-prepend\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1046,\n            columnNumber: 23\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          className: \"input-group-text\",\n          style: {\n            fontWeight: 'bold'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1047,\n            columnNumber: 25\n          }\n        }, breakdownType === 'Percentage' ? '%' : '₹')), /*#__PURE__*/React.createElement(\"input\", {\n          type: \"number\",\n          className: \"form-control\",\n          value: item.value,\n          onChange: e => {\n            this.handleBreakdownValueChange(idx, e.target.value);\n            this.saveBreakdownToSession();\n          },\n          placeholder: breakdownType === 'Percentage' ? 'Enter %' : 'Enter Amt',\n          style: {\n            fontWeight: 'bold'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1051,\n            columnNumber: 23\n          }\n        }))), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1064,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"input\", {\n          type: \"date\",\n          className: \"form-control form-control-sm\",\n          value: item.lastDate,\n          onChange: e => {\n            this.handleBreakdownDateChange(idx, e.target.value);\n            this.saveBreakdownToSession();\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1065,\n            columnNumber: 21\n          }\n        })), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1075,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          style: {\n            color: isSatisfied ? 'green' : 'red',\n            fontWeight: 'bold'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1076,\n            columnNumber: 21\n          }\n        }, mainItemTotal.toFixed(2))), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1080,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"button\", {\n          type: \"button\",\n          className: \"btn btn-sm btn-outline-primary\",\n          onClick: () => this.setState({\n            showSubProductDialog: true,\n            currentBreakdownIdx: idx\n          }),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1081,\n            columnNumber: 21\n          }\n        }, \"+ Add Milestone\"))), (item.subProducts || []).map((sp, spIdx) => {\n          // Sub-product item total calculation\n          let spTotal = 0;\n          if (sp.type === 'Amount') spTotal = parseFloat(sp.value || 0);else if (sp.type === 'Percentage') spTotal = mainItemTotal * parseFloat(sp.value || 0) / 100;\n          return /*#__PURE__*/React.createElement(\"tr\", {\n            key: spIdx,\n            style: {\n              background: '#f9f9f9'\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1096,\n              columnNumber: 21\n            }\n          }, /*#__PURE__*/React.createElement(\"td\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1097,\n              columnNumber: 23\n            }\n          }), /*#__PURE__*/React.createElement(\"td\", {\n            colSpan: 2,\n            style: {\n              paddingLeft: 40\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1098,\n              columnNumber: 23\n            }\n          }, \"\\u2192 \", sp.name), /*#__PURE__*/React.createElement(\"td\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1099,\n              columnNumber: 23\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            style: {\n              fontWeight: 'bold'\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1100,\n              columnNumber: 25\n            }\n          }, sp.type === 'Amount' ? `₹${sp.value}` : `${sp.value}%`)), /*#__PURE__*/React.createElement(\"td\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1104,\n              columnNumber: 23\n            }\n          }, sp.dueDate), /*#__PURE__*/React.createElement(\"td\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1105,\n              columnNumber: 23\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            style: {\n              fontWeight: 'bold'\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1106,\n              columnNumber: 25\n            }\n          }, spTotal.toFixed(2))), /*#__PURE__*/React.createElement(\"td\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1108,\n              columnNumber: 23\n            }\n          }));\n        }));\n      }))));\n    };\n\n    this.renderSubProductDialog = () => {\n      const {\n        showSubProductDialog,\n        subProductForm\n      } = this.state;\n      if (!showSubProductDialog) return null;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay\",\n        onClick: e => e.stopPropagation(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1125,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-content\",\n        style: {\n          width: 400\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1126,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1127,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1128,\n          columnNumber: 11\n        }\n      }, \"Name\"), /*#__PURE__*/React.createElement(\"input\", {\n        className: \"form-control\",\n        value: subProductForm.name,\n        onChange: e => this.setState({\n          subProductForm: { ...subProductForm,\n            name: e.target.value\n          }\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1129,\n          columnNumber: 11\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1131,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1132,\n          columnNumber: 11\n        }\n      }, \"Type\"), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"form-control\",\n        value: subProductForm.type,\n        onChange: e => this.setState({\n          subProductForm: { ...subProductForm,\n            type: e.target.value\n          }\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1133,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        value: \"Amount\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1134,\n          columnNumber: 13\n        }\n      }, \"Amount\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"Percentage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1135,\n          columnNumber: 13\n        }\n      }, \"Percentage\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1138,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1139,\n          columnNumber: 11\n        }\n      }, subProductForm.type), /*#__PURE__*/React.createElement(\"input\", {\n        className: \"form-control\",\n        type: \"number\",\n        value: subProductForm.value,\n        onChange: e => this.setState({\n          subProductForm: { ...subProductForm,\n            value: e.target.value\n          }\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1140,\n          columnNumber: 11\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1142,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1143,\n          columnNumber: 11\n        }\n      }, \"Due Date\"), /*#__PURE__*/React.createElement(\"input\", {\n        className: \"form-control\",\n        type: \"date\",\n        value: subProductForm.dueDate,\n        onChange: e => this.setState({\n          subProductForm: { ...subProductForm,\n            dueDate: e.target.value\n          }\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1144,\n          columnNumber: 11\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1146,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-secondary mr-2\",\n        onClick: () => this.setState({\n          showSubProductDialog: false\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1147,\n          columnNumber: 11\n        }\n      }, \"Cancel\"), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-primary\",\n        onClick: e => {\n          e.preventDefault(); //  this prevents the form submission\n\n          this.handleAddSubProduct();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1149,\n          columnNumber: 11\n        }\n      }, \"Add\"))));\n    };\n\n    this.handleAddSubProduct = () => {\n      const {\n        currentBreakdownIdx,\n        subProductForm,\n        breakdownItems\n      } = this.state;\n      if (!subProductForm.name || !subProductForm.value) return; // Clone breakdownItems and subProducts for immutability\n\n      const items = breakdownItems.map((item, idx) => {\n        if (idx === currentBreakdownIdx) {\n          const subProducts = Array.isArray(item.subProducts) ? [...item.subProducts] : [];\n          subProducts.push({ ...subProductForm\n          });\n          return { ...item,\n            subProducts\n          };\n        }\n\n        return item;\n      });\n      this.setState({\n        breakdownItems: items,\n        showSubProductDialog: false,\n        subProductForm: {\n          name: '',\n          value: '',\n          type: 'Amount',\n          dueDate: ''\n        }\n      }, this.saveBreakdownToSession);\n    };\n\n    this.renderQuoteTable = () => /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card mt-4 full-height\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1178,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1179,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex justify-content-between align-items-center mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1180,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      className: \"card-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1181,\n        columnNumber: 11\n      }\n    }, \"Quotes\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-primary\",\n      onClick: () => this.setState({\n        showForm: true\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1182,\n        columnNumber: 11\n      }\n    }, \"+ Add Quote\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"table-responsive\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1184,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"table\", {\n      className: \"table table-bordered table-hover\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1185,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      className: \"thead-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1186,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      style: {\n        fontSize: '14px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1187,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1188,\n        columnNumber: 17\n      }\n    }, \"Quote No\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1189,\n        columnNumber: 17\n      }\n    }, \"Customer\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1190,\n        columnNumber: 17\n      }\n    }, \"Date\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1191,\n        columnNumber: 17\n      }\n    }, \"Quote Value\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1192,\n        columnNumber: 17\n      }\n    }, \"Status\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1193,\n        columnNumber: 17\n      }\n    }, \"Print\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1196,\n        columnNumber: 13\n      }\n    }, this.state.quotes.map((q, i) => /*#__PURE__*/React.createElement(\"tr\", {\n      key: i,\n      style: {\n        fontSize: '14px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1198,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1199,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-link p-0\",\n      onClick: () => this.loadQuotePreview(q),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1200,\n        columnNumber: 21\n      }\n    }, q.quoteNo)), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1207,\n        columnNumber: 19\n      }\n    }, q.customer), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1208,\n        columnNumber: 19\n      }\n    }, q.quoteDate), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1209,\n        columnNumber: 19\n      }\n    }, q.quoteValue), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1210,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"badge badge-info\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1210,\n        columnNumber: 23\n      }\n    }, q.status)), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1211,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"mdi mdi-printer menu-icon\",\n      onClick: () => this.showQuotePDFWithOrg(q),\n      style: {\n        fontSize: '24px',\n        color: '#2196F3',\n        cursor: 'pointer'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1212,\n        columnNumber: 19\n      }\n    })))), this.state.quotes.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1223,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      colSpan: \"6\",\n      className: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1223,\n        columnNumber: 21\n      }\n    }, \"No quotes found.\")))))));\n\n    this.renderQuoteForm = () => {\n      const {\n        formData,\n        overlayType,\n        productOverlayVisible,\n        showTaxOverlay,\n        taxGroups,\n        recalculateTotals\n      } = this.state;\n      const isFOB = formData.impExp === 'FOB';\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1237,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card full-height\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1238,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          flex: 1,\n          overflowY: 'auto',\n          padding: '24px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1239,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1240,\n          columnNumber: 13\n        }\n      }, \"Quote Form\"), /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"nav nav-tabs\",\n        role: \"tablist\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1241,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        className: \"nav-item\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1242,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: `nav-link ${this.state.activeTab === 'co' ? 'active' : ''}`,\n        onClick: () => this.setState({\n          activeTab: 'co'\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1243,\n          columnNumber: 17\n        }\n      }, \"CO Details\")), /*#__PURE__*/React.createElement(\"li\", {\n        className: \"nav-item\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1245,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: `nav-link ${this.state.activeTab === 'breakdown' ? 'active' : ''}`,\n        onClick: () => this.setState({\n          activeTab: 'breakdown'\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1246,\n          columnNumber: 15\n        }\n      }, \"Breakdown\")), /*#__PURE__*/React.createElement(\"li\", {\n        className: \"nav-item\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1248,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: `nav-link ${this.state.activeTab === 'commercial' ? 'active' : ''}`,\n        onClick: () => this.setState({\n          activeTab: 'commercial'\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1249,\n          columnNumber: 17\n        }\n      }, \"Commercial Terms\"))), /*#__PURE__*/React.createElement(\"form\", {\n        className: \"form-sample\",\n        onSubmit: this.handleSubmit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1252,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"tab-content pt-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1253,\n          columnNumber: 15\n        }\n      }, this.state.activeTab === 'co' && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1256,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1257,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1258,\n          columnNumber: 25\n        }\n      }, \"Quote No\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.quoteNo,\n        onChange: e => this.handleInputChange('quoteNo', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1259,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1261,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1262,\n          columnNumber: 25\n        }\n      }, \"Quote Date\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"date\",\n        className: \"form-control form-control-sm\",\n        value: formData.quoteDate,\n        onChange: e => this.handleInputChange('quoteDate', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1263,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1265,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1266,\n          columnNumber: 25\n        }\n      }, \"Quote Type\"), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"form-control form-control-sm\",\n        value: formData.quoteType,\n        onChange: e => this.handleInputChange('quoteType', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1267,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1268,\n          columnNumber: 27\n        }\n      }, \"Standard\"), /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1269,\n          columnNumber: 27\n        }\n      }, \"Manual\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1272,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1273,\n          columnNumber: 25\n        }\n      }, \"Status\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.status,\n        style: {\n          backgroundColor: '#fff'\n        },\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1274,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1277,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1278,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1279,\n          columnNumber: 25\n        }\n      }, \"Customer\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group input-group-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1280,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        placeholder: \"Choose Customer\",\n        ref: this.customerInputRef,\n        value: formData.customer,\n        readOnly: true,\n        onClick: () => this.showOverlay('customer'),\n        style: {\n          cursor: 'pointer'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1281,\n          columnNumber: 27\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group-append\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1291,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-outline-secondary btn-sm\",\n        type: \"button\",\n        onClick: () => this.showOverlay('customer'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1292,\n          columnNumber: 29\n        }\n      }, \"Select\")))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1296,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1297,\n          columnNumber: 25\n        }\n      }, \"IMP/EXP\"), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"form-control form-control-sm\",\n        value: formData.impExp,\n        onChange: e => this.handleInputChange('impExp', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1298,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1303,\n          columnNumber: 27\n        }\n      }, \"None\"), /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1304,\n          columnNumber: 27\n        }\n      }, \"COB\"), /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1305,\n          columnNumber: 27\n        }\n      }, \"FOB\"), /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1306,\n          columnNumber: 27\n        }\n      }, \"CIF\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1309,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1310,\n          columnNumber: 25\n        }\n      }, \"Ref No.\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.qrefNo,\n        onChange: e => this.handleInputChange('qrefNo', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1311,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1318,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1319,\n          columnNumber: 25\n        }\n      }, \"Choose\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex align-items-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1320,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-check mr-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1321,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"radio\",\n        className: \"form-check-input\",\n        name: \"choose\",\n        id: \"chooseService\",\n        value: \"Service\",\n        checked: formData.choose === 'Service',\n        onChange: e => this.handleInputChange('choose', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1322,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"label\", {\n        className: \"form-check-label\",\n        htmlFor: \"chooseService\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1323,\n          columnNumber: 29\n        }\n      }, \"Service\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-check\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1325,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"radio\",\n        className: \"form-check-input\",\n        name: \"choose\",\n        id: \"chooseProduct\",\n        value: \"Product\",\n        checked: formData.choose === 'Product',\n        onChange: e => this.handleInputChange('choose', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1326,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"label\", {\n        className: \"form-check-label\",\n        htmlFor: \"chooseProduct\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1327,\n          columnNumber: 29\n        }\n      }, \"Product\"))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1332,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1333,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1334,\n          columnNumber: 25\n        }\n      }, \"Currency\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.currency,\n        style: {\n          backgroundColor: '#fff'\n        },\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1335,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1343,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1344,\n          columnNumber: 25\n        }\n      }, \"Conversion Rate\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.conversionRate,\n        onChange: e => this.handleInputChange('conversionRate', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1345,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1352,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1353,\n          columnNumber: 25\n        }\n      }, \"Tax Amount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.taxAmount,\n        onChange: e => this.handleInputChange('taxAmount', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1354,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1362,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1363,\n          columnNumber: 25\n        }\n      }, \"Quote Value\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.quoteValue,\n        onChange: e => this.handleInputChange('quoteValue', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1364,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1374,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"card-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1375,\n          columnNumber: 29\n        }\n      }, \"Line Item\"), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-primary btn-sm\",\n        onClick: () => this.setState({\n          productOverlayVisible: true\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1376,\n          columnNumber: 29\n        }\n      }, \"+ Add Product\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"table-responsive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1380,\n          columnNumber: 24\n        }\n      }, /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1381,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        className: \"thead-light\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1382,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1383,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1384,\n          columnNumber: 15\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1385,\n          columnNumber: 15\n        }\n      }, \"Item Desc\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1386,\n          columnNumber: 15\n        }\n      }, \"Cust Part No\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1387,\n          columnNumber: 15\n        }\n      }, \"HSN No\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1388,\n          columnNumber: 15\n        }\n      }, \"UOM\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1389,\n          columnNumber: 15\n        }\n      }, \"On Hand\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1390,\n          columnNumber: 15\n        }\n      }, \"Unit Price\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1391,\n          columnNumber: 15\n        }\n      }, \"Quantity\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1392,\n          columnNumber: 15\n        }\n      }, \"Tax Id\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1393,\n          columnNumber: 15\n        }\n      }, \"Item Total\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1396,\n          columnNumber: 11\n        }\n      }, formData.lineItems.map((item, idx) => {\n        const itemTotal = item.unitPrice * item.qty;\n        const taxDetails = getTaxDetailsFromGroup(item.taxGroupName, this.state.taxGroups);\n        const taxAmt = itemTotal * taxDetails.totalPercent / 100 + itemTotal * taxDetails.totalAmount;\n        const totalWithTax = itemTotal + taxAmt;\n        return /*#__PURE__*/React.createElement(\"tr\", {\n          key: item.id || idx,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1405,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1406,\n            columnNumber: 19\n          }\n        }, item.itemCode), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1407,\n            columnNumber: 19\n          }\n        }, item.itemDescription), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1408,\n            columnNumber: 19\n          }\n        }, item.custPartNo), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1409,\n            columnNumber: 19\n          }\n        }, item.hsnNo), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1410,\n            columnNumber: 19\n          }\n        }, item.uom), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1411,\n            columnNumber: 19\n          }\n        }, item.onHand), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1412,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"input\", {\n          type: \"number\",\n          value: item.unitPrice,\n          onChange: e => this.handleLineItemChange(idx, 'unitPrice', e.target.value),\n          style: {\n            width: 80\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1413,\n            columnNumber: 21\n          }\n        })), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1420,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"input\", {\n          type: \"number\",\n          min: \"1\",\n          value: item.qty,\n          onChange: e => this.handleLineItemChange(idx, 'qty', e.target.value),\n          style: {\n            width: 60\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1421,\n            columnNumber: 21\n          }\n        })), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1429,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"button\", {\n          type: \"button\",\n          className: \"btn btn-outline-secondary btn-sm btn-rounded btn-icon\",\n          style: {\n            padding: '2px 6px',\n            fontSize: '12px',\n            lineHeight: '1'\n          },\n          onClick: () => this.setState({\n            showTaxOverlay: true,\n            currentTaxLineIdx: idx\n          }),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1430,\n            columnNumber: 19\n          }\n        }, \"+\"), /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            fontSize: '13px',\n            marginTop: '4px'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1438,\n            columnNumber: 19\n          }\n        }, (item.taxGroupNames || []).join(', ') || '-')), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1442,\n            columnNumber: 15\n          }\n        }, parseFloat(item.total || 0).toFixed(2)));\n      })))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1453,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1454,\n          columnNumber: 29\n        }\n      }, \"Page 1 of 1\"))), this.state.activeTab === 'commercial' && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1461,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1462,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1463,\n          columnNumber: 25\n        }\n      }, \"Bill To\"), /*#__PURE__*/React.createElement(\"textarea\", {\n        className: \"form-control form-control-sm\",\n        rows: \"3\",\n        value: formData.billTo,\n        onChange: e => this.handleInputChange('billTo', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1464,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1471,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1472,\n          columnNumber: 25\n        }\n      }, \"Ship To\"), /*#__PURE__*/React.createElement(\"textarea\", {\n        className: \"form-control form-control-sm\",\n        rows: \"3\",\n        value: formData.shipTo,\n        onChange: e => this.handleInputChange('shipTo', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1473,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1481,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1482,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1483,\n          columnNumber: 3\n        }\n      }, \"Despatch Mode\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group input-group-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1484,\n          columnNumber: 3\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        value: formData.despatchMode,\n        readOnly: true,\n        onClick: () => !isFOB && this.showOverlay('despatchMode'),\n        style: {\n          cursor: isFOB ? 'not-allowed' : 'pointer',\n          backgroundColor: '#fff'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1485,\n          columnNumber: 5\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group-append\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1493,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-outline-secondary btn-sm\",\n        type: \"button\",\n        disabled: isFOB,\n        onClick: () => this.showOverlay('despatchMode'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1494,\n          columnNumber: 7\n        }\n      }, \"Select\")))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1506,\n          columnNumber: 1\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1507,\n          columnNumber: 3\n        }\n      }, \"Payment Terms\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group input-group-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1508,\n          columnNumber: 3\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        value: formData.paymentTerms,\n        readOnly: true,\n        onClick: () => !isFOB && this.showOverlay('paymentTerms'),\n        style: {\n          cursor: isFOB ? 'not-allowed' : 'pointer',\n          backgroundColor: '#fff'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1509,\n          columnNumber: 5\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group-append\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1517,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-outline-secondary btn-sm\",\n        type: \"button\",\n        disabled: isFOB,\n        onClick: () => this.showOverlay('paymentTerms'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1518,\n          columnNumber: 7\n        }\n      }, \"Select\")))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1530,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1531,\n          columnNumber: 25\n        }\n      }, \"Freight Charges\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.freightCharges,\n        onChange: e => this.handleInputChange('freightCharges', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1532,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1541,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1542,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1543,\n          columnNumber: 25\n        }\n      }, \"Tax %\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.taxPercent,\n        onChange: e => this.handleInputChange('taxPercent', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1544,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1552,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1553,\n          columnNumber: 25\n        }\n      }, \"Freight Tax Amount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.freighttaxAmount,\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1554,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1561,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1562,\n          columnNumber: 25\n        }\n      }, \"Packing Charges\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.packingCharges,\n        onChange: e => this.handleInputChange('packingCharges', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1563,\n          columnNumber: 25\n        }\n      })))), this.state.activeTab === 'breakdown' && this.renderBreakdownTab()), this.renderSubProductDialog(), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"fixed-card-footer text-right p-3 border-top bg-white\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1578,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-success mr-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1579,\n          columnNumber: 17\n        }\n      }, \"Save All Details\"), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-secondary\",\n        onClick: () => this.setState({\n          showForm: false,\n          editingId: null\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1580,\n          columnNumber: 17\n        }\n      }, \"Cancel\"))), overlayType && this.renderOverlay(), productOverlayVisible && this.renderProductOverlay(), this.state.showTaxOverlay && this.renderTaxOverlay())));\n    };\n\n    this.renderQuotePreview = () => {\n      var _q$lineItems;\n\n      const q = this.state.selectedQuote;\n      if (!q) return null;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card mt-4 full-height p-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1604,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1605,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"card-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1606,\n          columnNumber: 9\n        }\n      }, \"Quote Preview - \", q.quoteNo), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1607,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-sm btn-info mr-2\",\n        onClick: () => this.loadQuoteForEdit(q),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1608,\n          columnNumber: 11\n        }\n      }, \"Edit\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-sm btn-success\",\n        onClick: () => this.convertToOrder(q),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1609,\n          columnNumber: 11\n        }\n      }, \"Convert to Order\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1612,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1613,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1613,\n          columnNumber: 35\n        }\n      }, \"Customer:\"), \" \", q.customer), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1614,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1614,\n          columnNumber: 35\n        }\n      }, \"Date:\"), \" \", q.quoteDate), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1615,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1615,\n          columnNumber: 35\n        }\n      }, \"Status:\"), \" \", q.status)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1617,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1618,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1618,\n          columnNumber: 35\n        }\n      }, \"Bill To:\"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1618,\n          columnNumber: 50\n        }\n      }), q.billTo), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1619,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1619,\n          columnNumber: 35\n        }\n      }, \"Ship To:\"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1619,\n          columnNumber: 50\n        }\n      }), q.shipTo)), /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"mt-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1621,\n          columnNumber: 7\n        }\n      }, \"Line Items\"), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1622,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1623,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1624,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1625,\n          columnNumber: 13\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1625,\n          columnNumber: 31\n        }\n      }, \"Description\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1625,\n          columnNumber: 51\n        }\n      }, \"Qty\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1625,\n          columnNumber: 63\n        }\n      }, \"Unit Price\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1625,\n          columnNumber: 82\n        }\n      }, \"Total\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1628,\n          columnNumber: 9\n        }\n      }, (_q$lineItems = q.lineItems) === null || _q$lineItems === void 0 ? void 0 : _q$lineItems.map((item, i) => /*#__PURE__*/React.createElement(\"tr\", {\n        key: i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1630,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1631,\n          columnNumber: 15\n        }\n      }, item.itemCode), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1632,\n          columnNumber: 15\n        }\n      }, item.itemDescription), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1633,\n          columnNumber: 15\n        }\n      }, item.qty), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1634,\n          columnNumber: 15\n        }\n      }, item.unitPrice), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1635,\n          columnNumber: 15\n        }\n      }, item.total))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1640,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1640,\n          columnNumber: 35\n        }\n      }, \"Total:\"), \" \", q.quoteValue), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-secondary mt-3\",\n        onClick: () => this.setState({\n          previewMode: false\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1641,\n          columnNumber: 7\n        }\n      }, \"Back to List\"));\n    };\n  }\n\n  componentDidMount() {\n    bsCustomFileInput.init();\n    this.fetchQuotes();\n    this.fetchCustomers();\n    this.fetchProducts();\n    this.fetchDespatchModes();\n    this.fetchPaymentTerms();\n    this.fetchTaxGroups();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const prevLineItems = prevState.formData.lineItems || [];\n    const currLineItems = this.state.formData.lineItems || [];\n\n    if (prevLineItems.length !== currLineItems.length) {\n      const prevBreakdownMap = {};\n      (this.state.breakdownItems || []).forEach(bi => {\n        prevBreakdownMap[bi.productId] = bi;\n      });\n      this.setState({\n        breakdownItems: currLineItems.map((li, idx) => {\n          var _prevBreakdownMap$li$, _prevBreakdownMap$li$2, _prevBreakdownMap$li$3;\n\n          return {\n            sno: idx + 1,\n            productId: li.itemCode,\n            desc: li.itemDescription,\n            value: ((_prevBreakdownMap$li$ = prevBreakdownMap[li.itemCode]) === null || _prevBreakdownMap$li$ === void 0 ? void 0 : _prevBreakdownMap$li$.value) || '',\n            lastDate: ((_prevBreakdownMap$li$2 = prevBreakdownMap[li.itemCode]) === null || _prevBreakdownMap$li$2 === void 0 ? void 0 : _prevBreakdownMap$li$2.lastDate) || '',\n            subProducts: ((_prevBreakdownMap$li$3 = prevBreakdownMap[li.itemCode]) === null || _prevBreakdownMap$li$3 === void 0 ? void 0 : _prevBreakdownMap$li$3.subProducts) || []\n          };\n        })\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container-fluid\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1648,\n        columnNumber: 7\n      }\n    }, this.state.previewMode ? this.renderQuotePreview() : this.state.showForm ? this.renderQuoteForm() : this.renderQuoteTable());\n  }\n\n}\n\nexport default withRouter(Quote);","map":{"version":3,"sources":["C:/Users/College/admin/StarAdmin-Free-React-Admin-Template-master/template/demo_1/src/app/panelone/Quote.js"],"names":["React","Component","Form","bsCustomFileInput","db","collection","getDocs","addDoc","doc","updateDoc","withRouter","html2canvas","jsPDF","recalculateTotals","getTaxDetailsFromGroup","toWords","amount","amountWords","console","log","Quote","state","activeTab","quotes","customers","products","despatchModes","paymentTerms","showForm","showTaxOverlay","currentTaxLineIdx","editingId","overlayType","overlaySearch","productOverlayVisible","productOverlaySearch","selectedProductIds","selectedTaxGroups","taxComponents","taxGroups","previewMode","selectedQuote","breakdownItems","breakdownType","breakdownSelectAll","showSubProductDialog","currentBreakdownIdx","subProductForm","name","value","type","dueDate","formData","quoteNo","quoteDate","Date","toISOString","split","quoteType","customer","status","choose","qrefNo","impExp","currency","conversionRate","taxAmount","quoteValue","billTo","shipTo","despatchMode","freightCharges","freighttaxAmount","taxPercent","packingCharges","lineItems","customerInputRef","createRef","formatAddress","addr","address","city","country","filter","Boolean","join","zip","handleLineItemChange","idx","field","updatedItems","updatedLineItems","setState","prev","fetchTaxGroups","snap","data","docs","map","id","fetchQuotes","reverse","fetchCustomers","fetchProducts","fetchDespatchModes","fetchPaymentTerms","toggleTaxGroupSelection","groupName","lineIdx","checked","item","taxGroupNames","Array","isArray","includes","push","g","taxGroupName","handleInputChange","handleBreakdownSelectAll","selected","handleBreakdownRowSelect","items","handleBreakdownTypeChange","handleBreakdownValueChange","handleBreakdownDateChange","lastDate","saveBreakdownToSession","sessionStorage","setItem","JSON","stringify","loadBreakdownFromSession","getItem","parse","handleSubmit","e","preventDefault","alert","length","loadQuotePreview","q","loadQuoteForEdit","quote","current","convertToOrder","props","history","showQuotePDFWithOrg","orgSnap","org","find","c","custshortName","custname","gstStateMap","getPlaceOfSupply","gstin","code","substring","enrichedItems","product","p","productId","itemCode","ptshortName","hsnCode","uom","stockingUOM","cgst","sgst","igst","s","trim","subtotal","reduce","sum","parseFloat","unitPrice","qty","freightTax","totalTaxAmount","grandTotal","Math","floor","taxBreakdown","taxGroupDetails","sno","forEach","base","tgName","group","li","key","component","percentOrAmt","taxAmt","peramt","toFixed","container","document","createElement","style","width","padding","fontFamily","innerHTML","logoUrl","bgName","email","website","mobile","cin","replace","contactPerson","phone","gstLabel","taxId","itemDescription","total","Object","entries","val","toLocaleString","body","appendChild","canvas","scale","useCORS","imgData","toDataURL","pdf","height","addImage","removeChild","addPage","milestoneRows","bi","mainItem","mainItemTotal","desc","subProducts","sp","spTotal","taxRows","row","groupLabel","combinedHtml","combinedContainer","combinedCanvas","combinedImg","setFontSize","text","blob","output","url","URL","createObjectURL","newWin","window","open","write","close","showOverlay","hideOverlay","selectOverlayValue","custcode","renderTaxOverlay","Set","position","zIndex","top","left","background","border","boxShadow","maxHeight","overflowY","tg","has","target","renderOverlay","getFilteredRows","list","nameKey","codeKey","toLowerCase","handleSelect","title","headers","rows","h","i","cursor","j","shortName","renderProductOverlay","filtered","ptdescription","selectedProducts","some","itemType","materialType","onHand","taxGroup","custPartNo","hsnNo","renderBreakdownTab","itemTotals","acc","sumOfItemTotals","values","fontWeight","display","marginLeft","subTotal","isSatisfied","abs","color","spIdx","paddingLeft","renderSubProductDialog","stopPropagation","handleAddSubProduct","renderQuoteTable","fontSize","renderQuoteForm","isFOB","flex","backgroundColor","itemTotal","taxDetails","totalPercent","totalAmount","totalWithTax","lineHeight","marginTop","renderQuotePreview","componentDidMount","init","componentDidUpdate","prevProps","prevState","prevLineItems","currLineItems","prevBreakdownMap","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Form } from 'react-bootstrap';\r\nimport bsCustomFileInput from 'bs-custom-file-input';\r\nimport { db } from '../../firebase';\r\nimport { collection, getDocs, addDoc, doc, updateDoc } from 'firebase/firestore';\r\nimport { withRouter } from 'react-router-dom';\r\nimport html2canvas from 'html2canvas';\r\nimport { jsPDF } from 'jspdf';\r\nimport { recalculateTotals, getTaxDetailsFromGroup } from './calculation';\r\nimport { toWords } from 'number-to-words';\r\n\r\nconst amount = 12345678;\r\nconst amountWords = `INR ${toWords(amount)} Only`;\r\n\r\nconsole.log(amountWords);\r\n\r\n\r\nclass Quote extends Component {\r\n  state = {\r\n    activeTab: 'co',\r\n    quotes: [],\r\n    customers: [],\r\n    products: [],\r\n    despatchModes: [],\r\n    paymentTerms: [],\r\n    showForm: false,\r\n    showTaxOverlay: false,\r\n    currentTaxLineIdx: null,\r\n    editingId: null,\r\n    overlayType: '',\r\n    overlaySearch: '',\r\n    productOverlayVisible: false,\r\n    productOverlaySearch: '',\r\n    selectedProductIds: [],\r\n    selectedTaxGroups: [],\r\n    taxComponents: [],\r\n    taxGroups:[],\r\n    previewMode: false,\r\n    selectedQuote: null,\r\n    breakdownItems: [], \r\n    breakdownType: 'Percentage',\r\n    breakdownSelectAll: false,\r\n    showSubProductDialog: false,\r\n    currentBreakdownIdx: null,\r\n    subProductForm: { name: '', value: '', type: 'Amount', dueDate: '' },\r\n    formData: {\r\n      quoteNo: '',\r\n      quoteDate: new Date().toISOString().split('T')[0],\r\n      quoteType: 'Standard',\r\n      customer: '',\r\n      status: 'Entered', // Static 'Entered'\r\n      choose: 'Service',\r\n      qrefNo: '',\r\n      impExp: 'None',\r\n      currency: '',\r\n      conversionRate: '',\r\n      taxAmount: '',\r\n      quoteValue: '',\r\n      billTo: '',\r\n      shipTo: '',\r\n      despatchMode: 'By Air',\r\n      paymentTerms: '',\r\n      freightCharges: '',\r\n      freighttaxAmount: '',\r\n      taxPercent: '',\r\n      packingCharges: '',\r\n      lineItems: [],\r\n    }\r\n  };\r\n  customerInputRef = React.createRef();\r\n\r\n  // Helper to format address for Bill To / Ship To\r\n  formatAddress = (addr) => {\r\n    if (!addr) return '';\r\n    if (typeof addr === 'string') return addr;\r\n    return [\r\n      addr.address,\r\n      [addr.city, addr.state, addr.country].filter(Boolean).join(', '),\r\n      addr.zip\r\n    ].filter(Boolean).join('\\n');\r\n  };\r\n\r\n  componentDidMount() {\r\n    bsCustomFileInput.init();\r\n    this.fetchQuotes();\r\n    this.fetchCustomers();\r\n    this.fetchProducts();\r\n    this.fetchDespatchModes();\r\n    this.fetchPaymentTerms();\r\n    this.fetchTaxGroups();\r\n  }\r\nhandleLineItemChange = (idx, field, value) => {\r\n  const updatedItems = [...this.state.formData.lineItems];\r\n  updatedItems[idx] = { ...updatedItems[idx], [field]: value };\r\n  const { updatedLineItems, freighttaxAmount, taxAmount, quoteValue } = recalculateTotals({\r\n    lineItems: updatedItems,\r\n    freightCharges: this.state.formData.freightCharges,\r\n    packingCharges: this.state.formData.packingCharges,\r\n    taxPercent: this.state.formData.taxPercent,\r\n    taxGroups: this.state.taxGroups\r\n  });\r\n  this.setState(prev => ({\r\n    formData: {\r\n      ...prev.formData,\r\n      lineItems: updatedLineItems,\r\n      freighttaxAmount,\r\n      taxAmount,\r\n      quoteValue\r\n    }\r\n  }));\r\n};\r\n\r\ncomponentDidUpdate(prevProps, prevState) {\r\n  const prevLineItems = prevState.formData.lineItems || [];\r\n  const currLineItems = this.state.formData.lineItems || [];\r\n  if (prevLineItems.length !== currLineItems.length) {\r\n    const prevBreakdownMap = {};\r\n    (this.state.breakdownItems || []).forEach(bi => {\r\n      prevBreakdownMap[bi.productId] = bi;\r\n    });\r\n    this.setState({\r\n      breakdownItems: currLineItems.map((li, idx) => ({\r\n        sno: idx + 1,\r\n        productId: li.itemCode,\r\n        desc: li.itemDescription,\r\n        value: prevBreakdownMap[li.itemCode]?.value || '',\r\n        lastDate: prevBreakdownMap[li.itemCode]?.lastDate || '',\r\n        subProducts: prevBreakdownMap[li.itemCode]?.subProducts || []\r\n      }))\r\n    });\r\n  }\r\n}\r\n\r\nfetchTaxGroups = async () => {\r\n  const snap = await getDocs(collection(db, 'taxGroups'));\r\n  const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n  this.setState({ taxGroups: data });\r\n};\r\n\r\n\r\n  fetchQuotes = async () => {\r\n    const snap = await getDocs(collection(db, 'quotes'));\r\n    const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    this.setState({ quotes: data.reverse() });\r\n  };\r\n\r\n  fetchCustomers = async () => {\r\n    const snap = await getDocs(collection(db, 'customers'));\r\n    const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    this.setState({ customers: data });\r\n  };\r\n\r\n  fetchProducts = async () => {\r\n    const snap = await getDocs(collection(db, 'products'));\r\n    const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    this.setState({ products: data });\r\n  };\r\n  fetchDespatchModes = async () => {\r\n  const snap = await getDocs(collection(db, 'modes'));\r\n  const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n  this.setState({ despatchModes: data });\r\n};\r\n\r\nfetchPaymentTerms = async () => {\r\n  const snap = await getDocs(collection(db, 'paymentTerms'));\r\n  const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n  this.setState({ paymentTerms: data });\r\n};\r\ntoggleTaxGroupSelection = (groupName, lineIdx, checked) => {\r\n  this.setState(prev => {\r\n    const lineItems = [...prev.formData.lineItems];\r\n    const item = { ...lineItems[lineIdx] };\r\n    let taxGroupNames = Array.isArray(item.taxGroupNames) ? [...item.taxGroupNames] : [];\r\n    if (checked) {\r\n      if (!taxGroupNames.includes(groupName)) taxGroupNames.push(groupName);\r\n    } else {\r\n      taxGroupNames = taxGroupNames.filter(g => g !== groupName);\r\n    }\r\n    item.taxGroupNames = taxGroupNames;\r\n    item.taxGroupName = taxGroupNames.join(', ');\r\n    lineItems[lineIdx] = item;\r\n    const { updatedLineItems, freighttaxAmount, taxAmount, quoteValue } = recalculateTotals({\r\n      lineItems,\r\n      freightCharges: prev.formData.freightCharges,\r\n      packingCharges: prev.formData.packingCharges,\r\n      taxPercent: prev.formData.taxPercent,\r\n      taxGroups: prev.taxGroups\r\n    });\r\n\r\n    return {\r\n      formData: {\r\n        ...prev.formData,\r\n        lineItems: updatedLineItems,\r\n        freighttaxAmount,\r\n        taxAmount,\r\n        quoteValue\r\n      }\r\n    };\r\n  });\r\n};\r\n\r\nhandleInputChange = (field, value) => {\r\n  this.setState(prev => ({\r\n    formData: { ...prev.formData, [field]: value }\r\n  }), () => {\r\n    if (['freightCharges', 'taxPercent', 'packingCharges'].includes(field)) {\r\n      const { updatedLineItems, freighttaxAmount, taxAmount, quoteValue } = recalculateTotals({\r\n        lineItems: this.state.formData.lineItems,\r\n        freightCharges: this.state.formData.freightCharges,\r\n        packingCharges: this.state.formData.packingCharges,\r\n        taxPercent: this.state.formData.taxPercent,\r\n        taxGroups: this.state.taxGroups\r\n      });\r\n      this.setState(prev => ({\r\n        formData: {\r\n          ...prev.formData,\r\n          lineItems: updatedLineItems,\r\n          freighttaxAmount,\r\n          taxAmount,\r\n          quoteValue\r\n        }\r\n      }));\r\n    }\r\n  });\r\n};\r\n\r\nhandleBreakdownSelectAll = (checked) => {\r\n  this.setState(prev => ({\r\n    breakdownSelectAll: checked,\r\n    breakdownItems: prev.breakdownItems.map(item => ({ ...item, selected: checked }))\r\n  }));\r\n};\r\nhandleBreakdownRowSelect = (idx, checked) => {\r\n  this.setState(prev => {\r\n    const items = [...prev.breakdownItems];\r\n    items[idx].selected = checked;\r\n    return { breakdownItems: items };\r\n  });\r\n};\r\n\r\n// Handler for per/amt dropdown\r\nhandleBreakdownTypeChange = (type) => {\r\n  this.setState({ breakdownType: type });\r\n};\r\n\r\n// Handler for per/amt value\r\nhandleBreakdownValueChange = (idx, value) => {\r\n  this.setState(prev => {\r\n    const items = [...prev.breakdownItems];\r\n    items[idx].value = value;\r\n    return { breakdownItems: items };\r\n  });\r\n};\r\n\r\n// Handler for last date\r\nhandleBreakdownDateChange = (idx, value) => {\r\n  this.setState(prev => {\r\n    const items = [...prev.breakdownItems];\r\n    items[idx].lastDate = value;\r\n    return { breakdownItems: items };\r\n  });\r\n};\r\nsaveBreakdownToSession = () => {\r\n  sessionStorage.setItem('breakdownItems', JSON.stringify(this.state.breakdownItems));\r\n};\r\nloadBreakdownFromSession = () => {\r\n  const data = sessionStorage.getItem('breakdownItems');\r\n  if (data) this.setState({ breakdownItems: JSON.parse(data) });\r\n};\r\n  handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const { editingId, formData, quotes } = this.state;\r\n    if (!formData.customer) return alert(\"Customer is required\");\r\n    if (formData.lineItems.length === 0) return alert(\"At least one line item is required\");\r\n\r\n    if (editingId) {\r\n      await updateDoc(doc(db, 'quotes', editingId), formData);\r\n    } else {\r\n      formData.quoteNo = `QT${1000 + quotes.length}`;\r\n      await addDoc(collection(db, 'quotes'), formData);\r\n    }\r\n    this.setState({ showForm: false, editingId: null });\r\n    this.fetchQuotes();\r\n  };\r\nloadQuotePreview = (q) => {\r\n  this.setState({\r\n    selectedQuote: q,\r\n    previewMode: true\r\n  });\r\n};\r\n\r\n\r\n  loadQuoteForEdit = (quote) => {\r\n    this.setState({\r\n      formData: {\r\n        ...quote,\r\n        lineItems: Array.isArray(quote.lineItems) ? quote.lineItems : [] // Ensure array\r\n      },\r\n      editingId: quote.id,\r\n      showForm: true,\r\n      previewMode: false,\r\n      activeTab: 'co'\r\n    }, () => {\r\n      if (this.customerInputRef.current) {\r\n        this.customerInputRef.current.value = quote.customer;\r\n      }\r\n    });\r\n  };\r\nconvertToOrder = (quote) => {\r\n  // Save quote in sessionStorage (or navigate with state via router if you use react-router)\r\n  sessionStorage.setItem('quoteToConvert', JSON.stringify(quote));\r\n this.props.history.push('/panelone/Order');\r\n};\r\n// ✅ FULL UPDATED PDF FUNCTION — showQuotePDFWithOrg()\r\n\r\nshowQuotePDFWithOrg = async (quote) => {\r\n  if (!quote || !Array.isArray(quote.lineItems) || quote.lineItems.length === 0) {\r\n    alert(\"Quote data is incomplete.\");\r\n    return;\r\n  }\r\n\r\n  // 1. Fetch org and customer data\r\n  const orgSnap = await getDocs(collection(db, 'businessGroups'));\r\n  const org = orgSnap.docs[0]?.data() || {};\r\n  const customer = this.state.customers.find(\r\n    c => c.custshortName === quote.customer || c.custname === quote.customer\r\n  ) || {};\r\n\r\n  // GST State Map for Place of Supply\r\n  const gstStateMap = {\r\n    \"01\": \"Jammu & Kashmir\", \"02\": \"Himachal Pradesh\", \"03\": \"Punjab\", \"04\": \"Chandigarh\",\r\n    \"05\": \"Uttarakhand\", \"06\": \"Haryana\", \"07\": \"Delhi\", \"08\": \"Rajasthan\", \"09\": \"Uttar Pradesh\",\r\n    \"10\": \"Bihar\", \"11\": \"Sikkim\", \"12\": \"Arunachal Pradesh\", \"13\": \"Nagaland\", \"14\": \"Manipur\",\r\n    \"15\": \"Mizoram\", \"16\": \"Tripura\", \"17\": \"Meghalaya\", \"18\": \"Assam\", \"19\": \"West Bengal\",\r\n    \"20\": \"Jharkhand\", \"21\": \"Odisha\", \"22\": \"Chhattisgarh\", \"23\": \"Madhya Pradesh\", \"24\": \"Gujarat\",\r\n    \"25\": \"Daman and Diu\", \"26\": \"Dadra and Nagar Haveli\", \"27\": \"Maharashtra\", \"28\": \"Andhra Pradesh (Old)\",\r\n    \"29\": \"Karnataka\", \"30\": \"Goa\", \"31\": \"Lakshadweep\", \"32\": \"Kerala\", \"33\": \"Tamil Nadu\",\r\n    \"34\": \"Puducherry\", \"35\": \"Andaman and Nicobar Islands\", \"36\": \"Telangana\", \"37\": \"Andhra Pradesh\",\r\n    \"97\": \"Other Territory\"\r\n  };\r\n\r\n  // Helper for Place of Supply\r\n  const getPlaceOfSupply = (gstin) => {\r\n    if (!gstin || gstin.length < 2) return '';\r\n    const code = gstin.substring(0, 2);\r\n    const state = gstStateMap[code];\r\n    return state ? `${code} - ${state}` : '';\r\n  };\r\n\r\n  // 2. Enrich line items\r\n  const enrichedItems = quote.lineItems.map(item => {\r\n    const product = this.state.products.find(p => p.productId === item.itemCode) || {};\r\n    return {\r\n      ...item,\r\n      ptshortName: product.ptshortName || '',\r\n      hsnCode: product.hsnCode || '',\r\n      uom: product.stockingUOM || '',\r\n      cgst: item.cgst || 0,\r\n      sgst: item.sgst || 0,\r\n      igst: item.igst || 0,\r\n      taxGroupNames: item.taxGroupNames || (item.taxGroupName ? item.taxGroupName.split(',').map(s => s.trim()) : [])\r\n    };\r\n  });\r\n\r\n  // 3. Subtotal (without tax)\r\n  const subtotal = enrichedItems.reduce((sum, item) => sum + ((parseFloat(item.unitPrice) || 0) * (parseFloat(item.qty) || 0)), 0);\r\n  const freightCharges = parseFloat(quote.freightCharges || 0);\r\n  const freightTax = parseFloat(quote.freighttaxAmount || 0);\r\n  const totalTaxAmount = parseFloat(quote.taxAmount || 0);\r\n  const grandTotal = parseFloat(quote.quoteValue || (subtotal + totalTaxAmount));\r\n  const amountWords = `INR ${toWords(Math.floor(grandTotal))} Only`;\r\n\r\n  // 4. Tax breakdown by group\r\n  let taxBreakdown = {};\r\n  let taxGroupDetails = [];\r\n  let sno = 1;\r\n  enrichedItems.forEach(item => {\r\n    const qty = parseFloat(item.qty || 0);\r\n    const unitPrice = parseFloat(item.unitPrice || 0);\r\n    const base = qty * unitPrice;\r\n    (item.taxGroupNames || []).forEach(tgName => {\r\n      // Find group in taxGroups\r\n      const group = (this.state.taxGroups || []).find(g => g.groupName === tgName);\r\n      if (group) {\r\n        group.lineItems.forEach(li => {\r\n          const key = `${tgName} - ${li.component} (${li.percentOrAmt}${li.type === 'Amount' ? '' : '%'})`;\r\n          let taxAmt = 0;\r\n          if (li.type === 'Amount') taxAmt = parseFloat(li.percentOrAmt || 0);\r\n          else taxAmt = (base * parseFloat(li.percentOrAmt || 0)) / 100;\r\n          taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\r\n          taxGroupDetails.push({\r\n            sno: sno++,\r\n            group: tgName,\r\n            peramt: `${li.percentOrAmt}${li.type === 'Amount' ? '' : '%'}`,\r\n            taxAmt: taxAmt.toFixed(2)\r\n          });\r\n        });\r\n      }\r\n    });\r\n    // Legacy support for cgst/sgst/igst\r\n    if (item.cgst) {\r\n      const key = `CGST ${item.cgst}%`;\r\n      const taxAmt = (base * item.cgst) / 100;\r\n      taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\r\n      taxGroupDetails.push({\r\n        sno: sno++,\r\n        group: key,\r\n        peramt: `${item.cgst}%`,\r\n        taxAmt: taxAmt.toFixed(2)\r\n      });\r\n    }\r\n    if (item.sgst) {\r\n      const key = `SGST ${item.sgst}%`;\r\n      const taxAmt = (base * item.sgst) / 100;\r\n      taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\r\n      taxGroupDetails.push({\r\n        sno: sno++,\r\n        group: key,\r\n        peramt: `${item.sgst}%`,\r\n        taxAmt: taxAmt.toFixed(2)\r\n      });\r\n    }\r\n    if (item.igst) {\r\n      const key = `IGST ${item.igst}%`;\r\n      const taxAmt = (base * item.igst) / 100;\r\n      taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\r\n      taxGroupDetails.push({\r\n        sno: sno++,\r\n        group: key,\r\n        peramt: `${item.igst}%`,\r\n        taxAmt: taxAmt.toFixed(2)\r\n      });\r\n    }\r\n  });\r\n  if (freightTax > 0) {\r\n    taxBreakdown[\"Freight Tax\"] = freightTax;\r\n    taxGroupDetails.push({\r\n      sno: sno++,\r\n      group: \"Freight Tax\",\r\n      peramt: \"-\",\r\n      taxAmt: freightTax.toFixed(2)\r\n    });\r\n  }\r\n\r\n  // 5. Milestone breakdown (with subproducts)\r\n  const { breakdownItems, breakdownType } = this.state;\r\n\r\n  // 6. Build HTML for PDF\r\n  const container = document.createElement('div');\r\n  container.id = 'pdf-preview-container';\r\n  container.style.width = '794px';\r\n  container.style.padding = '40px';\r\n  container.style.fontFamily = 'Arial';\r\n\r\n  // 7. Main PDF content\r\n  container.innerHTML = `\r\n    <div style=\"display:flex; justify-content:space-between; align-items:center;\">\r\n      <img src=\"${org.logoUrl || ''}\" style=\"height:50px;\" />\r\n      <div style=\"font-size:18px; font-weight:bold;\">QUOTATION</div>\r\n    </div>\r\n    <hr/>\r\n    <div style=\"display:flex; justify-content:space-between; font-size:11px;\">\r\n      <div style=\"line-height:1.5; width:50%;\">\r\n        <b>${org.bgName || ''}</b><br/>\r\n        ${org.address || ''}<br/>\r\n        <b>Email:</b> ${org.email || ''}<br/>\r\n        <b>Website:</b> ${org.website || ''}<br/>\r\n        <b>GSTIN:</b> ${org.gstin || ''}<br/>\r\n        <b>Mobile:</b> ${org.mobile || ''}<br/>\r\n        <b>CIN:</b> ${org.cin || ''}\r\n      </div>\r\n      <table style=\"font-size:11px; text-align:left;\">\r\n        <tr><td><b>Quote No</b></td><td>: ${quote.quoteNo}</td></tr>\r\n        <tr><td><b>Quote Date</b></td><td>: ${quote.quoteDate}</td></tr>\r\n        <tr><td><b>Currency</b></td><td>: ${quote.currency || 'INR'}</td></tr>\r\n        <tr><td><b>Despatch</b></td><td>: ${quote.despatchMode || ''}</td></tr>\r\n      </table>\r\n    </div>\r\n\r\n    <div style=\"margin-top:15px; display:flex; justify-content:space-between; font-size:11px;\">\r\n      <div style=\"width:48%;\">\r\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Bill To</b>\r\n        <div style=\"border:1px solid #ccc; padding:6px;\">\r\n         <b>${quote.customer || ''}</b><br/>\r\n          ${quote.billTo?.replace(/\\n/g, '<br/>') || ''}\r\n        </div>\r\n        <div style=\"font-size:10px; margin-top:6px;\">\r\n            <b>GSTIN:</b> ${customer.gstin || ''}<br/>\r\n            <b>Email:</b> ${customer.email || ''}<br/>\r\n            <b>Contact:</b> ${customer.contactPerson || ''}<br/>\r\n            <b>Phone:</b> ${customer.phone || ''}\r\n        </div>\r\n      </div>\r\n      <div style=\"width:48%;\">\r\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Ship To</b>\r\n        <div style=\"border:1px solid #ccc; padding:6px;\">\r\n         <b>${quote.customer || ''}</b><br/>\r\n          ${quote.shipTo?.replace(/\\n/g, '<br/>') || ''}\r\n        </div>\r\n        <div style=\"font-size:10px; margin-top:6px;\">\r\n          <b>Place of Supply:</b> ${getPlaceOfSupply(customer.gstin || '')}\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\r\n      <thead>\r\n        <tr style=\"background:#f4f6fa;\">\r\n          <th style=\"border:1px solid #011b56;\">Item Code</th>\r\n          <th style=\"border:1px solid #011b56;\">Description</th>\r\n          <th style=\"border:1px solid #011b56;\">HSN</th>\r\n          <th style=\"border:1px solid #011b56;\">UOM</th>\r\n          <th style=\"border:1px solid #011b56;\">Qty</th>\r\n          <th style=\"border:1px solid #011b56;\">Unit Price</th>\r\n          <th style=\"border:1px solid #011b56;\">GST%</th>\r\n          <th style=\"border:1px solid #011b56;\">Item Total</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        ${enrichedItems.map(item => {\r\n          const gstLabel = (item.taxGroupNames && item.taxGroupNames.length)\r\n            ? item.taxGroupNames.join(', ')\r\n            : (item.taxGroupName || item.taxId || '-');\r\n          return `\r\n            <tr>\r\n              <td style=\"border:1px solid #011b56;\">${item.itemCode}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.itemDescription}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.hsnCode}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.uom}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.qty}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.unitPrice}</td>\r\n              <td style=\"border:1px solid #011b56;\">${gstLabel}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.total}</td>\r\n            </tr>`;\r\n        }).join('')}\r\n        <tr>\r\n          <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Subtotal</b></td>\r\n          <td style=\"border:1px solid #011b56;\"><b>${subtotal.toFixed(2)}</b></td>\r\n        </tr>\r\n        ${Object.entries(taxBreakdown).map(([key, val]) => `\r\n          <tr>\r\n            <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>${key}</b></td>\r\n            <td style=\"border:1px solid #011b56;\">${val.toFixed(2)}</td>\r\n          </tr>\r\n        `).join('')}\r\n        <tr>\r\n          <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td>\r\n          <td style=\"border:1px solid #011b56;\"><b>${totalTaxAmount.toFixed(2)}</b></td>\r\n        </tr>\r\n        <tr>\r\n          <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Grand Total</b></td>\r\n          <td style=\"border:1px solid #011b56;\"><b>${grandTotal.toFixed(2)}</b></td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n    <div style=\"margin-top:8px; font-size:11px;\"><b>Amount in Words:</b> ${amountWords}</div>\r\n    <div style=\"margin-top:20px; text-align:right; font-size:10px;\">Printed on ${new Date().toLocaleString()}</div>\r\n  `;\r\n\r\n  document.body.appendChild(container);\r\n  const canvas = await html2canvas(container, { scale: 2, useCORS: true });\r\n  const imgData = canvas.toDataURL('image/png');\r\n  const pdf = new jsPDF('p', 'pt', 'a4');\r\n  const width = 595.28;\r\n  const height = canvas.height * width / canvas.width;\r\n  pdf.addImage(imgData, 'PNG', 0, 0, width, height);\r\n  document.body.removeChild(container);\r\n\r\n  // ...existing code...\r\n\r\n// 8. Milestone breakdown and tax breakdown on the same page, same style as quote table\r\nif (breakdownItems && breakdownItems.length > 0) {\r\n  pdf.addPage();\r\n\r\n  let milestoneRows = breakdownItems.filter(bi => bi.selected !== false).map((item, idx) => {\r\n    const mainItem = enrichedItems.find(li => li.itemCode === item.productId);\r\n    const mainItemTotal = mainItem ? (parseFloat(mainItem.total) || 0) : 0;\r\n    return `\r\n      <tr>\r\n        <td style=\"border:1px solid #011b56;\">${item.sno}</td>\r\n        <td style=\"border:1px solid #011b56;\">${item.productId}</td>\r\n        <td style=\"border:1px solid #011b56;\">${item.desc}</td>\r\n        <td style=\"border:1px solid #011b56;\">${item.value} ${breakdownType === 'Percentage' ? '%' : '₹'}</td>\r\n        <td style=\"border:1px solid #011b56;\">${item.lastDate}</td>\r\n        <td style=\"border:1px solid #011b56;\">${mainItemTotal.toFixed(2)}</td>\r\n      </tr>\r\n      ${(item.subProducts || []).map(sp => {\r\n        let spTotal = 0;\r\n        if (sp.type === 'Amount') spTotal = parseFloat(sp.value || 0);\r\n        else if (sp.type === 'Percentage') spTotal = mainItemTotal * parseFloat(sp.value || 0) / 100;\r\n        return `\r\n          <tr style=\"background: #f9f9f9;\">\r\n            <td style=\"border:1px solid #011b56;\"></td>\r\n            <td style=\"border:1px solid #011b56;\" colspan=\"2\" style=\"padding-left: 40px;\">→ ${sp.name}</td>\r\n            <td style=\"border:1px solid #011b56;\">${sp.type === 'Amount' ? `₹${sp.value}` : `${sp.value}%`}</td>\r\n            <td style=\"border:1px solid #011b56;\">${sp.dueDate}</td>\r\n            <td style=\"border:1px solid #011b56;\">${spTotal.toFixed(2)}</td>\r\n          </tr>\r\n        `;\r\n      }).join('')}\r\n    `;\r\n  }).join('');\r\n  let taxRows = taxGroupDetails.map(row => {\r\n    let groupLabel = row.group;\r\n    if (groupLabel.includes('-')) {\r\n      groupLabel = groupLabel.split('-')[1]?.trim() || groupLabel;\r\n    }\r\n    return `\r\n      <tr>\r\n        <td style=\"border:1px solid #011b56;\">${row.sno}</td>\r\n        <td style=\"border:1px solid #011b56;\">${groupLabel}</td>\r\n        <td style=\"border:1px solid #011b56;\">${row.peramt}</td>\r\n        <td style=\"border:1px solid #011b56;\">${row.taxAmt}</td>\r\n      </tr>\r\n    `;\r\n  }).join('');\r\n\r\n  let combinedHtml = `\r\n    <div style=\"font-family:Arial; padding:40px; width:100%;\">\r\n      <h3 style=\"margin-bottom:10px; font-size:16px;\">Milestone Breakdown</h3>\r\n      <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\r\n        <thead>\r\n          <tr style=\"background:#f4f6fa;\">\r\n            <th style=\"border:1px solid #011b56;\">S.No</th>\r\n            <th style=\"border:1px solid #011b56;\">Item ID</th>\r\n            <th style=\"border:1px solid #011b56;\">Desc</th>\r\n            <th style=\"border:1px solid #011b56;\">${breakdownType}</th>\r\n            <th style=\"border:1px solid #011b56;\">Last Date</th>\r\n            <th style=\"border:1px solid #011b56;\">Item Total</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          ${milestoneRows}\r\n        </tbody>\r\n      </table>\r\n      <h3 style=\"margin-bottom:10px; margin-top:30px; font-size:16px;\">Tax Breakdown</h3>\r\n      <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\r\n        <thead>\r\n          <tr style=\"background:#f4f6fa;\">\r\n            <th style=\"border:1px solid #011b56;\">S.No</th>\r\n            <th style=\"border:1px solid #011b56;\">Tax Group</th>\r\n            <th style=\"border:1px solid #011b56;\">Per/Amt</th>\r\n            <th style=\"border:1px solid #011b56;\">Tax Amt</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          ${taxRows}\r\n          <tr>\r\n            <td colspan=\"3\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td>\r\n            <td style=\"border:1px solid #011b56;\"><b>${totalTaxAmount.toFixed(2)}</b></td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n      <div style=\"margin-top:40px; text-align:right; font-size:11px;\">\r\n        For ${org.bgName || ''}<br/>\r\n        Authorized Signatory\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  const combinedContainer = document.createElement('div');\r\n  combinedContainer.innerHTML = combinedHtml;\r\n  document.body.appendChild(combinedContainer);\r\n  const combinedCanvas = await html2canvas(combinedContainer, { scale: 2, useCORS: true });\r\n  const combinedImg = combinedCanvas.toDataURL('image/png');\r\n  pdf.addImage(combinedImg, 'PNG', 0, 0, width, combinedCanvas.height * width / combinedCanvas.width);\r\n  document.body.removeChild(combinedContainer);\r\n}\r\n\r\n  pdf.setFontSize(11);\r\n  pdf.text(`For ${org.bgName || ''}`, width - 200, 780);\r\n  pdf.text('Authorized Signatory', width - 200, 800);\r\n\r\n  // 11. Show PDF\r\n  const blob = pdf.output('blob');\r\n  const url = URL.createObjectURL(blob);\r\n  const newWin = window.open();\r\n  newWin.document.write(`\r\n    <html><head><title>Quote PDF Preview</title></head>\r\n    <body style=\"margin:0;\">\r\n      <iframe width=\"100%\" height=\"100%\" style=\"border:none;\" src=\"${url}\"></iframe>\r\n      <button onclick=\"document.querySelector('iframe').contentWindow.print()\" style=\"position:fixed;top:10px;right:110px;\"></button>\r\n      <a href=\"${url}\" download=\"Quote_${quote.quoteNo || 'PDF'}.pdf\" style=\"position:fixed;top:10px;right:10px;\"></a>\r\n    </body></html>\r\n  `);\r\n  newWin.document.close();\r\n};\r\n\r\n  showOverlay = (type) => this.setState({ overlayType: type, overlaySearch: '' });\r\n  hideOverlay = () => this.setState({ overlayType: '', overlaySearch: '' });\r\n\r\n\r\n  selectOverlayValue = (value) => {\r\n    if (this.state.overlayType === 'customer') {\r\n      this.setState(prev => ({\r\n        formData: {\r\n          ...prev.formData,\r\n          customer: value.custname || value.custcode || '', // Use custname or custcode\r\n          billTo: this.formatAddress(value.billTo),\r\n          shipTo: this.formatAddress(value.shipTo),\r\n          currency: value.currency || '',\r\n          // despatchMode: value.despatchMode || '', // No auto-fill for despatch mode\r\n          // paymentTerms: value.paymentTerms || '' // No auto-fill for payment terms\r\n        },\r\n        overlayType: '',\r\n        overlaySearch: ''\r\n      }), () => {\r\n        if (this.customerInputRef.current) {\r\n          this.customerInputRef.current.value = value.custname || value.custcode || '';\r\n        }\r\n      });\r\n    }\r\n  };\r\nrenderTaxOverlay = () => {\r\n  const { taxGroups, currentTaxLineIdx, formData } = this.state;\r\n  if (currentTaxLineIdx === null) return null;\r\n\r\n  const item = formData.lineItems[currentTaxLineIdx];\r\n  const selected = new Set(item.taxGroupNames || []);\r\n\r\n  return (\r\n    <div style={{\r\n      position: 'absolute',\r\n      zIndex: 9999,\r\n      top: '10%',\r\n      left: '20%',\r\n      background: '#fff',\r\n      border: '1px solid #ccc',\r\n      padding: '20px',\r\n      boxShadow: '0 0 10px rgba(0,0,0,0.3)',\r\n      width: '800px',\r\n      maxHeight: '60vh',\r\n      overflowY: 'auto'\r\n    }}>\r\n      <h5>Select Tax Groups</h5>\r\n      <table className=\"table table-sm table-bordered\">\r\n        <thead>\r\n          <tr><th></th><th>Group</th><th>Type</th><th>%</th></tr>\r\n        </thead>\r\n        <tbody>\r\n          {taxGroups.map(tg => (\r\n            <tr key={tg.groupName}>\r\n              <td>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={selected.has(tg.groupName)}\r\n                  onChange={e => this.toggleTaxGroupSelection(tg.groupName, currentTaxLineIdx, e.target.checked)}\r\n                />\r\n              </td>\r\n              <td>{tg.groupName}</td>\r\n              <td>{tg.lineItems.map(li => li.component).join(', ')}</td>\r\n              <td>{tg.lineItems.map(li => li.percentOrAmt).join(', ')}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n      <div className=\"text-right mt-2\">\r\n        <button type=\"button\" className=\"btn btn-sm btn-primary\" onClick={() => this.setState({ showTaxOverlay: false })}>\r\n          Done\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\n\r\n renderOverlay = () => {\r\n  const { overlayType, overlaySearch, customers, despatchModes, paymentTerms } = this.state;\r\n\r\n  const getFilteredRows = (list, nameKey = 'name', codeKey = 'shortName') =>\r\n    list.filter(item =>\r\n      (item[nameKey] || '').toLowerCase().includes((overlaySearch || '').toLowerCase()) ||\r\n      (item[codeKey] || '').toLowerCase().includes((overlaySearch || '').toLowerCase())\r\n    );\r\n\r\n  const handleSelect = (item) => {\r\n    if (overlayType === 'customer') {\r\n      this.selectOverlayValue(item);\r\n    } else if (overlayType === 'despatchMode') {\r\n      this.setState(prev => ({\r\n        formData: {\r\n          ...prev.formData,\r\n          despatchMode: item.name\r\n        },\r\n        overlayType: '',\r\n        overlaySearch: ''\r\n      }));\r\n    } else if (overlayType === 'paymentTerms') {\r\n      this.setState(prev => ({\r\n        formData: {\r\n          ...prev.formData,\r\n          paymentTerms: item.name\r\n        },\r\n        overlayType: '',\r\n        overlaySearch: ''\r\n      }));\r\n    }\r\n  };\r\n\r\n  let title = '';\r\n  let headers = [];\r\n  let rows = [];\r\n\r\n  if (overlayType === 'customer') {\r\n    title = 'Select Customer';\r\n    headers = ['Name', 'Code', 'Short Name'];\r\n    rows = getFilteredRows(customers, 'custname', 'custcode');\r\n  } else if (overlayType === 'despatchMode') {\r\n    title = 'Select Despatch Mode';\r\n    headers = ['Name', 'Short Name'];\r\n    rows = getFilteredRows(despatchModes);\r\n  } else if (overlayType === 'paymentTerms') {\r\n    title = 'Select Payment Terms';\r\n    headers = ['Name', 'Short Name'];\r\n    rows = getFilteredRows(paymentTerms);\r\n  } else {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"custom-overlay\">\r\n      <div className=\"custom-overlay-content\">\r\n        <div className=\"custom-overlay-title\">{title}</div>\r\n        <input\r\n          type=\"text\"\r\n          className=\"form-control mb-2\"\r\n          placeholder={`Search ${overlayType}...`}\r\n          value={overlaySearch}\r\n          onChange={e => this.setState({ overlaySearch: e.target.value })}\r\n        />\r\n        <div style={{ maxHeight: 300, overflowY: 'auto' }}>\r\n          <table className=\"table table-bordered table-sm\">\r\n            <thead>\r\n              <tr>\r\n                {headers.map((h, i) => <th key={i}>{h}</th>)}\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {rows.map((item, i) => (\r\n                <tr key={item.id || i} onClick={() => handleSelect(item)} style={{ cursor: 'pointer' }}>\r\n                  {headers.map((h, j) => (\r\n                    <td key={j}>\r\n                      {overlayType === 'customer'\r\n                        ? h === 'Name' ? item.custname\r\n                          : h === 'Code' ? item.custcode\r\n                          : item.custshortName\r\n                        : h === 'Name' ? item.name\r\n                          : item.shortName}\r\n                    </td>\r\n                  ))}\r\n                </tr>\r\n              ))}\r\n              {rows.length === 0 && (\r\n                <tr>\r\n                  <td colSpan={headers.length} className=\"text-center\">No records found</td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <button className=\"btn btn-secondary btn-sm mt-2\" onClick={this.hideOverlay}>Cancel</button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n  renderProductOverlay = () => {\r\n    const { products, productOverlaySearch, selectedProductIds } = this.state;\r\n    const filtered = products.filter(p =>\r\n      (p.ptshortName || '').toLowerCase().includes(productOverlaySearch.toLowerCase()) ||\r\n      (p.ptdescription || '').toLowerCase().includes(productOverlaySearch.toLowerCase()) ||\r\n      (p.itemCode || '').toLowerCase().includes(productOverlaySearch.toLowerCase())\r\n    );\r\n    return (\r\n      <div className=\"custom-overlay\">\r\n        <div className=\"custom-overlay-content\">\r\n          <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n            <div className=\"custom-overlay-title\">Select Products</div>\r\n            <button\r\n              className=\"btn btn-success btn-sm\"\r\n              onClick={() => {\r\n                const selectedProducts = products.filter(p => this.state.selectedProductIds.includes(p.id));\r\n                this.setState(prev => ({\r\n                  formData: {\r\n                    ...prev.formData,\r\n                    lineItems: [\r\n                      ...prev.formData.lineItems,\r\n                      ...selectedProducts\r\n                        .filter(p => !prev.formData.lineItems.some(item => item.id === p.id))\r\n                        .map(p => ({\r\n                          id: p.id,\r\n                          itemCode: p.productId || '',\r\n                          itemDescription: p.ptdescription || '',\r\n                          itemType: p.itemType || '',\r\n                          materialType: p.materialType || '',\r\n                          onHand: p.onHand || 0,\r\n                          taxGroup: p.taxGroup || '',\r\n                          taxGroupName: p.taxGroup || '',\r\n                          custPartNo: p.custPartNo || '', \r\n                          hsnNo: p.hsnNo || '',\r\n                          unitPrice: p.unitPrice || 0,\r\n                          qty: 1,\r\n                          total: (p.unitPrice || 0).toFixed(2)\r\n                        }))\r\n                    ]\r\n                  },\r\n                  productOverlayVisible: false,\r\n                  selectedProductIds: []\r\n                }));\r\n              }}\r\n            >Add Selected</button>\r\n          </div>\r\n          <input\r\n            type=\"text\"\r\n            className=\"form-control mb-2\"\r\n            placeholder=\"Search products...\"\r\n            value={productOverlaySearch}\r\n            onChange={e => this.setState({ productOverlaySearch: e.target.value })}\r\n          />\r\n          <div style={{ maxHeight: 300, overflowY: 'auto' }}>\r\n            <table className=\"table table-bordered table-sm\">\r\n              <thead>\r\n                <tr>\r\n                  <th></th>\r\n                  <th>Item Code</th>\r\n                  <th>Item Desc</th>\r\n                  <th>Item Type</th>\r\n                  <th>Material Type</th>\r\n                  <th>On Hand</th>\r\n                  <th>Tax Grp</th>\r\n                  <th>Cust Part No</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {filtered.map(p => (\r\n                  <tr key={p.id}>\r\n                    <td>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedProductIds.includes(p.id)}\r\n                        onChange={e => {\r\n                          const checked = e.target.checked;\r\n                          this.setState(prev => ({\r\n                            selectedProductIds: checked\r\n                              ? [...prev.selectedProductIds, p.id]\r\n                              : prev.selectedProductIds.filter(id => id !== p.id)\r\n                          }));\r\n                        }}\r\n                      />\r\n                    </td>\r\n                    <td>{p.productId}</td>\r\n                    <td>{p.ptdescription || ''}</td>\r\n                    <td>{p.itemType || ''}</td>\r\n                    <td>{p.materialType || ''}</td>\r\n                    <td>{p.onHand || 0}</td>\r\n                    <td>{p.taxGroup || ''}</td>\r\n                    <td>{p.custPartNo || ''}</td>\r\n                  </tr>\r\n                ))}\r\n                {filtered.length === 0 && (\r\n                  <tr>\r\n                    <td colSpan=\"8\" className=\"text-center\">No products found</td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          {/* Add pagination here if needed, for now, it's just a placeholder */}\r\n          <div className=\"d-flex justify-content-between align-items-center mt-2\">\r\n            <span>Page 1 of 1</span>\r\n            <button className=\"btn btn-secondary btn-sm\" onClick={() => this.setState({ productOverlayVisible: false, selectedProductIds: [] })}>Cancel</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  renderBreakdownTab = () => {\r\n  const { breakdownItems, breakdownType, formData } = this.state;\r\n\r\n  // Get item totals from lineItems (with tax)\r\n  const itemTotals = (formData.lineItems || []).reduce((acc, li) => {\r\n    acc[li.itemCode] = parseFloat(li.total || 0);\r\n    return acc;\r\n  }, {});\r\n\r\n  // Sum of all item totals\r\n  const sumOfItemTotals = Object.values(itemTotals).reduce((sum, val) => sum + val, 0);\r\n\r\n  return (\r\n    <div>\r\n      <h5>Add Milestone</h5>\r\n      <div className=\"row mb-2\">\r\n        <div className=\"col\"><b>Quote Value:</b> {formData.quoteValue}</div>\r\n        <div className=\"col\"><b>Tax Amount:</b> {formData.taxAmount}</div>\r\n        <div className=\"col\"><b>Sum of Item Totals:</b> {sumOfItemTotals.toFixed(2)}</div>\r\n      </div>\r\n      <table className=\"table table-bordered\">\r\n        <thead>\r\n          <tr>\r\n            <th>S.No</th>\r\n            <th>Item Code</th>\r\n            <th>Desc</th>\r\n            <th>\r\n              <b>Per/Amt</b>\r\n              <select\r\n                value={breakdownType}\r\n                onChange={e => this.handleBreakdownTypeChange(e.target.value)}\r\n                className=\"form-control form-control-sm font-weight-bold\"\r\n                style={{ fontWeight: 'bold', display: 'inline-block', width: 'auto', marginLeft: 8 }}\r\n              >\r\n                <option value=\"Percentage\">%</option>\r\n                <option value=\"Amount\">₹</option>\r\n              </select>\r\n            </th>\r\n            <th>Due Date</th>\r\n            <th>\r\n              <b>Item Total</b>\r\n            </th>\r\n            <th>Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {breakdownItems.map((item, idx) => {\r\n            // Main item total (with tax) from lineItems\r\n            const mainItemTotal = itemTotals[item.productId] || 0;\r\n\r\n            // Sub-product sum logic\r\n            const subTotal = (item.subProducts || []).reduce((sum, sp) => {\r\n              if (sp.type === 'Amount') return sum + parseFloat(sp.value || 0);\r\n              if (sp.type === 'Percentage') return sum + (mainItemTotal * parseFloat(sp.value || 0) / 100);\r\n              return sum;\r\n            }, 0);\r\n\r\n            const isSatisfied = Math.abs(mainItemTotal - subTotal) < 0.01 && subTotal > 0;\r\n\r\n            return (\r\n              <React.Fragment key={idx}>\r\n                <tr>\r\n                  <td>{item.sno}</td>\r\n                  <td>{item.productId}</td>\r\n                  <td>{item.desc}</td>\r\n                  <td>\r\n                    <div className=\"input-group input-group-sm\">\r\n                      <div className=\"input-group-prepend\">\r\n                        <span className=\"input-group-text\" style={{ fontWeight: 'bold' }}>\r\n                          {breakdownType === 'Percentage' ? '%' : '₹'}\r\n                        </span>\r\n                      </div>\r\n                      <input\r\n                        type=\"number\"\r\n                        className=\"form-control\"\r\n                        value={item.value}\r\n                        onChange={e => {\r\n                          this.handleBreakdownValueChange(idx, e.target.value);\r\n                          this.saveBreakdownToSession();\r\n                        }}\r\n                        placeholder={breakdownType === 'Percentage' ? 'Enter %' : 'Enter Amt'}\r\n                        style={{ fontWeight: 'bold' }}\r\n                      />\r\n                    </div>\r\n                  </td>\r\n                  <td>\r\n                    <input\r\n                      type=\"date\"\r\n                      className=\"form-control form-control-sm\"\r\n                      value={item.lastDate}\r\n                      onChange={e => {\r\n                        this.handleBreakdownDateChange(idx, e.target.value);\r\n                        this.saveBreakdownToSession();\r\n                      }}\r\n                    />\r\n                  </td>\r\n                  <td>\r\n                    <span style={{ color: isSatisfied ? 'green' : 'red', fontWeight: 'bold' }}>\r\n                      {mainItemTotal.toFixed(2)}\r\n                    </span>\r\n                  </td>\r\n                  <td>\r\n                    <button\r\n                      type = \"button\" className=\"btn btn-sm btn-outline-primary\"\r\n                      onClick={() => this.setState({ showSubProductDialog: true, currentBreakdownIdx: idx })}\r\n                    >\r\n                      + Add Milestone\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n                {/* Sub-products */}\r\n                {(item.subProducts || []).map((sp, spIdx) => {\r\n                  // Sub-product item total calculation\r\n                  let spTotal = 0;\r\n                  if (sp.type === 'Amount') spTotal = parseFloat(sp.value || 0);\r\n                  else if (sp.type === 'Percentage') spTotal = mainItemTotal * parseFloat(sp.value || 0) / 100;\r\n                  return (\r\n                    <tr key={spIdx} style={{ background: '#f9f9f9' }}>\r\n                      <td></td>\r\n                      <td colSpan={2} style={{ paddingLeft: 40 }}>→ {sp.name}</td>\r\n                      <td>\r\n                        <span style={{ fontWeight: 'bold' }}>\r\n                          {sp.type === 'Amount' ? `₹${sp.value}` : `${sp.value}%`}\r\n                        </span>\r\n                      </td>\r\n                      <td>{sp.dueDate}</td>\r\n                      <td>\r\n                        <span style={{ fontWeight: 'bold' }}>{spTotal.toFixed(2)}</span>\r\n                      </td>\r\n                      <td></td>\r\n                    </tr>\r\n                  );\r\n                })}\r\n              </React.Fragment>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nrenderSubProductDialog = () => {\r\n  const { showSubProductDialog, subProductForm } = this.state;\r\n  if (!showSubProductDialog) return null;\r\n  return (\r\n    <div className=\"custom-overlay\" onClick={(e) => e.stopPropagation()}>\r\n      <div className=\"custom-overlay-content\" style={{ width: 400 }}>\r\n        <div className=\"form-group\">\r\n          <label>Name</label>\r\n          <input className=\"form-control\" value={subProductForm.name} onChange={e => this.setState({ subProductForm: { ...subProductForm, name: e.target.value } })} />\r\n        </div>\r\n        <div className=\"form-group\">\r\n          <label>Type</label>\r\n          <select className=\"form-control\" value={subProductForm.type} onChange={e => this.setState({ subProductForm: { ...subProductForm, type: e.target.value } })}>\r\n            <option value=\"Amount\">Amount</option>\r\n            <option value=\"Percentage\">Percentage</option>\r\n          </select>\r\n        </div>\r\n        <div className=\"form-group\">\r\n          <label>{subProductForm.type}</label>\r\n          <input className=\"form-control\" type=\"number\" value={subProductForm.value} onChange={e => this.setState({ subProductForm: { ...subProductForm, value: e.target.value } })} />\r\n        </div>\r\n        <div className=\"form-group\">\r\n          <label>Due Date</label>\r\n          <input className=\"form-control\" type=\"date\" value={subProductForm.dueDate} onChange={e => this.setState({ subProductForm: { ...subProductForm, dueDate: e.target.value } })} />\r\n        </div>\r\n        <div className=\"text-right\">\r\n          <button type=\"button\" className=\"btn btn-secondary mr-2\" onClick={() => this.setState({ showSubProductDialog: false })}>Cancel</button>\r\n\r\n          <button type=\"button\" className=\"btn btn-primary\" onClick={(e) => {\r\n            e.preventDefault();  //  this prevents the form submission\r\n            this.handleAddSubProduct();\r\n          }}>Add</button>\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nhandleAddSubProduct = () => {\r\n  const { currentBreakdownIdx, subProductForm, breakdownItems } = this.state;\r\n  if (!subProductForm.name || !subProductForm.value) return;\r\n  // Clone breakdownItems and subProducts for immutability\r\n  const items = breakdownItems.map((item, idx) => {\r\n    if (idx === currentBreakdownIdx) {\r\n      const subProducts = Array.isArray(item.subProducts) ? [...item.subProducts] : [];\r\n      subProducts.push({ ...subProductForm });\r\n      return { ...item, subProducts };\r\n    }\r\n    return item;\r\n  });\r\n  this.setState({\r\n    breakdownItems: items,\r\n    showSubProductDialog: false,\r\n    subProductForm: { name: '', value: '', type: 'Amount', dueDate: '' }\r\n  }, this.saveBreakdownToSession);\r\n};\r\n  renderQuoteTable = () => (\r\n    <div className=\"card mt-4 full-height\">\r\n      <div className=\"card-body\">\r\n        <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n          <h4 className=\"card-title\">Quotes</h4>\r\n          <button className=\"btn btn-primary\" onClick={() => this.setState({ showForm: true })}>+ Add Quote</button>\r\n        </div>\r\n        <div className=\"table-responsive\">\r\n          <table className=\"table table-bordered table-hover\">\r\n            <thead className=\"thead-light\">\r\n              <tr style={{ fontSize: '14px' }}>\r\n                <th>Quote No</th>\r\n                <th>Customer</th>\r\n                <th>Date</th>\r\n                <th>Quote Value</th>\r\n                <th>Status</th>\r\n                <th>Print</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {this.state.quotes.map((q, i) => (\r\n                <tr key={i} style={{ fontSize: '14px' }}>\r\n                  <td>\r\n                    <button\r\n                      className=\"btn btn-link p-0\"\r\n                      onClick={() => this.loadQuotePreview(q)}\r\n                    >\r\n                      {q.quoteNo}\r\n                    </button>\r\n                  </td>\r\n                  <td>{q.customer}</td>\r\n                  <td>{q.quoteDate}</td>\r\n                  <td>{q.quoteValue}</td>\r\n                  <td><label className=\"badge badge-info\">{q.status}</label></td>\r\n                  <td>\r\n                  <i\r\n                    className=\"mdi mdi-printer menu-icon\"\r\n                    onClick={() => this.showQuotePDFWithOrg(q)}\r\n                    style={{ fontSize: '24px', color: '#2196F3', cursor: 'pointer' }}\r\n                  ></i>\r\n                </td>\r\n\r\n          \r\n                </tr>\r\n              ))}\r\n              {this.state.quotes.length === 0 && (\r\n                <tr><td colSpan=\"6\" className=\"text-center\">No quotes found.</td></tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  renderQuoteForm = () => {\r\n    const { formData, overlayType, productOverlayVisible ,showTaxOverlay,taxGroups,recalculateTotals} = this.state;\r\n    const isFOB = formData.impExp === 'FOB';\r\n\r\n    return (\r\n      <div>\r\n        <div className=\"card full-height\">\r\n          <div style={{ flex: 1, overflowY: 'auto', padding: '24px' }}>\r\n            <h4 className=\"mb-3\">Quote Form</h4>\r\n            <ul className=\"nav nav-tabs\" role=\"tablist\">\r\n              <li className=\"nav-item\">\r\n                <button type=\"button\" className={`nav-link ${this.state.activeTab === 'co' ? 'active' : ''}`} onClick={() => this.setState({ activeTab: 'co' })}>CO Details</button>\r\n              </li>\r\n              <li className=\"nav-item\">\r\n              <button type=\"button\" className={`nav-link ${this.state.activeTab === 'breakdown' ? 'active' : ''}`} onClick={() => this.setState({ activeTab: 'breakdown' })}>Breakdown</button>\r\n            </li>\r\n            <li className=\"nav-item\">\r\n                <button type=\"button\" className={`nav-link ${this.state.activeTab === 'commercial' ? 'active' : ''}`} onClick={() => this.setState({ activeTab: 'commercial' })}>Commercial Terms</button>\r\n              </li>\r\n            </ul>\r\n            <form className=\"form-sample\" onSubmit={this.handleSubmit}>\r\n              <div className=\"tab-content pt-3\">\r\n                {this.state.activeTab === 'co' && (\r\n                  <>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Quote No</label>\r\n                        <input type=\"text\" className=\"form-control form-control-sm\" value={formData.quoteNo} onChange={(e) => this.handleInputChange('quoteNo', e.target.value)} />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Quote Date</label>\r\n                        <input type=\"date\" className=\"form-control form-control-sm\" value={formData.quoteDate} onChange={(e) => this.handleInputChange('quoteDate', e.target.value)} />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Quote Type</label>\r\n                        <select className=\"form-control form-control-sm\" value={formData.quoteType} onChange={(e) => this.handleInputChange('quoteType', e.target.value)}>\r\n                          <option>Standard</option>\r\n                          <option>Manual</option>\r\n                        </select>\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Status</label>\r\n                        <input type=\"text\" className=\"form-control form-control-sm\" value={formData.status}   style={{ backgroundColor: '#fff' }} readOnly />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Customer</label>\r\n                        <div className=\"input-group input-group-sm\">\r\n                          <input\r\n                            type=\"text\"\r\n                            className=\"form-control\"\r\n                            placeholder=\"Choose Customer\"\r\n                            ref={this.customerInputRef}\r\n                            value={formData.customer}\r\n                            readOnly\r\n                            onClick={() => this.showOverlay('customer')}\r\n                            style={{ cursor: 'pointer' }}\r\n                          />\r\n                          <div className=\"input-group-append\">\r\n                            <button className=\"btn btn-outline-secondary btn-sm\" type=\"button\" onClick={() => this.showOverlay('customer')}>Select</button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>IMP/EXP</label>\r\n                        <select\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.impExp}\r\n                          onChange={(e) => this.handleInputChange('impExp', e.target.value)}\r\n                        >\r\n                          <option>None</option>\r\n                          <option>COB</option>\r\n                          <option>FOB</option>\r\n                          <option>CIF</option>\r\n                        </select>\r\n                      </div>\r\n                      <div className=\"form-group col-md-2\">\r\n                        <label>Ref No.</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.qrefNo}\r\n                          onChange={(e) => this.handleInputChange('qrefNo', e.target.value)}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Choose</label>\r\n                        <div className=\"d-flex align-items-center\">\r\n                          <div className=\"form-check mr-4\">\r\n                            <input type=\"radio\" className=\"form-check-input\" name=\"choose\" id=\"chooseService\" value=\"Service\" checked={formData.choose === 'Service'} onChange={(e) => this.handleInputChange('choose', e.target.value)} />\r\n                            <label className=\"form-check-label\" htmlFor=\"chooseService\">Service</label>\r\n                          </div>\r\n                          <div className=\"form-check\">\r\n                            <input type=\"radio\" className=\"form-check-input\" name=\"choose\" id=\"chooseProduct\" value=\"Product\" checked={formData.choose === 'Product'} onChange={(e) => this.handleInputChange('choose', e.target.value)} />\r\n                            <label className=\"form-check-label\" htmlFor=\"chooseProduct\">Product</label>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Currency</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.currency}\r\n                          style={{ backgroundColor: '#fff' }}\r\n                          readOnly\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Conversion Rate</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.conversionRate}\r\n                          onChange={(e) => this.handleInputChange('conversionRate', e.target.value)}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Tax Amount</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.taxAmount}\r\n                          onChange={(e) => this.handleInputChange('taxAmount', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Quote Value</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.quoteValue}\r\n                          onChange={(e) => this.handleInputChange('quoteValue', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                   \r\n                          <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n                            <h4 className=\"card-title\">Line Item</h4>\r\n                            <button type=\"button\" className=\"btn btn-primary btn-sm\" onClick={() => this.setState({ productOverlayVisible: true })}>\r\n                              + Add Product\r\n                            </button>\r\n                          </div>\r\n                       <div className=\"table-responsive\">\r\n        <table className=\"table table-bordered\">\r\n          <thead className=\"thead-light\">\r\n            <tr>\r\n              <th>Item Code</th>\r\n              <th>Item Desc</th>\r\n              <th>Cust Part No</th>\r\n              <th>HSN No</th>\r\n              <th>UOM</th>\r\n              <th>On Hand</th>\r\n              <th>Unit Price</th>\r\n              <th>Quantity</th>\r\n              <th>Tax Id</th>\r\n              <th>Item Total</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {formData.lineItems.map((item, idx) => {\r\n              const itemTotal = item.unitPrice * item.qty;\r\n              const taxDetails = getTaxDetailsFromGroup(item.taxGroupName, this.state.taxGroups);\r\n              const taxAmt = (itemTotal * taxDetails.totalPercent / 100) + (itemTotal * taxDetails.totalAmount);\r\n              const totalWithTax = itemTotal + taxAmt;\r\n             \r\n              \r\n              return (\r\n                <tr key={item.id || idx}>\r\n                  <td>{item.itemCode}</td>\r\n                  <td>{item.itemDescription}</td>\r\n                  <td>{item.custPartNo}</td>\r\n                  <td>{item.hsnNo}</td>\r\n                  <td>{item.uom}</td>\r\n                  <td>{item.onHand}</td>\r\n                  <td>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={item.unitPrice}\r\n                      onChange={e => this.handleLineItemChange(idx, 'unitPrice', e.target.value)}\r\n                      style={{ width: 80 }}\r\n                    />\r\n                  </td>\r\n                  <td>\r\n                    <input\r\n                      type=\"number\"\r\n                      min=\"1\"\r\n                      value={item.qty}\r\n                      onChange={e => this.handleLineItemChange(idx, 'qty', e.target.value)}\r\n                      style={{ width: 60 }}\r\n                    />\r\n                  </td>\r\n                  <td>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn btn-outline-secondary btn-sm btn-rounded btn-icon\"\r\n                    style={{ padding: '2px 6px', fontSize: '12px', lineHeight: '1' }}\r\n                    onClick={() => this.setState({ showTaxOverlay: true, currentTaxLineIdx: idx })}\r\n                  >\r\n                    +\r\n                  </button>\r\n                  <div style={{ fontSize: '13px', marginTop: '4px' }}>\r\n                    {(item.taxGroupNames || []).join(', ') || '-'}\r\n                  </div>\r\n                </td>\r\n              <td>{parseFloat(item.total || 0).toFixed(2)}</td>\r\n\r\n\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n                          {/* Add pagination for line items here if needed */}\r\n                          <div className=\"d-flex justify-content-between align-items-center mt-2\">\r\n                            <span>Page 1 of 1</span>\r\n                          </div>\r\n                      \r\n                  </>\r\n                )}\r\n                {this.state.activeTab === 'commercial' && (\r\n                  <>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-6\">\r\n                        <label>Bill To</label>\r\n                        <textarea\r\n                          className=\"form-control form-control-sm\"\r\n                          rows=\"3\"\r\n                          value={formData.billTo}\r\n                          onChange={(e) => this.handleInputChange('billTo', e.target.value)}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-6\">\r\n                        <label>Ship To</label>\r\n                        <textarea\r\n                          className=\"form-control form-control-sm\"\r\n                          rows=\"3\"\r\n                          value={formData.shipTo}\r\n                          onChange={(e) => this.handleInputChange('shipTo', e.target.value)}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                    <div className=\"form-group col-md-4\">\r\n  <label>Despatch Mode</label>\r\n  <div className=\"input-group input-group-sm\">\r\n    <input\r\n      type=\"text\"\r\n      className=\"form-control\"\r\n      value={formData.despatchMode}\r\n      readOnly\r\n      onClick={() => !isFOB && this.showOverlay('despatchMode')}\r\n      style={{ cursor: isFOB ? 'not-allowed' : 'pointer', backgroundColor: '#fff' }}\r\n    />\r\n    <div className=\"input-group-append\">\r\n      <button\r\n        className=\"btn btn-outline-secondary btn-sm\"\r\n        type=\"button\"\r\n        disabled={isFOB}\r\n        onClick={() => this.showOverlay('despatchMode')}\r\n      >\r\n        Select\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div className=\"form-group col-md-4\">\r\n  <label>Payment Terms</label>\r\n  <div className=\"input-group input-group-sm\">\r\n    <input\r\n      type=\"text\"\r\n      className=\"form-control\"\r\n      value={formData.paymentTerms}\r\n      readOnly\r\n      onClick={() => !isFOB && this.showOverlay('paymentTerms')}\r\n      style={{ cursor: isFOB ? 'not-allowed' : 'pointer', backgroundColor: '#fff' }}\r\n    />\r\n    <div className=\"input-group-append\">\r\n      <button\r\n        className=\"btn btn-outline-secondary btn-sm\"\r\n        type=\"button\"\r\n        disabled={isFOB}\r\n        onClick={() => this.showOverlay('paymentTerms')}\r\n      >\r\n        Select\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Freight Charges</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.freightCharges}\r\n                          onChange={(e) => this.handleInputChange('freightCharges', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Tax %</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.taxPercent}\r\n                          onChange={(e) => this.handleInputChange('taxPercent', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Freight Tax Amount</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.freighttaxAmount}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Packing Charges</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.packingCharges}\r\n                          onChange={(e) => this.handleInputChange('packingCharges', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    \r\n                  </>\r\n                )}\r\n                {this.state.activeTab === 'breakdown' && (this.renderBreakdownTab())}\r\n              </div>\r\n              {this.renderSubProductDialog()}\r\n              <div className=\"fixed-card-footer text-right p-3 border-top bg-white\">\r\n                <button type=\"submit\" className=\"btn btn-success mr-2\">Save All Details</button>\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"btn btn-secondary\"\r\n                  onClick={() => this.setState({ showForm: false, editingId: null })}\r\n                >\r\n                  Cancel\r\n                </button>\r\n              </div>\r\n            </form>\r\n            {overlayType && this.renderOverlay()}\r\n            {productOverlayVisible && this.renderProductOverlay()}\r\n            {this.state.showTaxOverlay && this.renderTaxOverlay()}\r\n\r\n          </div>\r\n          \r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\nrenderQuotePreview = () => {\r\n  const q = this.state.selectedQuote;\r\n  if (!q) return null;\r\n\r\n  return (\r\n    <div className=\"card mt-4 full-height p-4\">\r\n      <div className=\"d-flex justify-content-between mb-3\">\r\n        <h4 className=\"card-title\">Quote Preview - {q.quoteNo}</h4>\r\n        <div>\r\n          <button className=\"btn btn-sm btn-info mr-2\" onClick={() => this.loadQuoteForEdit(q)}>Edit</button>\r\n          <button className=\"btn btn-sm btn-success\" onClick={() => this.convertToOrder(q)}>Convert to Order</button>\r\n        </div>\r\n      </div>\r\n      <div className=\"row\">\r\n        <div className=\"col-md-4\"><b>Customer:</b> {q.customer}</div>\r\n        <div className=\"col-md-4\"><b>Date:</b> {q.quoteDate}</div>\r\n        <div className=\"col-md-4\"><b>Status:</b> {q.status}</div>\r\n      </div>\r\n      <div className=\"row mt-2\">\r\n        <div className=\"col-md-6\"><b>Bill To:</b><br />{q.billTo}</div>\r\n        <div className=\"col-md-6\"><b>Ship To:</b><br />{q.shipTo}</div>\r\n      </div>\r\n      <h5 className=\"mt-4\">Line Items</h5>\r\n      <table className=\"table table-bordered\">\r\n        <thead>\r\n          <tr>\r\n            <th>Item Code</th><th>Description</th><th>Qty</th><th>Unit Price</th><th>Total</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {q.lineItems?.map((item, i) => (\r\n            <tr key={i}>\r\n              <td>{item.itemCode}</td>\r\n              <td>{item.itemDescription}</td>\r\n              <td>{item.qty}</td>\r\n              <td>{item.unitPrice}</td>\r\n              <td>{item.total}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n      <div className=\"text-right\"><b>Total:</b> {q.quoteValue}</div>\r\n      <button className=\"btn btn-secondary mt-3\" onClick={() => this.setState({ previewMode: false })}>Back to List</button>\r\n    </div>\r\n  );\r\n};\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"container-fluid\">\r\n        {this.state.previewMode? this.renderQuotePreview(): this.state.showForm ? this.renderQuoteForm() : this.renderQuoteTable()}\r\n        \r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Quote);\r\n"]},"metadata":{},"sourceType":"module"}