{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\College\\\\psp\\\\StarAdmin-Free-React-Admin-Template-master\\\\template\\\\demo_1\\\\src\\\\app\\\\sales\\\\salestransactions\\\\quote\\\\QuoteApproval.js\";\nimport React, { Component } from \"react\";\nimport { db } from \"../../../../firebase\";\nimport { collection, getDocs, updateDoc, doc } from \"firebase/firestore\";\nimport html2canvas from \"html2canvas\";\nimport { jsPDF } from \"jspdf\";\nimport { toWords } from \"number-to-words\";\n\nclass QuoteApproval extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      quotes: [],\n      customers: [],\n      products: [],\n      taxGroups: [],\n      selectedQuote: null,\n      previewMode: false,\n      editingId: null,\n      showEditForm: false,\n      editFormData: null,\n      loading: false,\n      error: null,\n      showRejectDialog: false,\n      rejectReason: \"\"\n    };\n\n    this.fetchQuotes = async () => {\n      this.setState({\n        loading: true,\n        error: null\n      });\n\n      try {\n        const snap = await getDocs(collection(db, \"quotes\"));\n        const quotes = snap.docs.map(doc => ({\n          id: doc.id,\n          ...doc.data()\n        }));\n        quotes.sort((a, b) => {\n          var _a$createdAt, _a$createdAt$toDate, _b$createdAt, _b$createdAt$toDate;\n\n          const dateA = new Date(a.quoteDate || ((_a$createdAt = a.createdAt) === null || _a$createdAt === void 0 ? void 0 : (_a$createdAt$toDate = _a$createdAt.toDate) === null || _a$createdAt$toDate === void 0 ? void 0 : _a$createdAt$toDate.call(_a$createdAt)) || a.createdAt || 0);\n          const dateB = new Date(b.quoteDate || ((_b$createdAt = b.createdAt) === null || _b$createdAt === void 0 ? void 0 : (_b$createdAt$toDate = _b$createdAt.toDate) === null || _b$createdAt$toDate === void 0 ? void 0 : _b$createdAt$toDate.call(_b$createdAt)) || b.createdAt || 0);\n          return dateB - dateA;\n        });\n        this.setState({\n          quotes,\n          loading: false\n        });\n      } catch (err) {\n        this.setState({\n          error: err.message,\n          loading: false\n        });\n      }\n    };\n\n    this.fetchCustomers = async () => {\n      const snap = await getDocs(collection(db, \"customers\"));\n      const customers = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        customers\n      });\n    };\n\n    this.fetchProducts = async () => {\n      const snap = await getDocs(collection(db, \"products\"));\n      const products = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        products\n      });\n    };\n\n    this.fetchTaxGroups = async () => {\n      const snap = await getDocs(collection(db, \"taxGroups\"));\n      const taxGroups = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        taxGroups\n      });\n    };\n\n    this.openPreview = quote => {\n      this.setState({\n        selectedQuote: quote,\n        previewMode: true,\n        showEditForm: false\n      });\n    };\n\n    this.closePreview = () => {\n      this.setState({\n        selectedQuote: null,\n        previewMode: false,\n        showEditForm: false,\n        editingId: null\n      });\n    };\n\n    this.convertToOrder = quoteObj => {\n      sessionStorage.setItem('quoteToConvert', JSON.stringify(quoteObj));\n      this.props.history.push({\n        pathname: '/sales/salestransactions/order/Order',\n        state: {\n          openForm: true,\n          quoteId: quoteObj.id || null\n        }\n      });\n    };\n\n    this.openEditForm = quote => {\n      this.setState({\n        showEditForm: true,\n        editingId: quote.id,\n        editFormData: { ...quote\n        },\n        previewMode: false\n      });\n    };\n\n    this.closeEditForm = () => {\n      this.setState({\n        showEditForm: false,\n        editingId: null,\n        editFormData: null,\n        previewMode: true\n      });\n    };\n\n    this.handleEditInputChange = (field, value) => {\n      this.setState(prev => ({\n        editFormData: { ...prev.editFormData,\n          [field]: value\n        }\n      }), () => {\n        if (field === \"discountPercent\") this.recalculateEditTotals();\n\n        if (field === \"quoteType\") {\n          if (value === \"Standard\") {\n            this.setState(prev => ({\n              editFormData: { ...prev.editFormData,\n                quoteNo: `QT${1000 + this.state.quotes.length}`\n              }\n            }));\n          } else {\n            this.setState(prev => ({\n              editFormData: { ...prev.editFormData,\n                quoteNo: \"\"\n              }\n            }));\n          }\n        }\n      });\n    };\n\n    this.handleEditLineItemChange = (idx, field, value) => {\n      const items = [...this.state.editFormData.lineItems];\n      items[idx] = { ...items[idx],\n        [field]: value\n      }; // Recalculate itemTotal and taxAmt\n\n      let percent = 0;\n      let amount = 0;\n      (items[idx].taxGroupNames || []).forEach(groupName => {\n        const group = this.state.taxGroups.find(t => t.groupName === groupName);\n\n        if (group && Array.isArray(group.lineItems)) {\n          group.lineItems.forEach(comp => {\n            const val = parseFloat(comp.percentOrAmt || 0);\n            if (comp.type === 'Percentage') percent += val;\n            if (comp.type === 'Amount') amount += val;\n          });\n        }\n      });\n      const qty = parseFloat(items[idx].qty || 0);\n      const unitPrice = parseFloat(items[idx].unitPrice || 0);\n      const baseTotal = qty * unitPrice;\n      const taxAmt = baseTotal * percent / 100 + amount;\n      items[idx].taxAmt = taxAmt.toFixed(2);\n      items[idx].itemTotal = (baseTotal + taxAmt).toFixed(2);\n      items[idx].baseTotal = baseTotal.toFixed(2);\n      this.setState(prev => ({\n        editFormData: { ...prev.editFormData,\n          lineItems: items\n        }\n      }), this.recalculateEditTotals);\n    };\n\n    this.recalculateEditTotals = () => {\n      const {\n        lineItems,\n        discountPercent\n      } = this.state.editFormData;\n      let quoteValue = 0;\n      let taxAmount = 0;\n      (lineItems || []).forEach(item => {\n        quoteValue += parseFloat(item.itemTotal || 0);\n        taxAmount += parseFloat(item.taxAmt || 0);\n      });\n      const discountAmount = parseFloat(quoteValue) * parseFloat(discountPercent || 0) / 100;\n      const afterDiscountValue = quoteValue - discountAmount;\n      this.setState(prev => ({\n        editFormData: { ...prev.editFormData,\n          quoteValue: quoteValue.toFixed(2),\n          taxAmount: taxAmount.toFixed(2),\n          discountAmount: discountAmount.toFixed(2),\n          afterDiscountValue: afterDiscountValue.toFixed(2)\n        }\n      }));\n    };\n\n    this.handleEditSubmit = async e => {\n      e.preventDefault();\n      const {\n        editingId,\n        editFormData\n      } = this.state;\n      if (!editFormData.customer) return alert(\"Customer is required\");\n      if (!editFormData.lineItems || editFormData.lineItems.length === 0) return alert(\"At least one line item is required\");\n\n      try {\n        await updateDoc(doc(db, \"quotes\", editingId), editFormData);\n        alert(\"Quote updated!\");\n        this.setState({\n          showEditForm: false,\n          editingId: null,\n          editFormData: null,\n          previewMode: true\n        });\n        this.fetchQuotes();\n      } catch (err) {\n        alert(\"Error updating quote: \" + err.message);\n      }\n    };\n\n    this.updateStatus = async (id, status, rejectReason = \"\") => {\n      await updateDoc(doc(db, \"quotes\", id), {\n        status,\n        rejectReason\n      });\n      alert(`Quote ${status}`);\n      this.fetchQuotes();\n      this.setState({\n        selectedQuote: null,\n        previewMode: false,\n        showRejectDialog: false,\n        rejectReason: \"\"\n      });\n    };\n\n    this.openRejectDialog = () => {\n      this.setState({\n        showRejectDialog: true,\n        rejectReason: \"\"\n      });\n    };\n\n    this.closeRejectDialog = () => {\n      this.setState({\n        showRejectDialog: false,\n        rejectReason: \"\"\n      });\n    };\n\n    this.handleRejectReasonChange = e => {\n      this.setState({\n        rejectReason: e.target.value\n      });\n    };\n\n    this.handleRejectConfirm = () => {\n      const {\n        selectedQuote,\n        rejectReason\n      } = this.state;\n\n      if (!rejectReason.trim()) {\n        alert(\"Please enter a reason for rejection.\");\n        return;\n      }\n\n      this.updateStatus(selectedQuote.id, \"Rejected\", rejectReason);\n    };\n\n    this.renderRejectDialog = () => /*#__PURE__*/React.createElement(\"div\", {\n      className: \"custom-overlay\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"custom-overlay-content\",\n      style: {\n        width: 400\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }\n    }, \"Reject Reason\"), /*#__PURE__*/React.createElement(\"textarea\", {\n      className: \"form-control\",\n      rows: 3,\n      value: this.state.rejectReason,\n      onChange: this.handleRejectReasonChange,\n      placeholder: \"Enter reason for rejection\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"text-right mt-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-secondary mr-2\",\n      onClick: this.closeRejectDialog,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 11\n      }\n    }, \"Cancel\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-danger\",\n      onClick: this.handleRejectConfirm,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 11\n      }\n    }, \"Reject\"))));\n\n    this.renderQuoteTable = () => /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card mt-4 full-height\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex justify-content-between align-items-center mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      className: \"card-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 11\n      }\n    }, \"Quotes Approval\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"table-responsive\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"table\", {\n      className: \"table table-bordered table-hover\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      className: \"thead-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      style: {\n        fontSize: '14px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 17\n      }\n    }, \"Quote ID\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 17\n      }\n    }, \"Customer\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 17\n      }\n    }, \"Date\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 17\n      }\n    }, \"Quote Value\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 17\n      }\n    }, \"After Discount\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 17\n      }\n    }, \"Status\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 17\n      }\n    }, \"Reject Reason\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 17\n      }\n    }, \"Print\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 13\n      }\n    }, this.state.quotes.map((q, i) => {\n      let statusClass = \"badge-secondary\";\n      if (q.status === \"Awaiting for Approval\") statusClass = \"badge-warning\";else if (q.status === \"Approved\") statusClass = \"badge-success\";else if (q.status === \"Rejected\") statusClass = \"badge-danger\";else if (q.status === \"CO Created\") statusClass = \"badge-info\";\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: i,\n        style: {\n          fontSize: '14px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-link p-0\",\n        onClick: () => this.openPreview(q),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 23\n        }\n      }, q.quoteNo)), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 21\n        }\n      }, q.customer), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 21\n        }\n      }, q.quoteDate), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 21\n        }\n      }, q.quoteValue), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 21\n        }\n      }, q.afterDiscountValue), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: `badge ${statusClass}`,\n        style: {\n          fontSize: '14px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 23\n        }\n      }, q.status)), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 21\n        }\n      }, q.rejectReason || \"-\"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"mdi mdi-printer menu-icon\",\n        onClick: () => this.showQuotePDFWithOrg(q),\n        style: {\n          fontSize: '24px',\n          color: '#2196F3',\n          cursor: 'pointer'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 23\n        }\n      })));\n    }), this.state.quotes.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      colSpan: \"8\",\n      className: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 21\n      }\n    }, \"No quotes found.\")))))));\n\n    this.renderEditForm = () => {\n      var _editFormData$lineIte;\n\n      const {\n        editFormData\n      } = this.state;\n      if (!editFormData) return null;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card mt-4 p-4 shadow-sm full-height d-flex flex-column\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 7\n        }\n      }, \"Edit Quote - \", editFormData.quoteNo), /*#__PURE__*/React.createElement(\"form\", {\n        onSubmit: this.handleEditSubmit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 13\n        }\n      }, \"Quote Type\"), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"form-control\",\n        value: editFormData.quoteType,\n        onChange: e => this.handleEditInputChange(\"quoteType\", e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        value: \"Standard\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 15\n        }\n      }, \"Standard\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"Manual\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 15\n        }\n      }, \"Manual\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 13\n        }\n      }, \"Quote No\"), editFormData.quoteType === \"Standard\" ? /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        value: editFormData.quoteNo,\n        readOnly: true,\n        placeholder: \"Auto\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 15\n        }\n      }) : /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        value: editFormData.quoteNo,\n        onChange: e => this.handleEditInputChange(\"quoteNo\", e.target.value),\n        placeholder: \"Enter Quote No\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 13\n        }\n      }, \"Customer\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        value: editFormData.customer,\n        onChange: e => this.handleEditInputChange(\"customer\", e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 13\n        }\n      }, \"Date\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"date\",\n        className: \"form-control\",\n        value: editFormData.quoteDate,\n        onChange: e => this.handleEditInputChange(\"quoteDate\", e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 13\n        }\n      }))), \" \", /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 16\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 13\n        }\n      }, \"Status\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        value: editFormData.status,\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 13\n        }\n      }, \"Discount %\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: editFormData.discountPercent,\n        onChange: e => this.handleEditInputChange(\"discountPercent\", e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 13\n        }\n      }, \"Quote Value\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: editFormData.quoteValue,\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 371,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 2\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 379,\n          columnNumber: 13\n        }\n      }, \"Tax Amount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: editFormData.taxAmount,\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 13\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 13\n        }\n      }, \"Discount Amount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: editFormData.discountAmount,\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 13\n        }\n      }, \"After Discount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: editFormData.discountPercent > 0 ? editFormData.afterDiscountValue : \"\",\n        readOnly: true,\n        placeholder: editFormData.discountPercent > 0 ? \"\" : \"Enter Discount %\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 13\n        }\n      }))), /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"mt-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 9\n        }\n      }, \"Line Items\"), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered table-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        className: \"thead-light\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 412,\n          columnNumber: 15\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 15\n        }\n      }, \"Description\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 414,\n          columnNumber: 15\n        }\n      }, \"Qty\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 15\n        }\n      }, \"Unit Price\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 15\n        }\n      }, \"Tax Amount\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 417,\n          columnNumber: 15\n        }\n      }, \"Item Total\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 11\n        }\n      }, \" \", (_editFormData$lineIte = editFormData.lineItems) === null || _editFormData$lineIte === void 0 ? void 0 : _editFormData$lineIte.map((item, idx) => /*#__PURE__*/React.createElement(\"tr\", {\n        key: idx,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 17\n        }\n      }, item.itemCode), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 17\n        }\n      }, item.itemDescription), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        value: item.qty,\n        onChange: e => this.handleEditLineItemChange(idx, \"qty\", e.target.value),\n        style: {\n          width: 80\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 19\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 432,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        value: item.unitPrice,\n        onChange: e => this.handleEditLineItemChange(idx, \"unitPrice\", e.target.value),\n        style: {\n          width: 80\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 433,\n          columnNumber: 19\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 17\n        }\n      }, item.taxAmt), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 17\n        }\n      }, item.itemTotal))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mt-3 text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 1\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-success mr-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 11\n        }\n      }, \"Save\"), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-secondary\",\n        onClick: this.closeEditForm,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 11\n        }\n      }, \"Cancel\"))));\n    };\n\n    this.renderQuotePreview = () => {\n      var _q$lineItems, _q$lineItems2;\n\n      const q = this.state.selectedQuote;\n      if (!q) return null;\n      const subtotal = ((_q$lineItems = q.lineItems) === null || _q$lineItems === void 0 ? void 0 : _q$lineItems.reduce((sum, item) => sum + (parseFloat(item.itemTotal) || 0), 0)) || 0;\n      const freightCharges = parseFloat(q.freightCharges || 0);\n      const taxAmount = parseFloat(q.taxAmount || 0);\n      const grandTotal = parseFloat(q.quoteValue || subtotal + freightCharges + taxAmount);\n      const amountWords = `INR ${toWords(Math.floor(grandTotal))} Only`; // Find customer record for extra details\n\n      const customer = this.state.customers.find(c => c.custshortName === q.customer || c.custname === q.customer) || {};\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card mt-4 p-4 shadow-sm full-height d-flex flex-column\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 476,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 478,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"card-title mb-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 11\n        }\n      }, \"Quote Preview - \", q.quoteNo), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"flex items-center gap-x-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-sm btn-primary mr-2\",\n        onClick: () => this.openEditForm(q),\n        disabled: q.status === \"CO Created\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 13\n        }\n      }, \"Edit\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-sm btn-outline-secondary\",\n        onClick: () => this.convertToOrder(q),\n        disabled: q.status !== \"Approved\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 488,\n          columnNumber: 13\n        }\n      }, \"Convert to Order\"), /*#__PURE__*/React.createElement(\"i\", {\n        className: \"mdi mdi-printer menu-icon ml-3\",\n        style: {\n          marginBlockStart: '10px',\n          gap: '10px',\n          fontSize: '27px',\n          color: '#2196F3',\n          cursor: 'pointer'\n        },\n        onClick: () => this.showQuotePDFWithOrg(q),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 495,\n          columnNumber: 13\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 505,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 505,\n          columnNumber: 37\n        }\n      }, \"Customer:\"), \" \", q.customer), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 37\n        }\n      }, \"Date:\"), \" \", q.quoteDate), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 507,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 507,\n          columnNumber: 37\n        }\n      }, \"Status:\"), \" \", q.status)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row mb-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 510,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 511,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 512,\n          columnNumber: 13\n        }\n      }, \"Bill To:\"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 512,\n          columnNumber: 28\n        }\n      }), q.billTo || \"-\", /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mt-2\",\n        style: {\n          fontSize: \"0.9em\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 514,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 515,\n          columnNumber: 15\n        }\n      }, \"GSTIN:\"), \" \", customer.gstin || \"-\", /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 515,\n          columnNumber: 52\n        }\n      }), /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 516,\n          columnNumber: 15\n        }\n      }, \"Email:\"), \" \", customer.email || \"-\", /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 516,\n          columnNumber: 52\n        }\n      }), /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 517,\n          columnNumber: 15\n        }\n      }, \"Phone:\"), \" \", customer.phone || \"-\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 520,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 521,\n          columnNumber: 13\n        }\n      }, \"Ship To:\"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 521,\n          columnNumber: 28\n        }\n      }), q.shipTo || \"-\")), /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 527,\n          columnNumber: 9\n        }\n      }, \"Line Items\"), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered table-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 528,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        className: \"thead-light\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 529,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 530,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 15\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 15\n        }\n      }, \"Description\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 533,\n          columnNumber: 15\n        }\n      }, \"Qty\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 534,\n          columnNumber: 15\n        }\n      }, \"Unit Price\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 15\n        }\n      }, \"Tax Amount\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 536,\n          columnNumber: 15\n        }\n      }, \"Item Total\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 539,\n          columnNumber: 11\n        }\n      }, (_q$lineItems2 = q.lineItems) === null || _q$lineItems2 === void 0 ? void 0 : _q$lineItems2.map((item, i) => /*#__PURE__*/React.createElement(\"tr\", {\n        key: i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 541,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 542,\n          columnNumber: 17\n        }\n      }, item.itemCode), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 543,\n          columnNumber: 17\n        }\n      }, item.itemDescription), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 544,\n          columnNumber: 17\n        }\n      }, item.qty), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 545,\n          columnNumber: 17\n        }\n      }, item.unitPrice), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 17\n        }\n      }, item.taxAmt), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 547,\n          columnNumber: 17\n        }\n      }, item.itemTotal))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mt-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 554,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 14\n        }\n      }, \"Subtotal:\"), \" \", subtotal.toFixed(2)), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 556,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 556,\n          columnNumber: 14\n        }\n      }, \"Freight Charges:\"), \" \", freightCharges.toFixed(2)), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 557,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 557,\n          columnNumber: 14\n        }\n      }, \"Tax Amount:\"), \" \", taxAmount.toFixed(2)), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"h6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 558,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 558,\n          columnNumber: 29\n        }\n      }, \"Grand Total:\"), \" \", grandTotal.toFixed(2)), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"h6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 559,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 559,\n          columnNumber: 29\n        }\n      }, \"Amount in Words:\"), \" \", amountWords)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 561,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 562,\n          columnNumber: 11\n        }\n      }, \"Reject Reason:\"), \" \", q.rejectReason || \"-\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mt-auto pt-3 text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 564,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-success\",\n        onClick: () => this.updateStatus(q.id, \"Approved\"),\n        disabled: q.status !== \"Awaiting for Approval\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 565,\n          columnNumber: 11\n        }\n      }, \"Approve\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-danger\",\n        onClick: this.openRejectDialog,\n        disabled: q.status !== \"Awaiting for Approval\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 572,\n          columnNumber: 11\n        }\n      }, \"Reject\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-secondary\",\n        onClick: this.closePreview,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 11\n        }\n      }, \"Back to List\")), this.state.showRejectDialog && this.renderRejectDialog());\n    };\n\n    this.renderEditForm = () => {\n      var _editFormData$lineIte2;\n\n      const {\n        editFormData\n      } = this.state;\n      if (!editFormData) return null;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card mt-4 p-4 shadow-sm full-height d-flex flex-column\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 595,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 596,\n          columnNumber: 9\n        }\n      }, \"Edit Quote - \", editFormData.quoteNo), /*#__PURE__*/React.createElement(\"form\", {\n        onSubmit: this.handleEditSubmit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 597,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 598,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 599,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 600,\n          columnNumber: 15\n        }\n      }, \"Customer\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        value: editFormData.customer,\n        onChange: e => this.handleEditInputChange(\"customer\", e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 601,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 608,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 609,\n          columnNumber: 15\n        }\n      }, \"Date\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"date\",\n        className: \"form-control\",\n        value: editFormData.quoteDate,\n        onChange: e => this.handleEditInputChange(\"quoteDate\", e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 610,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 617,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 618,\n          columnNumber: 15\n        }\n      }, \"Status\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        value: editFormData.status,\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 619,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 626,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 627,\n          columnNumber: 15\n        }\n      }, \"Discount %\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: editFormData.discountPercent,\n        onChange: e => this.handleEditInputChange(\"discountPercent\", e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 628,\n          columnNumber: 15\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 636,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 637,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 638,\n          columnNumber: 15\n        }\n      }, \"Quote Value\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: editFormData.quoteValue,\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 639,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 646,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 647,\n          columnNumber: 15\n        }\n      }, \"Tax Amount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: editFormData.taxAmount,\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 648,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 655,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 656,\n          columnNumber: 15\n        }\n      }, \"Discount Amount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: editFormData.discountAmount,\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 657,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 664,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 665,\n          columnNumber: 15\n        }\n      }, \"After Discount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: editFormData.afterDiscountValue,\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 666,\n          columnNumber: 15\n        }\n      }))), /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"mt-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 674,\n          columnNumber: 11\n        }\n      }, \"Line Items\"), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered table-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 675,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        className: \"thead-light\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 676,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 677,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 678,\n          columnNumber: 17\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 679,\n          columnNumber: 17\n        }\n      }, \"Description\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 680,\n          columnNumber: 17\n        }\n      }, \"Qty\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 681,\n          columnNumber: 17\n        }\n      }, \"Unit Price\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 682,\n          columnNumber: 17\n        }\n      }, \"Tax Amount\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 683,\n          columnNumber: 17\n        }\n      }, \"Item Total\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 686,\n          columnNumber: 13\n        }\n      }, (_editFormData$lineIte2 = editFormData.lineItems) === null || _editFormData$lineIte2 === void 0 ? void 0 : _editFormData$lineIte2.map((item, idx) => /*#__PURE__*/React.createElement(\"tr\", {\n        key: idx,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 688,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 689,\n          columnNumber: 19\n        }\n      }, item.itemCode), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 690,\n          columnNumber: 19\n        }\n      }, item.itemDescription), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 691,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        value: item.qty,\n        onChange: e => this.handleEditLineItemChange(idx, \"qty\", e.target.value),\n        style: {\n          width: 80\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 692,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 699,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        value: item.unitPrice,\n        onChange: e => this.handleEditLineItemChange(idx, \"unitPrice\", e.target.value),\n        style: {\n          width: 80\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 700,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 707,\n          columnNumber: 19\n        }\n      }, item.baseTotal), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 708,\n          columnNumber: 19\n        }\n      }, item.taxAmt), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 709,\n          columnNumber: 19\n        }\n      }, item.itemTotal))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mt-3 text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 714,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-success mr-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 715,\n          columnNumber: 13\n        }\n      }, \"Save\"), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-secondary\",\n        onClick: this.closePreview,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 716,\n          columnNumber: 13\n        }\n      }, \"Cancel\"))));\n    };\n\n    this.showQuotePDFWithOrg = async quote => {\n      var _orgSnap$docs$, _quote$billTo, _quote$shipTo;\n\n      if (!quote || !Array.isArray(quote.lineItems) || quote.lineItems.length === 0) {\n        alert(\"Quote data is incomplete.\");\n        return;\n      } // 1. Fetch org and customer data\n\n\n      const orgSnap = await getDocs(collection(db, 'businessGroups'));\n      const org = ((_orgSnap$docs$ = orgSnap.docs[0]) === null || _orgSnap$docs$ === void 0 ? void 0 : _orgSnap$docs$.data()) || {};\n      const customer = this.state.customers.find(c => c.custshortName === quote.customer || c.custname === quote.customer) || {}; // GST State Map for Place of Supply\n\n      const gstStateMap = {\n        \"01\": \"Jammu & Kashmir\",\n        \"02\": \"Himachal Pradesh\",\n        \"03\": \"Punjab\",\n        \"04\": \"Chandigarh\",\n        \"05\": \"Uttarakhand\",\n        \"06\": \"Haryana\",\n        \"07\": \"Delhi\",\n        \"08\": \"Rajasthan\",\n        \"09\": \"Uttar Pradesh\",\n        \"10\": \"Bihar\",\n        \"11\": \"Sikkim\",\n        \"12\": \"Arunachal Pradesh\",\n        \"13\": \"Nagaland\",\n        \"14\": \"Manipur\",\n        \"15\": \"Mizoram\",\n        \"16\": \"Tripura\",\n        \"17\": \"Meghalaya\",\n        \"18\": \"Assam\",\n        \"19\": \"West Bengal\",\n        \"20\": \"Jharkhand\",\n        \"21\": \"Odisha\",\n        \"22\": \"Chhattisgarh\",\n        \"23\": \"Madhya Pradesh\",\n        \"24\": \"Gujarat\",\n        \"25\": \"Daman and Diu\",\n        \"26\": \"Dadra and Nagar Haveli\",\n        \"27\": \"Maharashtra\",\n        \"28\": \"Andhra Pradesh (Old)\",\n        \"29\": \"Karnataka\",\n        \"30\": \"Goa\",\n        \"31\": \"Lakshadweep\",\n        \"32\": \"Kerala\",\n        \"33\": \"Tamil Nadu\",\n        \"34\": \"Puducherry\",\n        \"35\": \"Andaman and Nicobar Islands\",\n        \"36\": \"Telangana\",\n        \"37\": \"Andhra Pradesh\",\n        \"97\": \"Other Territory\"\n      }; // Helper for Place of Supply\n\n      const getPlaceOfSupply = gstin => {\n        if (!gstin || gstin.length < 2) return '';\n        const code = gstin.substring(0, 2);\n        const state = gstStateMap[code];\n        return state ? `${code} - ${state}` : '';\n      }; // 2. Enrich line items\n\n\n      const enrichedItems = quote.lineItems.map(item => {\n        const product = this.state.products.find(p => p.productId === item.itemCode) || {};\n        return { ...item,\n          ptshortName: product.ptshortName || '',\n          hsnCode: product.hsnCode || '',\n          uom: product.stockingUOM || '',\n          cgst: item.cgst || 0,\n          sgst: item.sgst || 0,\n          igst: item.igst || 0,\n          taxGroupNames: item.taxGroupNames || (item.taxGroupName ? item.taxGroupName.split(',').map(s => s.trim()) : [])\n        };\n      }); // 3. Subtotal (without tax)\n\n      const subtotal = enrichedItems.reduce((sum, item) => sum + (parseFloat(item.unitPrice) || 0) * (parseFloat(item.qty) || 0), 0);\n      const freightCharges = parseFloat(quote.freightCharges || 0);\n      const freightTax = parseFloat(quote.freighttaxAmount || 0);\n      const totalTaxAmount = parseFloat(quote.taxAmount || 0);\n      const grandTotal = parseFloat(quote.quoteValue || subtotal + totalTaxAmount);\n      const amountWords = `INR ${toWords(Math.floor(grandTotal))} Only`; // 4. Tax breakdown by group\n\n      let taxBreakdown = {};\n      let taxGroupDetails = [];\n      let sno = 1;\n      enrichedItems.forEach(item => {\n        const qty = parseFloat(item.qty || 0);\n        const unitPrice = parseFloat(item.unitPrice || 0);\n        const base = qty * unitPrice;\n        (item.taxGroupNames || []).forEach(tgName => {\n          // Find group in taxGroups\n          const group = (this.state.taxGroups || []).find(g => g.groupName === tgName);\n\n          if (group) {\n            group.lineItems.forEach(li => {\n              const key = `${tgName} - ${li.component} (${li.percentOrAmt}${li.type === 'Amount' ? '' : '%'})`;\n              let taxAmt = 0;\n              if (li.type === 'Amount') taxAmt = parseFloat(li.percentOrAmt || 0);else taxAmt = base * parseFloat(li.percentOrAmt || 0) / 100;\n              taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\n              taxGroupDetails.push({\n                sno: sno++,\n                group: tgName,\n                peramt: `${li.percentOrAmt}${li.type === 'Amount' ? '' : '%'}`,\n                taxAmt: taxAmt.toFixed(2)\n              });\n            });\n          }\n        }); // Legacy support for cgst/sgst/igst\n\n        if (item.cgst) {\n          const key = `CGST ${item.cgst}%`;\n          const taxAmt = base * item.cgst / 100;\n          taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\n          taxGroupDetails.push({\n            sno: sno++,\n            group: key,\n            peramt: `${item.cgst}%`,\n            taxAmt: taxAmt.toFixed(2)\n          });\n        }\n\n        if (item.sgst) {\n          const key = `SGST ${item.sgst}%`;\n          const taxAmt = base * item.sgst / 100;\n          taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\n          taxGroupDetails.push({\n            sno: sno++,\n            group: key,\n            peramt: `${item.sgst}%`,\n            taxAmt: taxAmt.toFixed(2)\n          });\n        }\n\n        if (item.igst) {\n          const key = `IGST ${item.igst}%`;\n          const taxAmt = base * item.igst / 100;\n          taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\n          taxGroupDetails.push({\n            sno: sno++,\n            group: key,\n            peramt: `${item.igst}%`,\n            taxAmt: taxAmt.toFixed(2)\n          });\n        }\n      });\n\n      if (freightTax > 0) {\n        taxBreakdown[\"Freight Tax\"] = freightTax;\n        taxGroupDetails.push({\n          sno: sno++,\n          group: \"Freight Tax\",\n          peramt: \"-\",\n          taxAmt: freightTax.toFixed(2)\n        });\n      } // 5. Milestone breakdown (with subproducts)\n\n\n      const {\n        breakdownItems,\n        breakdownType\n      } = this.state; // 6. Build HTML for PDF\n\n      const container = document.createElement('div');\n      container.id = 'pdf-preview-container';\n      container.style.width = '794px';\n      container.style.padding = '40px';\n      container.style.fontFamily = 'Arial'; // 7. Main PDF content\n\n      container.innerHTML = `\n    <div style=\"display:flex; justify-content:space-between; align-items:center;\">\n      <img src=\"${org.logoUrl || ''}\" style=\"height:50px;\" />\n      <div style=\"font-size:18px; font-weight:bold;\">QUOTATION</div>\n    </div>\n    <hr/>\n    <div style=\"display:flex; justify-content:space-between; font-size:11px;\">\n      <div style=\"line-height:1.5; width:50%;\">\n        <b>${org.bgName || ''}</b><br/>\n        ${org.address || ''}<br/>\n        <b>Email:</b> ${org.email || ''}<br/>\n        <b>Website:</b> ${org.website || ''}<br/>\n        <b>GSTIN:</b> ${org.gstin || ''}<br/>\n        <b>Mobile:</b> ${org.mobile || ''}<br/>\n        <b>CIN:</b> ${org.cin || ''}\n      </div>\n      <table style=\"font-size:11px; text-align:left;\">\n        <tr><td><b>Quote No</b></td><td>: ${quote.quoteNo}</td></tr>\n        <tr><td><b>Quote Date</b></td><td>: ${quote.quoteDate}</td></tr>\n        <tr><td><b>Currency</b></td><td>: ${quote.currency || 'INR'}</td></tr>\n        <tr><td><b>Despatch</b></td><td>: ${quote.despatchMode || ''}</td></tr>\n      </table>\n    </div>\n\n    <div style=\"margin-top:15px; display:flex; justify-content:space-between; font-size:11px;\">\n      <div style=\"width:48%;\">\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Bill To</b>\n        <div style=\"border:1px solid #ccc; padding:6px;\">\n         <b>${quote.customer || ''}</b><br/>\n          ${((_quote$billTo = quote.billTo) === null || _quote$billTo === void 0 ? void 0 : _quote$billTo.replace(/\\n/g, '<br/>')) || ''}\n        </div>\n        <div style=\"font-size:10px; margin-top:6px;\">\n            <b>GSTIN:</b> ${customer.gstin || ''}<br/>\n            <b>Email:</b> ${customer.email || ''}<br/>\n            <b>Contact:</b> ${customer.contactPerson || ''}<br/>\n            <b>Phone:</b> ${customer.phone || ''}\n        </div>\n      </div>\n      <div style=\"width:48%;\">\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Ship To</b>\n        <div style=\"border:1px solid #ccc; padding:6px;\">\n         <b>${quote.customer || ''}</b><br/>\n          ${((_quote$shipTo = quote.shipTo) === null || _quote$shipTo === void 0 ? void 0 : _quote$shipTo.replace(/\\n/g, '<br/>')) || ''}\n        </div>\n        <div style=\"font-size:10px; margin-top:6px;\">\n          <b>Place of Supply:</b> ${getPlaceOfSupply(customer.gstin || '')}\n        </div>\n      </div>\n    </div>\n\n    <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\n      <thead>\n        <tr style=\"background:#f4f6fa;\">\n          <th style=\"border:1px solid #011b56;\">Item Code</th>\n          <th style=\"border:1px solid #011b56;\">Description</th>\n          <th style=\"border:1px solid #011b56;\">HSN</th>\n          <th style=\"border:1px solid #011b56;\">UOM</th>\n          <th style=\"border:1px solid #011b56;\">Qty</th>\n          <th style=\"border:1px solid #011b56;\">Unit Price</th>\n          <th style=\"border:1px solid #011b56;\">GST%</th>\n          <th style=\"border:1px solid #011b56;\">Item Total</th>\n        </tr>\n      </thead>\n      <tbody>\n        ${enrichedItems.map(item => {\n        const gstLabel = item.taxGroupNames && item.taxGroupNames.length ? item.taxGroupNames.join(', ') : item.taxGroupName || item.taxId || '-';\n        return `\n            <tr>\n              <td style=\"border:1px solid #011b56;\">${item.itemCode}</td>\n              <td style=\"border:1px solid #011b56;\">${item.itemDescription}</td>\n              <td style=\"border:1px solid #011b56;\">${item.hsnCode}</td>\n              <td style=\"border:1px solid #011b56;\">${item.uom}</td>\n              <td style=\"border:1px solid #011b56;\">${item.qty}</td>\n              <td style=\"border:1px solid #011b56;\">${item.unitPrice}</td>\n              <td style=\"border:1px solid #011b56;\">${gstLabel}</td>\n              <td style=\"border:1px solid #011b56;\">${item.total}</td>\n            </tr>`;\n      }).join('')}\n        <tr>\n          <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Subtotal</b></td>\n          <td style=\"border:1px solid #011b56;\"><b>${subtotal.toFixed(2)}</b></td>\n      </tr>\n        \n          <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td>\n          <td style=\"border:1px solid #011b56;\"><b>${totalTaxAmount.toFixed(2)}</b></td>\n        </tr>\n        <tr>\n  <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Discount Amount</b></td>\n  <td style=\"border:1px solid #011b56;\"><b>${Number(quote.discountAmount || 0).toFixed(2)}</b></td>\n</tr>\n\n        <tr>\n  <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Grand Total</b></td>\n  <td style=\"border:1px solid #011b56;\"><b>${Number(quote.afterDiscountValue || grandTotal).toFixed(2)}</b></td>\n</tr>\n\n      </tbody>\n    </table>\n    <div style=\"margin-top:8px; font-size:11px;\"><b>Amount in Words:</b> ${amountWords}</div>\n    <div style=\"margin-top:20px; text-align:right; font-size:10px;\">Printed on ${new Date().toLocaleString()}</div>\n  `;\n      document.body.appendChild(container);\n      const canvas = await html2canvas(container, {\n        scale: 2,\n        useCORS: true\n      });\n      const imgData = canvas.toDataURL('image/png');\n      const pdf = new jsPDF('p', 'pt', 'a4');\n      const width = 595.28;\n      const height = canvas.height * width / canvas.width;\n      pdf.addImage(imgData, 'PNG', 0, 0, width, height);\n      document.body.removeChild(container); // ...existing code...\n      // 8. Milestone breakdown and tax breakdown on the same page, same style as quote table\n\n      if (breakdownItems && breakdownItems.length > 0) {\n        pdf.addPage();\n        let milestoneRows = breakdownItems.filter(bi => bi.selected !== false).map((item, idx) => {\n          const mainItem = enrichedItems.find(li => li.itemCode === item.productId);\n          const mainItemTotal = mainItem ? parseFloat(mainItem.total) || 0 : 0;\n          return `\n    <tr>\n      <td style=\"border:1px solid #011b56;\">${item.sno || ''}</td>\n      <td style=\"border:1px solid #011b56;\">${item.productId || ''}</td>\n      <td style=\"border:1px solid #011b56;\">${item.desc || ''}</td>\n      <td style=\"border:1px solid #011b56;\">${item.value ? item.value + (breakdownType === 'Percentage' ? '%' : '₹') : ''}</td>\n      <td style=\"border:1px solid #011b56;\">${item.dueDate || ''}</td>\n      <td style=\"border:1px solid #011b56;\">${mainItemTotal.toFixed(2)}</td>\n    </tr>\n    ${(item.subProducts || []).map((sp, spIdx) => {\n            const rawVal = parseFloat(sp.value || 0) || 0;\n            let spTotal = 0;\n\n            if (breakdownType === 'Percentage') {\n              spTotal = mainItemTotal * rawVal / 100;\n            } else {\n              spTotal = rawVal;\n            }\n\n            return `\n        <tr style=\"background: #f9f9f9;\">\n          <td style=\"border:1px solid #011b56;\"></td>\n          <td style=\"border:1px solid #011b56;\">${item.productId}_${spIdx + 1}</td>\n          <td style=\"border:1px solid #011b56;\">→ ${sp.name || ''}</td>\n          <td style=\"border:1px solid #011b56;\">${sp.value ? breakdownType === 'Percentage' ? sp.value + '%' : '₹' + sp.value : ''}</td>\n          <td style=\"border:1px solid #011b56;\">${sp.dueDate || ''}</td>\n          <td style=\"border:1px solid #011b56;\">${spTotal.toFixed(2)}</td>\n        </tr>\n      `;\n          }).join('')}\n  `;\n        }).join('');\n        let taxRows = taxGroupDetails.map(row => {\n          return `\n    <tr>\n      <td style=\"border:1px solid #011b56;\">${row.sno}</td>\n      <td style=\"border:1px solid #011b56;\">${row.group}</td>\n      <td style=\"border:1px solid #011b56;\">${row.peramt}</td>\n      <td style=\"border:1px solid #011b56;\">${row.taxAmt}</td>\n    </tr>\n  `;\n        }).join('');\n        let combinedHtml = `\n    <div style=\"font-family:Arial; padding:40px; width:100%;\">\n      <h3 style=\"margin-bottom:10px; font-size:16px;\">Milestone Breakdown</h3>\n      <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\n        <thead>\n          <tr style=\"background:#f4f6fa;\">\n            <th style=\"border:1px solid #011b56;\">S.No</th>\n            <th style=\"border:1px solid #011b56;\">Item ID</th>\n            <th style=\"border:1px solid #011b56;\">Desc</th>\n            <th style=\"border:1px solid #011b56;\">${breakdownType}</th>\n            <th style=\"border:1px solid #011b56;\">Due Date</th>\n            <th style=\"border:1px solid #011b56;\">Item Total</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${milestoneRows}\n        </tbody>\n      </table>\n      <h3 style=\"margin-bottom:10px; margin-top:30px; font-size:16px;\">Tax Breakdown</h3>\n      <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\n        <thead>\n          <tr style=\"background:#f4f6fa;\">\n            <th style=\"border:1px solid #011b56;\">S.No</th>\n            <th style=\"border:1px solid #011b56;\">Tax Group</th>\n            <th style=\"border:1px solid #011b56;\">Per/Amt</th>\n            <th style=\"border:1px solid #011b56;\">Tax Amt</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${taxRows}\n          <tr>\n            <td colspan=\"3\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td>\n            <td style=\"border:1px solid #011b56;\"><b>${totalTaxAmount.toFixed(2)}</b></td>\n          </tr>\n          <tr>\n  <td style=\"border:1px solid #011b56;\"></td>\n  <td style=\"border:1px solid #011b56;\">Discount</td>\n  <td style=\"border:1px solid #011b56;\">${quote.discountPercent || 0}%</td>\n  <td style=\"border:1px solid #011b56;\">${(quote.discountAmount || 0).toFixed(2)}</td>\n</tr>\n\n        </tbody>\n      </table>\n    </div>\n  `;\n        const combinedContainer = document.createElement('div');\n        combinedContainer.id = 'pdf-preview-container';\n        combinedContainer.style.width = '794px';\n        combinedContainer.style.padding = '40px';\n        combinedContainer.style.fontFamily = 'Arial';\n        combinedContainer.style.fontSize = '10px'; // Ensure same font size as first page\n\n        combinedContainer.innerHTML = combinedHtml;\n        document.body.appendChild(combinedContainer);\n        const combinedCanvas = await html2canvas(combinedContainer, {\n          scale: 2,\n          useCORS: true\n        });\n        const combinedImg = combinedCanvas.toDataURL('image/png');\n        pdf.addImage(combinedImg, 'PNG', 0, 0, width, combinedCanvas.height * width / combinedCanvas.width);\n        document.body.removeChild(combinedContainer);\n      }\n\n      pdf.setFontSize(11);\n      pdf.text(`For ${org.bgName || ''}`, width - 200, 780);\n      pdf.text('Authorized Signatory', width - 200, 800); // 11. Show PDF\n\n      const blob = pdf.output('blob');\n      const url = URL.createObjectURL(blob);\n      const newWin = window.open();\n      newWin.document.write(`\n    <html><head><title>Quote PDF Preview</title></head>\n    <body style=\"margin:0;\">\n      <iframe width=\"100%\" height=\"100%\" style=\"border:none;\" src=\"${url}\"></iframe>\n      <button onclick=\"document.querySelector('iframe').contentWindow.print()\" style=\"position:fixed;top:10px;right:110px;\"></button>\n      <a href=\"${url}\" download=\"Quote_${quote.quoteNo || 'PDF'}.pdf\" style=\"position:fixed;top:10px;right:10px;\"></a>\n    </body></html>\n  `);\n      newWin.document.close();\n    };\n  }\n\n  componentDidMount() {\n    this.fetchQuotes();\n    this.fetchCustomers();\n    this.fetchProducts();\n    this.fetchTaxGroups();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container-fluid\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1115,\n        columnNumber: 7\n      }\n    }, this.state.showEditForm ? this.renderEditForm() : this.state.previewMode ? this.renderQuotePreview() : this.renderQuoteTable());\n  }\n\n}\n\nexport default QuoteApproval;","map":{"version":3,"sources":["C:/Users/College/psp/StarAdmin-Free-React-Admin-Template-master/template/demo_1/src/app/sales/salestransactions/quote/QuoteApproval.js"],"names":["React","Component","db","collection","getDocs","updateDoc","doc","html2canvas","jsPDF","toWords","QuoteApproval","state","quotes","customers","products","taxGroups","selectedQuote","previewMode","editingId","showEditForm","editFormData","loading","error","showRejectDialog","rejectReason","fetchQuotes","setState","snap","docs","map","id","data","sort","a","b","dateA","Date","quoteDate","createdAt","toDate","dateB","err","message","fetchCustomers","fetchProducts","fetchTaxGroups","openPreview","quote","closePreview","convertToOrder","quoteObj","sessionStorage","setItem","JSON","stringify","props","history","push","pathname","openForm","quoteId","openEditForm","closeEditForm","handleEditInputChange","field","value","prev","recalculateEditTotals","quoteNo","length","handleEditLineItemChange","idx","items","lineItems","percent","amount","taxGroupNames","forEach","groupName","group","find","t","Array","isArray","comp","val","parseFloat","percentOrAmt","type","qty","unitPrice","baseTotal","taxAmt","toFixed","itemTotal","discountPercent","quoteValue","taxAmount","item","discountAmount","afterDiscountValue","handleEditSubmit","e","preventDefault","customer","alert","updateStatus","status","openRejectDialog","closeRejectDialog","handleRejectReasonChange","target","handleRejectConfirm","trim","renderRejectDialog","width","renderQuoteTable","fontSize","q","i","statusClass","showQuotePDFWithOrg","color","cursor","renderEditForm","quoteType","itemCode","itemDescription","renderQuotePreview","subtotal","reduce","sum","freightCharges","grandTotal","amountWords","Math","floor","c","custshortName","custname","marginBlockStart","gap","billTo","gstin","email","phone","shipTo","orgSnap","org","gstStateMap","getPlaceOfSupply","code","substring","enrichedItems","product","p","productId","ptshortName","hsnCode","uom","stockingUOM","cgst","sgst","igst","taxGroupName","split","s","freightTax","freighttaxAmount","totalTaxAmount","taxBreakdown","taxGroupDetails","sno","base","tgName","g","li","key","component","peramt","breakdownItems","breakdownType","container","document","createElement","style","padding","fontFamily","innerHTML","logoUrl","bgName","address","website","mobile","cin","currency","despatchMode","replace","contactPerson","gstLabel","join","taxId","total","Number","toLocaleString","body","appendChild","canvas","scale","useCORS","imgData","toDataURL","pdf","height","addImage","removeChild","addPage","milestoneRows","filter","bi","selected","mainItem","mainItemTotal","desc","dueDate","subProducts","sp","spIdx","rawVal","spTotal","name","taxRows","row","combinedHtml","combinedContainer","combinedCanvas","combinedImg","setFontSize","text","blob","output","url","URL","createObjectURL","newWin","window","open","write","close","componentDidMount","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { db } from \"../../../../firebase\";\r\nimport { collection, getDocs, updateDoc, doc } from \"firebase/firestore\";\r\nimport html2canvas from \"html2canvas\";\r\nimport { jsPDF } from \"jspdf\";\r\nimport { toWords } from \"number-to-words\";\r\n\r\nclass QuoteApproval extends Component {\r\n  state = {\r\n    quotes: [],\r\n    customers: [],\r\n    products: [],\r\n    taxGroups: [],\r\n    selectedQuote: null,\r\n    previewMode: false,\r\n    editingId: null,\r\n    showEditForm: false,\r\n    editFormData: null,\r\n    loading: false,\r\n    error: null,\r\n    showRejectDialog: false,\r\n    rejectReason: \"\",\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.fetchQuotes();\r\n    this.fetchCustomers();\r\n    this.fetchProducts();\r\n    this.fetchTaxGroups();\r\n  }\r\n\r\n  fetchQuotes = async () => {\r\n    this.setState({ loading: true, error: null });\r\n    try {\r\n      const snap = await getDocs(collection(db, \"quotes\"));\r\n      const quotes = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n      quotes.sort((a,b)=>{\r\n      const dateA=new Date(a.quoteDate || a.createdAt?.toDate?.() || a.createdAt || 0);\r\n      const dateB=new Date(b.quoteDate || b.createdAt?.toDate?.() || b.createdAt || 0);\r\n      return dateB - dateA;\r\n    });\r\n      this.setState({ quotes, loading: false });\r\n    } catch (err) {\r\n      this.setState({ error: err.message, loading: false });\r\n    }\r\n  };\r\n\r\n  fetchCustomers = async () => {\r\n    const snap = await getDocs(collection(db, \"customers\"));\r\n    const customers = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    this.setState({ customers });\r\n  };\r\n\r\n  fetchProducts = async () => {\r\n    const snap = await getDocs(collection(db, \"products\"));\r\n    const products = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    this.setState({ products });\r\n  };\r\n\r\n  fetchTaxGroups = async () => {\r\n    const snap = await getDocs(collection(db, \"taxGroups\"));\r\n    const taxGroups = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    this.setState({ taxGroups });\r\n  };\r\n\r\n  openPreview = (quote) => {\r\n    this.setState({ selectedQuote: quote, previewMode: true, showEditForm: false });\r\n  };\r\n\r\n  closePreview = () => {\r\n    this.setState({ selectedQuote: null, previewMode: false, showEditForm: false, editingId: null });\r\n  };\r\nconvertToOrder = (quoteObj) => {\r\n  sessionStorage.setItem('quoteToConvert', JSON.stringify(quoteObj));\r\n  this.props.history.push({\r\n    pathname: '/sales/salestransactions/order/Order',\r\n    state: { openForm: true, quoteId: quoteObj.id || null }\r\n  });\r\n};\r\n  openEditForm = (quote) => {\r\n    this.setState({\r\n      showEditForm: true,\r\n      editingId: quote.id,\r\n      editFormData: { ...quote },\r\n      previewMode: false,\r\n    });\r\n  };\r\ncloseEditForm = () => {\r\n  this.setState({ showEditForm: false, editingId: null, editFormData: null, previewMode: true });\r\n};\r\nhandleEditInputChange = (field, value) => {\r\n  this.setState(prev => ({\r\n    editFormData: { ...prev.editFormData, [field]: value }\r\n  }), () => {\r\n    if (field === \"discountPercent\") this.recalculateEditTotals();\r\n    if (field === \"quoteType\") {\r\n      if (value === \"Standard\") {\r\n        this.setState(prev => ({\r\n          editFormData: {\r\n            ...prev.editFormData,\r\n            quoteNo: `QT${1000 + this.state.quotes.length}`\r\n          }\r\n        }));\r\n      } else {\r\n        this.setState(prev => ({\r\n          editFormData: { ...prev.editFormData, quoteNo: \"\" }\r\n        }));\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nhandleEditLineItemChange = (idx, field, value) => {\r\n  const items = [...this.state.editFormData.lineItems];\r\n  items[idx] = { ...items[idx], [field]: value };\r\n  // Recalculate itemTotal and taxAmt\r\n  let percent = 0;\r\n  let amount = 0;\r\n  (items[idx].taxGroupNames || []).forEach(groupName => {\r\n    const group = this.state.taxGroups.find(t => t.groupName === groupName);\r\n    if (group && Array.isArray(group.lineItems)) {\r\n      group.lineItems.forEach(comp => {\r\n        const val = parseFloat(comp.percentOrAmt || 0);\r\n        if (comp.type === 'Percentage') percent += val;\r\n        if (comp.type === 'Amount') amount += val;\r\n      });\r\n    }\r\n  });\r\n  const qty = parseFloat(items[idx].qty || 0);\r\n  const unitPrice = parseFloat(items[idx].unitPrice || 0);\r\n  const baseTotal = qty * unitPrice;\r\n  const taxAmt = ((baseTotal * percent) / 100 + amount);\r\n  items[idx].taxAmt = taxAmt.toFixed(2);\r\n  items[idx].itemTotal = (baseTotal + taxAmt).toFixed(2);\r\n  items[idx].baseTotal = baseTotal.toFixed(2);\r\n\r\n  this.setState(prev => ({\r\n    editFormData: { ...prev.editFormData, lineItems: items }\r\n  }), this.recalculateEditTotals);\r\n};\r\n\r\n\r\nrecalculateEditTotals = () => {\r\n  const { lineItems, discountPercent } = this.state.editFormData;\r\n  let quoteValue = 0;\r\n  let taxAmount = 0;\r\n  (lineItems || []).forEach(item => {\r\n    quoteValue += parseFloat(item.itemTotal || 0);\r\n    taxAmount += parseFloat(item.taxAmt || 0);\r\n  });\r\n  const discountAmount = (parseFloat(quoteValue) * parseFloat(discountPercent || 0)) / 100;\r\n  const afterDiscountValue = quoteValue - discountAmount;\r\n  this.setState(prev => ({\r\n    editFormData: {\r\n      ...prev.editFormData,\r\n      quoteValue: quoteValue.toFixed(2),\r\n      taxAmount: taxAmount.toFixed(2),\r\n      discountAmount: discountAmount.toFixed(2),\r\n      afterDiscountValue: afterDiscountValue.toFixed(2)\r\n    }\r\n  }));\r\n};\r\n  handleEditSubmit = async (e) => {\r\n  e.preventDefault();\r\n  const { editingId, editFormData } = this.state;\r\n  if (!editFormData.customer) return alert(\"Customer is required\");\r\n  if (!editFormData.lineItems || editFormData.lineItems.length === 0) return alert(\"At least one line item is required\");\r\n  try {\r\n    await updateDoc(doc(db, \"quotes\", editingId), editFormData);\r\n    alert(\"Quote updated!\");\r\n    this.setState({ showEditForm: false, editingId: null, editFormData: null, previewMode: true });\r\n    this.fetchQuotes();\r\n  } catch (err) {\r\n    alert(\"Error updating quote: \" + err.message);\r\n  }\r\n};\r\n\r\n  updateStatus = async (id, status, rejectReason = \"\") => {\r\n  await updateDoc(doc(db, \"quotes\", id), { status, rejectReason });\r\n  alert(`Quote ${status}`);\r\n  this.fetchQuotes();\r\n  this.setState({ selectedQuote: null, previewMode: false, showRejectDialog: false, rejectReason: \"\" });\r\n};\r\n\r\n  openRejectDialog = () => {\r\n    this.setState({ showRejectDialog: true, rejectReason: \"\" });\r\n  };\r\n\r\n  closeRejectDialog = () => {\r\n    this.setState({ showRejectDialog: false, rejectReason: \"\" });\r\n  };\r\n\r\n  handleRejectReasonChange = (e) => {\r\n    this.setState({ rejectReason: e.target.value });\r\n  };\r\n\r\n  handleRejectConfirm = () => {\r\n    const { selectedQuote, rejectReason } = this.state;\r\n    if (!rejectReason.trim()) {\r\n      alert(\"Please enter a reason for rejection.\");\r\n      return;\r\n    }\r\n    this.updateStatus(selectedQuote.id, \"Rejected\", rejectReason);\r\n  };\r\n\r\n  renderRejectDialog = () => (\r\n    <div className=\"custom-overlay\">\r\n      <div className=\"custom-overlay-content\" style={{ width: 400 }}>\r\n        <h5>Reject Reason</h5>\r\n        <textarea\r\n          className=\"form-control\"\r\n          rows={3}\r\n          value={this.state.rejectReason}\r\n          onChange={this.handleRejectReasonChange}\r\n          placeholder=\"Enter reason for rejection\"\r\n        />\r\n        <div className=\"text-right mt-3\">\r\n          <button className=\"btn btn-secondary mr-2\" onClick={this.closeRejectDialog}>Cancel</button>\r\n          <button className=\"btn btn-danger\" onClick={this.handleRejectConfirm}>Reject</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  renderQuoteTable = () => (\r\n    <div className=\"card mt-4 full-height\">\r\n      <div className=\"card-body\">\r\n        <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n          <h4 className=\"card-title\">Quotes Approval</h4>\r\n        </div>\r\n        <div className=\"table-responsive\">\r\n          <table className=\"table table-bordered table-hover\">\r\n            <thead className=\"thead-light\">\r\n              <tr style={{ fontSize: '14px' }}>\r\n                <th>Quote ID</th>\r\n                <th>Customer</th>\r\n                <th>Date</th>\r\n                <th>Quote Value</th>\r\n                <th>After Discount</th>\r\n                <th>Status</th>\r\n                <th>Reject Reason</th>\r\n                <th>Print</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {this.state.quotes.map((q, i) => {\r\n                let statusClass = \"badge-secondary\";\r\n                if (q.status === \"Awaiting for Approval\") statusClass = \"badge-warning\";\r\n\r\n                else if (q.status === \"Approved\") statusClass = \"badge-success\";\r\n                else if (q.status === \"Rejected\") statusClass = \"badge-danger\";\r\n                else if (q.status === \"CO Created\") statusClass = \"badge-info\";\r\n\r\n                return (\r\n                  <tr key={i} style={{ fontSize: '14px' }}>\r\n                    <td>\r\n                      <button\r\n                        className=\"btn btn-link p-0\"\r\n                        onClick={() => this.openPreview(q)}\r\n                      >\r\n                        {q.quoteNo}\r\n                      </button>\r\n                    </td>\r\n                    <td>{q.customer}</td>\r\n                    <td>{q.quoteDate}</td>\r\n                    <td>{q.quoteValue}</td>\r\n                    <td>{q.afterDiscountValue}</td>\r\n                    <td>\r\n                      <label\r\n                        className={`badge ${statusClass}`}\r\n                        style={{ fontSize: '14px' }}>{q.status}</label>\r\n                    </td>\r\n                    <td>{q.rejectReason || \"-\"}</td>\r\n                    <td>\r\n                      <i\r\n                        className=\"mdi mdi-printer menu-icon\"\r\n                        onClick={() => this.showQuotePDFWithOrg(q)}\r\n                        style={{ fontSize: '24px', color: '#2196F3', cursor: 'pointer' }}\r\n                      ></i>\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })}\r\n              {this.state.quotes.length === 0 && (\r\n                <tr><td colSpan=\"8\" className=\"text-center\">No quotes found.</td></tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\nrenderEditForm = () => {\r\n  const { editFormData } = this.state;\r\n  if (!editFormData) return null;\r\n  return (\r\n    <div className=\"card mt-4 p-4 shadow-sm full-height d-flex flex-column\">\r\n      <h4>Edit Quote - {editFormData.quoteNo}</h4>\r\n      <form onSubmit={this.handleEditSubmit}>\r\n        <div className=\"form-row\">\r\n          <div className=\"form-group col-md-3\">\r\n            <label>Quote Type</label>\r\n            <select\r\n              className=\"form-control\"\r\n              value={editFormData.quoteType}\r\n              onChange={e => this.handleEditInputChange(\"quoteType\", e.target.value)}\r\n            >\r\n              <option value=\"Standard\">Standard</option>\r\n              <option value=\"Manual\">Manual</option>\r\n            </select>\r\n          </div>\r\n          <div className=\"form-group col-md-3\">\r\n            <label>Quote No</label>\r\n            {editFormData.quoteType === \"Standard\" ? (\r\n              <input\r\n                type=\"text\"\r\n                className=\"form-control\"\r\n                value={editFormData.quoteNo}\r\n                readOnly\r\n                placeholder=\"Auto\"\r\n              />\r\n            ) : (\r\n              <input\r\n                type=\"text\"\r\n                className=\"form-control\"\r\n                value={editFormData.quoteNo}\r\n                onChange={e => this.handleEditInputChange(\"quoteNo\", e.target.value)}\r\n                placeholder=\"Enter Quote No\"\r\n              />\r\n            )}\r\n            </div>\r\n          <div className=\"form-group col-md-3\">\r\n            <label>Customer</label>\r\n            <input\r\n              type=\"text\"\r\n              className=\"form-control\"\r\n              value={editFormData.customer}\r\n              onChange={e => this.handleEditInputChange(\"customer\", e.target.value)}\r\n            />\r\n          </div>\r\n          <div className=\"form-group col-md-3\">\r\n            <label>Date</label>\r\n            <input\r\n              type=\"date\"\r\n              className=\"form-control\"\r\n              value={editFormData.quoteDate}\r\n              onChange={e => this.handleEditInputChange(\"quoteDate\", e.target.value)}\r\n            />\r\n          </div>\r\n        </div> <div className=\"form-row\">\r\n          <div className=\"form-group col-md-3\">\r\n            <label>Status</label>\r\n            <input\r\n              type=\"text\"\r\n              className=\"form-control\"\r\n              value={editFormData.status}\r\n              readOnly\r\n            />\r\n          </div>\r\n          <div className=\"form-group col-md-3\">\r\n            <label>Discount %</label>\r\n            <input\r\n              type=\"number\"\r\n              className=\"form-control\"\r\n              value={editFormData.discountPercent}\r\n              onChange={e => this.handleEditInputChange(\"discountPercent\", e.target.value)}\r\n            />\r\n          </div>\r\n          <div className=\"form-group col-md-3\">\r\n            <label>Quote Value</label>\r\n            <input\r\n              type=\"number\"\r\n              className=\"form-control\"\r\n              value={editFormData.quoteValue}\r\n              readOnly\r\n            />\r\n          </div>\r\n <div className=\"form-group col-md-3\">\r\n            <label>Tax Amount</label>\r\n            <input\r\n              type=\"number\"\r\n              className=\"form-control\"\r\n              value={editFormData.taxAmount}\r\n              readOnly\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"form-row\">\r\n          <div className=\"form-group col-md-3\">\r\n            <label>Discount Amount</label>\r\n            <input\r\n              type=\"number\"\r\n              className=\"form-control\"\r\n              value={editFormData.discountAmount}\r\n              readOnly\r\n            />\r\n          </div><div className=\"form-group col-md-3\">\r\n            <label>After Discount</label>\r\n            <input\r\n              type=\"number\"\r\n              className=\"form-control\"\r\n              value={editFormData.discountPercent > 0 ? editFormData.afterDiscountValue : \"\"}\r\n              readOnly\r\n              placeholder={editFormData.discountPercent > 0 ? \"\" : \"Enter Discount %\"}\r\n            />\r\n          </div>\r\n        </div>\r\n        <h5 className=\"mt-3\">Line Items</h5>\r\n        <table className=\"table table-bordered table-sm\">\r\n          <thead className=\"thead-light\">\r\n            <tr>\r\n              <th>Item Code</th>\r\n              <th>Description</th>\r\n              <th>Qty</th>\r\n              <th>Unit Price</th>\r\n              <th>Tax Amount</th>\r\n              <th>Item Total</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody> {editFormData.lineItems?.map((item, idx) => (\r\n              <tr key={idx}>\r\n                <td>{item.itemCode}</td>\r\n                <td>{item.itemDescription}</td>\r\n                <td>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={item.qty}\r\n                    onChange={e => this.handleEditLineItemChange(idx, \"qty\", e.target.value)}\r\n                    style={{ width: 80 }}\r\n                  />\r\n                </td>\r\n                <td>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={item.unitPrice}\r\n                    onChange={e => this.handleEditLineItemChange(idx, \"unitPrice\", e.target.value)}\r\n                    style={{ width: 80 }}\r\n                  />\r\n                </td>\r\n                <td>{item.taxAmt}</td>\r\n                <td>{item.itemTotal}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n<div className=\"mt-3 text-right\">\r\n          <button type=\"submit\" className=\"btn btn-success mr-2\">Save</button>\r\n          <button type=\"button\" className=\"btn btn-secondary\" onClick={this.closeEditForm}>Cancel</button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\n  renderQuotePreview = () => {\r\n    const q = this.state.selectedQuote;\r\n    if (!q) return null;\r\n\r\n    const subtotal = q.lineItems?.reduce(\r\n      (sum, item) => sum + (parseFloat(item.itemTotal) || 0),\r\n      0\r\n    ) || 0;\r\n\r\n    const freightCharges = parseFloat(q.freightCharges || 0);\r\n    const taxAmount = parseFloat(q.taxAmount || 0);\r\n    const grandTotal = parseFloat(q.quoteValue || subtotal + freightCharges + taxAmount);\r\n\r\n    const amountWords = `INR ${toWords(Math.floor(grandTotal))} Only`;\r\n\r\n    // Find customer record for extra details\r\n    const customer = this.state.customers.find(\r\n      c => c.custshortName === q.customer || c.custname === q.customer\r\n    ) || {};\r\n\r\n    return (\r\n      <div className=\"card mt-4 p-4 shadow-sm full-height d-flex flex-column\">\r\n        {/* Header */}\r\n        <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n          <h4 className=\"card-title mb-0\">Quote Preview - {q.quoteNo}</h4>\r\n          <div className=\"flex items-center gap-x-4\">\r\n            <button\r\n              className=\"btn btn-sm btn-primary mr-2\"\r\n              onClick={() => this.openEditForm(q)}\r\n              disabled={q.status === \"CO Created\"}\r\n            >\r\n              Edit\r\n            </button>\r\n            <button\r\n              className=\"btn btn-sm btn-outline-secondary\"\r\n              onClick={() => this.convertToOrder(q)}\r\n              disabled={q.status !== \"Approved\"}\r\n            >\r\n              Convert to Order\r\n            </button>\r\n            <i\r\n              className=\"mdi mdi-printer menu-icon ml-3\"\r\n              style={{ marginBlockStart: '10px', gap: '10px', fontSize: '27px', color: '#2196F3', cursor: 'pointer' }}\r\n              onClick={() => this.showQuotePDFWithOrg(q)}\r\n            ></i>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Quote Info */}\r\n        <div className=\"row mb-3\">\r\n          <div className=\"col-md-4\"><b>Customer:</b> {q.customer}</div>\r\n          <div className=\"col-md-4\"><b>Date:</b> {q.quoteDate}</div>\r\n          <div className=\"col-md-4\"><b>Status:</b> {q.status}</div>\r\n        </div>\r\n\r\n        <div className=\"row mb-4\">\r\n          <div className=\"col-md-6\">\r\n            <b>Bill To:</b><br />\r\n            {q.billTo || \"-\"}\r\n            <div className=\"mt-2\" style={{ fontSize: \"0.9em\" }}>\r\n              <b>GSTIN:</b> {customer.gstin || \"-\"}<br />\r\n              <b>Email:</b> {customer.email || \"-\"}<br />\r\n              <b>Phone:</b> {customer.phone || \"-\"}\r\n            </div>\r\n          </div>\r\n          <div className=\"col-md-6\">\r\n            <b>Ship To:</b><br />\r\n            {q.shipTo || \"-\"}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Line Items */}\r\n        <h5 className=\"mt-2\">Line Items</h5>\r\n        <table className=\"table table-bordered table-sm\">\r\n          <thead className=\"thead-light\">\r\n            <tr>\r\n              <th>Item Code</th>\r\n              <th>Description</th>\r\n              <th>Qty</th>\r\n              <th>Unit Price</th>\r\n              <th>Tax Amount</th>\r\n              <th>Item Total</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {q.lineItems?.map((item, i) => (\r\n              <tr key={i}>\r\n                <td>{item.itemCode}</td>\r\n                <td>{item.itemDescription}</td>\r\n                <td>{item.qty}</td>\r\n                <td>{item.unitPrice}</td>\r\n                <td>{item.taxAmt}</td>\r\n                <td>{item.itemTotal}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n\r\n        {/* Totals as Text */}\r\n        <div className=\"mt-3\">\r\n          <p><b>Subtotal:</b> {subtotal.toFixed(2)}</p>\r\n          <p><b>Freight Charges:</b> {freightCharges.toFixed(2)}</p>\r\n          <p><b>Tax Amount:</b> {taxAmount.toFixed(2)}</p>\r\n          <p className=\"h6\"><b>Grand Total:</b> {grandTotal.toFixed(2)}</p>\r\n          <p className=\"h6\"><b>Amount in Words:</b> {amountWords}</p>\r\n        </div>\r\n        <div className=\"mt-2\">\r\n          <b>Reject Reason:</b> {q.rejectReason || \"-\"}\r\n        </div>\r\n        <div className=\"mt-auto pt-3 text-right\">\r\n          <button\r\n            className=\"btn btn-success\"\r\n            onClick={() => this.updateStatus(q.id, \"Approved\")}\r\n            disabled={q.status !== \"Awaiting for Approval\"}\r\n          >\r\n            Approve\r\n          </button>\r\n          <button\r\n          className=\"btn btn-danger\"\r\n          onClick={this.openRejectDialog}\r\n          disabled={q.status !== \"Awaiting for Approval\"}\r\n        >\r\n          Reject\r\n        </button>\r\n          <button\r\n            className=\"btn btn-secondary\"\r\n            onClick={this.closePreview}\r\n          >\r\n            Back to List\r\n          </button>\r\n        </div>\r\n        {this.state.showRejectDialog && this.renderRejectDialog()}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  renderEditForm = () => {\r\n    const { editFormData } = this.state;\r\n    if (!editFormData) return null;\r\n    return (\r\n      <div className=\"card mt-4 p-4 shadow-sm full-height d-flex flex-column\">\r\n        <h4>Edit Quote - {editFormData.quoteNo}</h4>\r\n        <form onSubmit={this.handleEditSubmit}>\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group col-md-3\">\r\n              <label>Customer</label>\r\n              <input\r\n                type=\"text\"\r\n                className=\"form-control\"\r\n                value={editFormData.customer}\r\n                onChange={e => this.handleEditInputChange(\"customer\", e.target.value)}\r\n              />\r\n            </div>\r\n            <div className=\"form-group col-md-3\">\r\n              <label>Date</label>\r\n              <input\r\n                type=\"date\"\r\n                className=\"form-control\"\r\n                value={editFormData.quoteDate}\r\n                onChange={e => this.handleEditInputChange(\"quoteDate\", e.target.value)}\r\n              />\r\n            </div>\r\n            <div className=\"form-group col-md-3\">\r\n              <label>Status</label>\r\n              <input\r\n                type=\"text\"\r\n                className=\"form-control\"\r\n                value={editFormData.status}\r\n                readOnly\r\n              />\r\n            </div>\r\n            <div className=\"form-group col-md-3\">\r\n              <label>Discount %</label>\r\n              <input\r\n                type=\"number\"\r\n                className=\"form-control\"\r\n                value={editFormData.discountPercent}\r\n                onChange={e => this.handleEditInputChange(\"discountPercent\", e.target.value)}\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group col-md-3\">\r\n              <label>Quote Value</label>\r\n              <input\r\n                type=\"number\"\r\n                className=\"form-control\"\r\n                value={editFormData.quoteValue}\r\n                readOnly\r\n              />\r\n            </div>\r\n            <div className=\"form-group col-md-3\">\r\n              <label>Tax Amount</label>\r\n              <input\r\n                type=\"number\"\r\n                className=\"form-control\"\r\n                value={editFormData.taxAmount}\r\n                readOnly\r\n              />\r\n            </div>\r\n            <div className=\"form-group col-md-3\">\r\n              <label>Discount Amount</label>\r\n              <input\r\n                type=\"number\"\r\n                className=\"form-control\"\r\n                value={editFormData.discountAmount}\r\n                readOnly\r\n              />\r\n            </div>\r\n            <div className=\"form-group col-md-3\">\r\n              <label>After Discount</label>\r\n              <input\r\n                type=\"number\"\r\n                className=\"form-control\"\r\n                value={editFormData.afterDiscountValue}\r\n                readOnly\r\n              />\r\n            </div>\r\n          </div>\r\n          <h5 className=\"mt-3\">Line Items</h5>\r\n          <table className=\"table table-bordered table-sm\">\r\n            <thead className=\"thead-light\">\r\n              <tr>\r\n                <th>Item Code</th>\r\n                <th>Description</th>\r\n                <th>Qty</th>\r\n                <th>Unit Price</th>\r\n                <th>Tax Amount</th>\r\n                <th>Item Total</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {editFormData.lineItems?.map((item, idx) => (\r\n                <tr key={idx}>\r\n                  <td>{item.itemCode}</td>\r\n                  <td>{item.itemDescription}</td>\r\n                  <td>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={item.qty}\r\n                      onChange={e => this.handleEditLineItemChange(idx, \"qty\", e.target.value)}\r\n                      style={{ width: 80 }}\r\n                    />\r\n                  </td>\r\n                  <td>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={item.unitPrice}\r\n                      onChange={e => this.handleEditLineItemChange(idx, \"unitPrice\", e.target.value)}\r\n                      style={{ width: 80 }}\r\n                    />\r\n                  </td>\r\n                  <td>{item.baseTotal}</td>\r\n                  <td>{item.taxAmt}</td>\r\n                  <td>{item.itemTotal}</td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n          <div className=\"mt-3 text-right\">\r\n            <button type=\"submit\" className=\"btn btn-success mr-2\">Save</button>\r\n            <button type=\"button\" className=\"btn btn-secondary\" onClick={this.closePreview}>Cancel</button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    );\r\n  };\r\n\r\n showQuotePDFWithOrg = async (quote) => {\r\n  if (!quote || !Array.isArray(quote.lineItems) || quote.lineItems.length === 0) {\r\n    alert(\"Quote data is incomplete.\");\r\n    return;\r\n  }\r\n\r\n  // 1. Fetch org and customer data\r\n  const orgSnap = await getDocs(collection(db, 'businessGroups'));\r\n  const org = orgSnap.docs[0]?.data() || {};\r\n  const customer = this.state.customers.find(\r\n    c => c.custshortName === quote.customer || c.custname === quote.customer\r\n  ) || {};\r\n\r\n  // GST State Map for Place of Supply\r\n  const gstStateMap = {\r\n    \"01\": \"Jammu & Kashmir\", \"02\": \"Himachal Pradesh\", \"03\": \"Punjab\", \"04\": \"Chandigarh\",\r\n    \"05\": \"Uttarakhand\", \"06\": \"Haryana\", \"07\": \"Delhi\", \"08\": \"Rajasthan\", \"09\": \"Uttar Pradesh\",\r\n    \"10\": \"Bihar\", \"11\": \"Sikkim\", \"12\": \"Arunachal Pradesh\", \"13\": \"Nagaland\", \"14\": \"Manipur\",\r\n    \"15\": \"Mizoram\", \"16\": \"Tripura\", \"17\": \"Meghalaya\", \"18\": \"Assam\", \"19\": \"West Bengal\",\r\n    \"20\": \"Jharkhand\", \"21\": \"Odisha\", \"22\": \"Chhattisgarh\", \"23\": \"Madhya Pradesh\", \"24\": \"Gujarat\",\r\n    \"25\": \"Daman and Diu\", \"26\": \"Dadra and Nagar Haveli\", \"27\": \"Maharashtra\", \"28\": \"Andhra Pradesh (Old)\",\r\n    \"29\": \"Karnataka\", \"30\": \"Goa\", \"31\": \"Lakshadweep\", \"32\": \"Kerala\", \"33\": \"Tamil Nadu\",\r\n    \"34\": \"Puducherry\", \"35\": \"Andaman and Nicobar Islands\", \"36\": \"Telangana\", \"37\": \"Andhra Pradesh\",\r\n    \"97\": \"Other Territory\"\r\n  };\r\n\r\n  // Helper for Place of Supply\r\n  const getPlaceOfSupply = (gstin) => {\r\n    if (!gstin || gstin.length < 2) return '';\r\n    const code = gstin.substring(0, 2);\r\n    const state = gstStateMap[code];\r\n    return state ? `${code} - ${state}` : '';\r\n  };\r\n\r\n  // 2. Enrich line items\r\n  const enrichedItems = quote.lineItems.map(item => {\r\n    const product = this.state.products.find(p => p.productId === item.itemCode) || {};\r\n    return {\r\n      ...item,\r\n      ptshortName: product.ptshortName || '',\r\n      hsnCode: product.hsnCode || '',\r\n      uom: product.stockingUOM || '',\r\n      cgst: item.cgst || 0,\r\n      sgst: item.sgst || 0,\r\n      igst: item.igst || 0,\r\n      taxGroupNames: item.taxGroupNames || (item.taxGroupName ? item.taxGroupName.split(',').map(s => s.trim()) : [])\r\n    };\r\n  });\r\n\r\n  // 3. Subtotal (without tax)\r\n  const subtotal = enrichedItems.reduce((sum, item) => sum + ((parseFloat(item.unitPrice) || 0) * (parseFloat(item.qty) || 0)), 0);\r\n  const freightCharges = parseFloat(quote.freightCharges || 0);\r\n  const freightTax = parseFloat(quote.freighttaxAmount || 0);\r\n  const totalTaxAmount = parseFloat(quote.taxAmount || 0);\r\n  const grandTotal = parseFloat(quote.quoteValue || (subtotal + totalTaxAmount));\r\n  const amountWords = `INR ${toWords(Math.floor(grandTotal))} Only`;\r\n\r\n  // 4. Tax breakdown by group\r\n  let taxBreakdown = {};\r\n  let taxGroupDetails = [];\r\n  let sno = 1;\r\n  enrichedItems.forEach(item => {\r\n    const qty = parseFloat(item.qty || 0);\r\n    const unitPrice = parseFloat(item.unitPrice || 0);\r\n    const base = qty * unitPrice;\r\n    (item.taxGroupNames || []).forEach(tgName => {\r\n      // Find group in taxGroups\r\n      const group = (this.state.taxGroups || []).find(g => g.groupName === tgName);\r\n      if (group) {\r\n        group.lineItems.forEach(li => {\r\n          const key = `${tgName} - ${li.component} (${li.percentOrAmt}${li.type === 'Amount' ? '' : '%'})`;\r\n          let taxAmt = 0;\r\n          if (li.type === 'Amount') taxAmt = parseFloat(li.percentOrAmt || 0);\r\n          else taxAmt = (base * parseFloat(li.percentOrAmt || 0)) / 100;\r\n          taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\r\n          taxGroupDetails.push({\r\n            sno: sno++,\r\n            group: tgName,\r\n            peramt: `${li.percentOrAmt}${li.type === 'Amount' ? '' : '%'}`,\r\n            taxAmt: taxAmt.toFixed(2)\r\n          });\r\n        });\r\n      }\r\n    });\r\n    // Legacy support for cgst/sgst/igst\r\n    if (item.cgst) {\r\n      const key = `CGST ${item.cgst}%`;\r\n      const taxAmt = (base * item.cgst) / 100;\r\n      taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\r\n      taxGroupDetails.push({\r\n        sno: sno++,\r\n        group: key,\r\n        peramt: `${item.cgst}%`,\r\n        taxAmt: taxAmt.toFixed(2)\r\n      });\r\n    }\r\n    if (item.sgst) {\r\n      const key = `SGST ${item.sgst}%`;\r\n      const taxAmt = (base * item.sgst) / 100;\r\n      taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\r\n      taxGroupDetails.push({\r\n        sno: sno++,\r\n        group: key,\r\n        peramt: `${item.sgst}%`,\r\n        taxAmt: taxAmt.toFixed(2)\r\n      });\r\n    }\r\n    if (item.igst) {\r\n      const key = `IGST ${item.igst}%`;\r\n      const taxAmt = (base * item.igst) / 100;\r\n      taxBreakdown[key] = (taxBreakdown[key] || 0) + taxAmt;\r\n      taxGroupDetails.push({\r\n        sno: sno++,\r\n        group: key,\r\n        peramt: `${item.igst}%`,\r\n        taxAmt: taxAmt.toFixed(2)\r\n      });\r\n    }\r\n  });\r\n  if (freightTax > 0) {\r\n    taxBreakdown[\"Freight Tax\"] = freightTax;\r\n    taxGroupDetails.push({\r\n      sno: sno++,\r\n      group: \"Freight Tax\",\r\n      peramt: \"-\",\r\n      taxAmt: freightTax.toFixed(2)\r\n    });\r\n  }\r\n\r\n  // 5. Milestone breakdown (with subproducts)\r\n  const { breakdownItems, breakdownType } = this.state;\r\n\r\n  // 6. Build HTML for PDF\r\n  const container = document.createElement('div');\r\n  container.id = 'pdf-preview-container';\r\n  container.style.width = '794px';\r\n  container.style.padding = '40px';\r\n  container.style.fontFamily = 'Arial';\r\n\r\n  // 7. Main PDF content\r\n  container.innerHTML = `\r\n    <div style=\"display:flex; justify-content:space-between; align-items:center;\">\r\n      <img src=\"${org.logoUrl || ''}\" style=\"height:50px;\" />\r\n      <div style=\"font-size:18px; font-weight:bold;\">QUOTATION</div>\r\n    </div>\r\n    <hr/>\r\n    <div style=\"display:flex; justify-content:space-between; font-size:11px;\">\r\n      <div style=\"line-height:1.5; width:50%;\">\r\n        <b>${org.bgName || ''}</b><br/>\r\n        ${org.address || ''}<br/>\r\n        <b>Email:</b> ${org.email || ''}<br/>\r\n        <b>Website:</b> ${org.website || ''}<br/>\r\n        <b>GSTIN:</b> ${org.gstin || ''}<br/>\r\n        <b>Mobile:</b> ${org.mobile || ''}<br/>\r\n        <b>CIN:</b> ${org.cin || ''}\r\n      </div>\r\n      <table style=\"font-size:11px; text-align:left;\">\r\n        <tr><td><b>Quote No</b></td><td>: ${quote.quoteNo}</td></tr>\r\n        <tr><td><b>Quote Date</b></td><td>: ${quote.quoteDate}</td></tr>\r\n        <tr><td><b>Currency</b></td><td>: ${quote.currency || 'INR'}</td></tr>\r\n        <tr><td><b>Despatch</b></td><td>: ${quote.despatchMode || ''}</td></tr>\r\n      </table>\r\n    </div>\r\n\r\n    <div style=\"margin-top:15px; display:flex; justify-content:space-between; font-size:11px;\">\r\n      <div style=\"width:48%;\">\r\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Bill To</b>\r\n        <div style=\"border:1px solid #ccc; padding:6px;\">\r\n         <b>${quote.customer || ''}</b><br/>\r\n          ${quote.billTo?.replace(/\\n/g, '<br/>') || ''}\r\n        </div>\r\n        <div style=\"font-size:10px; margin-top:6px;\">\r\n            <b>GSTIN:</b> ${customer.gstin || ''}<br/>\r\n            <b>Email:</b> ${customer.email || ''}<br/>\r\n            <b>Contact:</b> ${customer.contactPerson || ''}<br/>\r\n            <b>Phone:</b> ${customer.phone || ''}\r\n        </div>\r\n      </div>\r\n      <div style=\"width:48%;\">\r\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Ship To</b>\r\n        <div style=\"border:1px solid #ccc; padding:6px;\">\r\n         <b>${quote.customer || ''}</b><br/>\r\n          ${quote.shipTo?.replace(/\\n/g, '<br/>') || ''}\r\n        </div>\r\n        <div style=\"font-size:10px; margin-top:6px;\">\r\n          <b>Place of Supply:</b> ${getPlaceOfSupply(customer.gstin || '')}\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\r\n      <thead>\r\n        <tr style=\"background:#f4f6fa;\">\r\n          <th style=\"border:1px solid #011b56;\">Item Code</th>\r\n          <th style=\"border:1px solid #011b56;\">Description</th>\r\n          <th style=\"border:1px solid #011b56;\">HSN</th>\r\n          <th style=\"border:1px solid #011b56;\">UOM</th>\r\n          <th style=\"border:1px solid #011b56;\">Qty</th>\r\n          <th style=\"border:1px solid #011b56;\">Unit Price</th>\r\n          <th style=\"border:1px solid #011b56;\">GST%</th>\r\n          <th style=\"border:1px solid #011b56;\">Item Total</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        ${enrichedItems.map(item => {\r\n          const gstLabel = (item.taxGroupNames && item.taxGroupNames.length)\r\n            ? item.taxGroupNames.join(', ')\r\n            : (item.taxGroupName || item.taxId || '-');\r\n          return `\r\n            <tr>\r\n              <td style=\"border:1px solid #011b56;\">${item.itemCode}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.itemDescription}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.hsnCode}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.uom}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.qty}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.unitPrice}</td>\r\n              <td style=\"border:1px solid #011b56;\">${gstLabel}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.total}</td>\r\n            </tr>`;\r\n        }).join('')}\r\n        <tr>\r\n          <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Subtotal</b></td>\r\n          <td style=\"border:1px solid #011b56;\"><b>${subtotal.toFixed(2)}</b></td>\r\n      </tr>\r\n        \r\n          <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td>\r\n          <td style=\"border:1px solid #011b56;\"><b>${totalTaxAmount.toFixed(2)}</b></td>\r\n        </tr>\r\n        <tr>\r\n  <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Discount Amount</b></td>\r\n  <td style=\"border:1px solid #011b56;\"><b>${Number(quote.discountAmount || 0).toFixed(2)}</b></td>\r\n</tr>\r\n\r\n        <tr>\r\n  <td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Grand Total</b></td>\r\n  <td style=\"border:1px solid #011b56;\"><b>${Number(quote.afterDiscountValue || grandTotal).toFixed(2)}</b></td>\r\n</tr>\r\n\r\n      </tbody>\r\n    </table>\r\n    <div style=\"margin-top:8px; font-size:11px;\"><b>Amount in Words:</b> ${amountWords}</div>\r\n    <div style=\"margin-top:20px; text-align:right; font-size:10px;\">Printed on ${new Date().toLocaleString()}</div>\r\n  `;\r\n\r\n  document.body.appendChild(container);\r\n  const canvas = await html2canvas(container, { scale: 2, useCORS: true });\r\n  const imgData = canvas.toDataURL('image/png');\r\n  const pdf = new jsPDF('p', 'pt', 'a4');\r\n  const width = 595.28;\r\n  const height = canvas.height * width / canvas.width;\r\n  pdf.addImage(imgData, 'PNG', 0, 0, width, height);\r\n  document.body.removeChild(container);\r\n\r\n  // ...existing code...\r\n\r\n// 8. Milestone breakdown and tax breakdown on the same page, same style as quote table\r\nif (breakdownItems && breakdownItems.length > 0) {\r\n  pdf.addPage();\r\n\r\n  let milestoneRows = breakdownItems.filter(bi => bi.selected !== false).map((item, idx) => {\r\n  const mainItem = enrichedItems.find(li => li.itemCode === item.productId);\r\n  const mainItemTotal = mainItem ? (parseFloat(mainItem.total) || 0) : 0;\r\n\r\n  return `\r\n    <tr>\r\n      <td style=\"border:1px solid #011b56;\">${item.sno || ''}</td>\r\n      <td style=\"border:1px solid #011b56;\">${item.productId || ''}</td>\r\n      <td style=\"border:1px solid #011b56;\">${item.desc || ''}</td>\r\n      <td style=\"border:1px solid #011b56;\">${item.value ? item.value + (breakdownType === 'Percentage' ? '%' : '₹') : ''}</td>\r\n      <td style=\"border:1px solid #011b56;\">${item.dueDate || ''}</td>\r\n      <td style=\"border:1px solid #011b56;\">${mainItemTotal.toFixed(2)}</td>\r\n    </tr>\r\n    ${(item.subProducts || []).map((sp, spIdx) => {\r\n      const rawVal = parseFloat(sp.value || 0) || 0;\r\n      let spTotal = 0;\r\n      if (breakdownType === 'Percentage') {\r\n        spTotal = mainItemTotal * rawVal / 100;\r\n      } else {\r\n        spTotal = rawVal;\r\n      }\r\n      return `\r\n        <tr style=\"background: #f9f9f9;\">\r\n          <td style=\"border:1px solid #011b56;\"></td>\r\n          <td style=\"border:1px solid #011b56;\">${item.productId}_${spIdx + 1}</td>\r\n          <td style=\"border:1px solid #011b56;\">→ ${sp.name || ''}</td>\r\n          <td style=\"border:1px solid #011b56;\">${sp.value ? (breakdownType === 'Percentage' ? sp.value + '%' : '₹' + sp.value) : ''}</td>\r\n          <td style=\"border:1px solid #011b56;\">${sp.dueDate || ''}</td>\r\n          <td style=\"border:1px solid #011b56;\">${spTotal.toFixed(2)}</td>\r\n        </tr>\r\n      `;\r\n    }).join('')}\r\n  `;\r\n}).join('');\r\n\r\n\r\n  let taxRows = taxGroupDetails.map(row => {\r\n  return `\r\n    <tr>\r\n      <td style=\"border:1px solid #011b56;\">${row.sno}</td>\r\n      <td style=\"border:1px solid #011b56;\">${row.group}</td>\r\n      <td style=\"border:1px solid #011b56;\">${row.peramt}</td>\r\n      <td style=\"border:1px solid #011b56;\">${row.taxAmt}</td>\r\n    </tr>\r\n  `;\r\n}).join('');\r\n\r\n\r\n  let combinedHtml = `\r\n    <div style=\"font-family:Arial; padding:40px; width:100%;\">\r\n      <h3 style=\"margin-bottom:10px; font-size:16px;\">Milestone Breakdown</h3>\r\n      <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\r\n        <thead>\r\n          <tr style=\"background:#f4f6fa;\">\r\n            <th style=\"border:1px solid #011b56;\">S.No</th>\r\n            <th style=\"border:1px solid #011b56;\">Item ID</th>\r\n            <th style=\"border:1px solid #011b56;\">Desc</th>\r\n            <th style=\"border:1px solid #011b56;\">${breakdownType}</th>\r\n            <th style=\"border:1px solid #011b56;\">Due Date</th>\r\n            <th style=\"border:1px solid #011b56;\">Item Total</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          ${milestoneRows}\r\n        </tbody>\r\n      </table>\r\n      <h3 style=\"margin-bottom:10px; margin-top:30px; font-size:16px;\">Tax Breakdown</h3>\r\n      <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\r\n        <thead>\r\n          <tr style=\"background:#f4f6fa;\">\r\n            <th style=\"border:1px solid #011b56;\">S.No</th>\r\n            <th style=\"border:1px solid #011b56;\">Tax Group</th>\r\n            <th style=\"border:1px solid #011b56;\">Per/Amt</th>\r\n            <th style=\"border:1px solid #011b56;\">Tax Amt</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          ${taxRows}\r\n          <tr>\r\n            <td colspan=\"3\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td>\r\n            <td style=\"border:1px solid #011b56;\"><b>${totalTaxAmount.toFixed(2)}</b></td>\r\n          </tr>\r\n          <tr>\r\n  <td style=\"border:1px solid #011b56;\"></td>\r\n  <td style=\"border:1px solid #011b56;\">Discount</td>\r\n  <td style=\"border:1px solid #011b56;\">${quote.discountPercent || 0}%</td>\r\n  <td style=\"border:1px solid #011b56;\">${(quote.discountAmount || 0).toFixed(2)}</td>\r\n</tr>\r\n\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  `;\r\n\r\n  const combinedContainer = document.createElement('div');\r\n  combinedContainer.id = 'pdf-preview-container';\r\n  combinedContainer.style.width = '794px';\r\n  combinedContainer.style.padding = '40px';\r\n  combinedContainer.style.fontFamily = 'Arial';\r\n  combinedContainer.style.fontSize = '10px'; // Ensure same font size as first page\r\n  combinedContainer.innerHTML = combinedHtml;\r\n  document.body.appendChild(combinedContainer);\r\n\r\n  const combinedCanvas = await html2canvas(combinedContainer, { scale: 2, useCORS: true });\r\n  const combinedImg = combinedCanvas.toDataURL('image/png');\r\n  pdf.addImage(combinedImg, 'PNG', 0, 0, width, combinedCanvas.height * width / combinedCanvas.width);\r\n\r\n  document.body.removeChild(combinedContainer);\r\n\r\n}\r\n\r\n  pdf.setFontSize(11);\r\n  pdf.text(`For ${org.bgName || ''}`, width - 200, 780);\r\n  pdf.text('Authorized Signatory', width - 200, 800);\r\n\r\n  // 11. Show PDF\r\n  const blob = pdf.output('blob');\r\n  const url = URL.createObjectURL(blob);\r\n  const newWin = window.open();\r\n  newWin.document.write(`\r\n    <html><head><title>Quote PDF Preview</title></head>\r\n    <body style=\"margin:0;\">\r\n      <iframe width=\"100%\" height=\"100%\" style=\"border:none;\" src=\"${url}\"></iframe>\r\n      <button onclick=\"document.querySelector('iframe').contentWindow.print()\" style=\"position:fixed;top:10px;right:110px;\"></button>\r\n      <a href=\"${url}\" download=\"Quote_${quote.quoteNo || 'PDF'}.pdf\" style=\"position:fixed;top:10px;right:10px;\"></a>\r\n    </body></html>\r\n  `);\r\n  newWin.document.close();\r\n};\r\n\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"container-fluid\">\r\n        {this.state.showEditForm\r\n        ? this.renderEditForm()\r\n        : this.state.previewMode\r\n          ? this.renderQuotePreview()\r\n          : this.renderQuoteTable()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default QuoteApproval;"]},"metadata":{},"sourceType":"module"}