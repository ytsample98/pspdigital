{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\College\\\\admin\\\\StarAdmin-Free-React-Admin-Template-master\\\\template\\\\demo_1\\\\src\\\\app\\\\sales\\\\salestransactions\\\\invoice\\\\BillingCancel.js\";\nimport React, { Component } from 'react';\nimport { db } from '../../../../firebase';\nimport { collection, getDocs, updateDoc, doc } from 'firebase/firestore';\nimport { serverTimestamp } from 'firebase/firestore';\n\nclass BillingCancel extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      cobilling: [],\n      selected: null,\n      loading: false,\n      showCancelDialog: false,\n      cancelReason: \"\"\n    };\n\n    this.fetchBills = async () => {\n      try {\n        const snapCOB = await getDocs(collection(db, 'cobilling'));\n        const cobData = snapCOB.docs.map(d => ({\n          id: d.id,\n          ...d.data(),\n          source: 'cob'\n        }));\n        const snapINV = await getDocs(collection(db, 'invoices'));\n        const invData = snapINV.docs.map(d => ({\n          id: d.id,\n          ...d.data(),\n          source: 'direct'\n        })); // show bills that can be cancelled (Approved) — mirror approval/amendment flows\n\n        const cancelable = [...cobData, ...invData].filter(c => c.status === 'Approved');\n        this.setState({\n          cobilling: cancelable\n        });\n      } catch (err) {\n        console.error('fetchBills error', err);\n        alert('Error fetching bills: ' + err.message);\n      }\n    };\n\n    this.openPreview = cob => {\n      this.setState({\n        selected: cob\n      });\n    };\n\n    this.closePreview = () => {\n      this.setState({\n        selected: null,\n        showCancelDialog: false,\n        cancelReason: \"\"\n      });\n    };\n\n    this.openCancelDialog = () => {\n      this.setState({\n        showCancelDialog: true,\n        cancelReason: \"\"\n      });\n    };\n\n    this.closeCancelDialog = () => {\n      this.setState({\n        showCancelDialog: false,\n        cancelReason: \"\"\n      });\n    };\n\n    this.handleCancelReasonChange = e => {\n      this.setState({\n        cancelReason: e.target.value\n      });\n    };\n\n    this.handleCancelConfirm = async () => {\n      const {\n        selected,\n        cancelReason\n      } = this.state;\n\n      if (!cancelReason.trim()) {\n        alert(\"Please enter a reason for cancellation.\");\n        return;\n      }\n\n      try {\n        const collectionName = selected.source === 'direct' ? 'invoices' : 'cobilling';\n        const ref = doc(db, collectionName, selected.id);\n        await updateDoc(ref, {\n          status: 'Cancelled',\n          cancelledAt: serverTimestamp(),\n          cancelReason,\n          updatedAt: serverTimestamp()\n        });\n        alert('Bill Cancelled.');\n        await this.fetchBills();\n        this.closePreview();\n      } catch (err) {\n        console.error('handleCancelConfirm error', err);\n        alert('Error cancelling: ' + err.message);\n      }\n    };\n\n    this.renderCancelDialog = () => /*#__PURE__*/React.createElement(\"div\", {\n      className: \"custom-overlay\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"custom-overlay-content\",\n      style: {\n        width: 420\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }\n    }, \"Cancel Reason\"), /*#__PURE__*/React.createElement(\"textarea\", {\n      className: \"form-control\",\n      rows: 4,\n      value: this.state.cancelReason,\n      onChange: this.handleCancelReasonChange,\n      placeholder: \"Enter reason for cancellation\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"text-right mt-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-secondary mr-2\",\n      onClick: this.closeCancelDialog,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }\n    }, \"Cancel\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-danger\",\n      onClick: this.handleCancelConfirm,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }\n    }, \"Confirm Cancel\"))));\n\n    this.renderTable = () => /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card mt-4 full-height\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      className: \"card-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }\n    }, \"Billing Cancel\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"table-responsive\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"table\", {\n      className: \"table table-bordered table-hover\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      className: \"thead-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 17\n      }\n    }, \"Bill No\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }\n    }, \"Order\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 17\n      }\n    }, \"Customer\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }\n    }, \"Date\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 17\n      }\n    }, \"Value\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 17\n      }\n    }, \"Type\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }\n    }, \"Status\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 13\n      }\n    }, this.state.cobilling.map(c => {\n      let statusClass = \"badge-secondary\";\n      if (c.status === \"Approved\") statusClass = \"badge-success\";else if (c.status === \"Cancelled\") statusClass = \"badge-dark\";\n      const billNo = c.source === 'direct' ? c.invoiceNo || '-' : c.cobillingNo || '-';\n      const date = c.source === 'direct' ? c.invoiceDate || '-' : c.cobillingDate || '-';\n      const value = c.source === 'direct' ? c.invoiceValue || '-' : c.billValue || '-';\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: c.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-link p-0\",\n        onClick: () => this.openPreview(c),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 23\n        }\n      }, billNo)), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 21\n        }\n      }, c.customerOrderId || \"-\"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 21\n        }\n      }, c.customer || \"-\"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }\n      }, date), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 21\n        }\n      }, value), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 21\n        }\n      }, c.source === 'direct' ? \"Direct Billing\" : \"Customer Billing\"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: `badge ${statusClass}`,\n        style: {\n          fontSize: '14px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 23\n        }\n      }, c.status)));\n    }), this.state.cobilling.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      colSpan: \"7\",\n      className: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 21\n      }\n    }, \"No bills available for cancellation\")))))));\n\n    this.renderPreview = () => {\n      const c = this.state.selected;\n      if (!c) return null;\n      const billNo = c.source === 'direct' ? c.invoiceNo || '-' : c.cobillingNo || '-';\n      const date = c.source === 'direct' ? c.invoiceDate || '-' : c.cobillingDate || '-';\n      const value = c.source === 'direct' ? c.invoiceValue || '-' : c.billValue || '-';\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card mt-4 p-4 shadow-sm full-height d-flex flex-column\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"card-title mb-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 9\n        }\n      }, \"Billing Preview - \", billNo), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 37\n        }\n      }, \"Order:\"), \" \", c.customerOrderId || \"-\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 37\n        }\n      }, \"Customer:\"), \" \", c.customer || \"-\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 37\n        }\n      }, \"Date:\"), \" \", date)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 37\n        }\n      }, \"Value:\"), \" \", value), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 37\n        }\n      }, \"Status:\"), \" \", c.status), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 37\n        }\n      }, \"Cancel Reason:\"), \" \", c.cancelReason || \"-\")), /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 9\n        }\n      }, \"Line Items\"), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered table-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        className: \"thead-light\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 15\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 15\n        }\n      }, \"Description\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 15\n        }\n      }, \"Qty\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 15\n        }\n      }, \"Unit Price\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 15\n        }\n      }, \"Item Total\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 11\n        }\n      }, (c.lineItems || []).map((li, i) => /*#__PURE__*/React.createElement(\"tr\", {\n        key: i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 17\n        }\n      }, li.itemCode), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 17\n        }\n      }, li.itemDescription), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 17\n        }\n      }, li.qty), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 17\n        }\n      }, li.unitPrice), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 17\n        }\n      }, li.itemTotal))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mt-auto pt-3 text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-danger mr-2\",\n        onClick: this.openCancelDialog,\n        disabled: c.status === \"Cancelled\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 11\n        }\n      }, \"Cancel\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-secondary\",\n        onClick: this.closePreview,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 11\n        }\n      }, \"Back to List\")), this.state.showCancelDialog && this.renderCancelDialog());\n    };\n  }\n\n  componentDidMount() {\n    this.fetchBills();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container-fluid\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 7\n      }\n    }, this.state.selected ? this.renderPreview() : this.renderTable());\n  }\n\n}\n\nexport default BillingCancel;","map":{"version":3,"sources":["C:/Users/College/admin/StarAdmin-Free-React-Admin-Template-master/template/demo_1/src/app/sales/salestransactions/invoice/BillingCancel.js"],"names":["React","Component","db","collection","getDocs","updateDoc","doc","serverTimestamp","BillingCancel","state","cobilling","selected","loading","showCancelDialog","cancelReason","fetchBills","snapCOB","cobData","docs","map","d","id","data","source","snapINV","invData","cancelable","filter","c","status","setState","err","console","error","alert","message","openPreview","cob","closePreview","openCancelDialog","closeCancelDialog","handleCancelReasonChange","e","target","value","handleCancelConfirm","trim","collectionName","ref","cancelledAt","updatedAt","renderCancelDialog","width","renderTable","statusClass","billNo","invoiceNo","cobillingNo","date","invoiceDate","cobillingDate","invoiceValue","billValue","customerOrderId","customer","fontSize","length","renderPreview","lineItems","li","i","itemCode","itemDescription","qty","unitPrice","itemTotal","componentDidMount","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { db } from '../../../../firebase';\r\nimport { collection, getDocs, updateDoc, doc } from 'firebase/firestore';\r\nimport { serverTimestamp } from 'firebase/firestore';\r\n\r\nclass BillingCancel extends Component {\r\n  state = {\r\n    cobilling: [],\r\n    selected: null,\r\n    loading: false,\r\n    showCancelDialog: false,\r\n    cancelReason: \"\",\r\n  };\r\n\r\n  componentDidMount() { this.fetchBills(); }\r\n\r\n  fetchBills = async () => {\r\n    try {\r\n      const snapCOB = await getDocs(collection(db, 'cobilling'));\r\n      const cobData = snapCOB.docs.map(d => ({ id: d.id, ...d.data(), source: 'cob' }));\r\n      const snapINV = await getDocs(collection(db, 'invoices'));\r\n      const invData = snapINV.docs.map(d => ({ id: d.id, ...d.data(), source: 'direct' }));\r\n      // show bills that can be cancelled (Approved) — mirror approval/amendment flows\r\n      const cancelable = [...cobData, ...invData].filter(c => c.status === 'Approved');\r\n      this.setState({ cobilling: cancelable });\r\n    } catch (err) {\r\n      console.error('fetchBills error', err);\r\n      alert('Error fetching bills: ' + err.message);\r\n    }\r\n  };\r\n\r\n  openPreview = (cob) => {\r\n    this.setState({ selected: cob });\r\n  };\r\n\r\n  closePreview = () => {\r\n    this.setState({ selected: null, showCancelDialog: false, cancelReason: \"\" });\r\n  };\r\n\r\n  openCancelDialog = () => {\r\n    this.setState({ showCancelDialog: true, cancelReason: \"\" });\r\n  };\r\n\r\n  closeCancelDialog = () => {\r\n    this.setState({ showCancelDialog: false, cancelReason: \"\" });\r\n  };\r\n\r\n  handleCancelReasonChange = (e) => {\r\n    this.setState({ cancelReason: e.target.value });\r\n  };\r\n\r\n  handleCancelConfirm = async () => {\r\n    const { selected, cancelReason } = this.state;\r\n    if (!cancelReason.trim()) {\r\n      alert(\"Please enter a reason for cancellation.\");\r\n      return;\r\n    }\r\n    try {\r\n      const collectionName = selected.source === 'direct' ? 'invoices' : 'cobilling';\r\n      const ref = doc(db, collectionName, selected.id);\r\n      await updateDoc(ref, {\r\n        status: 'Cancelled',\r\n        cancelledAt: serverTimestamp(),\r\n        cancelReason,\r\n        updatedAt: serverTimestamp()\r\n      });\r\n\r\n      alert('Bill Cancelled.');\r\n      await this.fetchBills();\r\n      this.closePreview();\r\n    } catch (err) {\r\n      console.error('handleCancelConfirm error', err);\r\n      alert('Error cancelling: ' + err.message);\r\n    }\r\n  };\r\n\r\n  renderCancelDialog = () => (\r\n    <div className=\"custom-overlay\">\r\n      <div className=\"custom-overlay-content\" style={{ width: 420 }}>\r\n        <h5>Cancel Reason</h5>\r\n        <textarea\r\n          className=\"form-control\"\r\n          rows={4}\r\n          value={this.state.cancelReason}\r\n          onChange={this.handleCancelReasonChange}\r\n          placeholder=\"Enter reason for cancellation\"\r\n        />\r\n        <div className=\"text-right mt-3\">\r\n          <button className=\"btn btn-secondary mr-2\" onClick={this.closeCancelDialog}>Cancel</button>\r\n          <button className=\"btn btn-danger\" onClick={this.handleCancelConfirm}>Confirm Cancel</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  renderTable = () => (\r\n    <div className=\"card mt-4 full-height\">\r\n      <div className=\"card-body\">\r\n        <h4 className=\"card-title\">Billing Cancel</h4>\r\n        <div className=\"table-responsive\">\r\n          <table className=\"table table-bordered table-hover\">\r\n            <thead className=\"thead-light\">\r\n              <tr>\r\n                <th>Bill No</th>\r\n                <th>Order</th>\r\n                <th>Customer</th>\r\n                <th>Date</th>\r\n                <th>Value</th>\r\n                <th>Type</th>\r\n                <th>Status</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {this.state.cobilling.map(c => {\r\n                let statusClass = \"badge-secondary\";\r\n                if (c.status === \"Approved\") statusClass = \"badge-success\";\r\n                else if (c.status === \"Cancelled\") statusClass = \"badge-dark\";\r\n                const billNo = c.source === 'direct' ? (c.invoiceNo || '-') : (c.cobillingNo || '-');\r\n                const date = c.source === 'direct' ? (c.invoiceDate || '-') : (c.cobillingDate || '-');\r\n                const value = c.source === 'direct' ? (c.invoiceValue || '-') : (c.billValue || '-');\r\n                return (\r\n                  <tr key={c.id}>\r\n                    <td>\r\n                      <button className=\"btn btn-link p-0\" onClick={() => this.openPreview(c)}>\r\n                        {billNo}\r\n                      </button>\r\n                    </td>\r\n                    <td>{c.customerOrderId || \"-\"}</td>\r\n                    <td>{c.customer || \"-\"}</td>\r\n                    <td>{date}</td>\r\n                    <td>{value}</td>\r\n                    <td>{c.source === 'direct' ? \"Direct Billing\" : \"Customer Billing\"}</td>\r\n                    <td>\r\n                      <label className={`badge ${statusClass}`} style={{ fontSize: '14px' }}>{c.status}</label>\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })}\r\n              {this.state.cobilling.length === 0 && (\r\n                <tr><td colSpan=\"7\" className=\"text-center\">No bills available for cancellation</td></tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  renderPreview = () => {\r\n    const c = this.state.selected;\r\n    if (!c) return null;\r\n    const billNo = c.source === 'direct' ? (c.invoiceNo || '-') : (c.cobillingNo || '-');\r\n    const date = c.source === 'direct' ? (c.invoiceDate || '-') : (c.cobillingDate || '-');\r\n    const value = c.source === 'direct' ? (c.invoiceValue || '-') : (c.billValue || '-');\r\n\r\n    return (\r\n      <div className=\"card mt-4 p-4 shadow-sm full-height d-flex flex-column\">\r\n        <h4 className=\"card-title mb-0\">Billing Preview - {billNo}</h4>\r\n        <div className=\"row mb-3\">\r\n          <div className=\"col-md-4\"><b>Order:</b> {c.customerOrderId || \"-\"}</div>\r\n          <div className=\"col-md-4\"><b>Customer:</b> {c.customer || \"-\"}</div>\r\n          <div className=\"col-md-4\"><b>Date:</b> {date}</div>\r\n        </div>\r\n        <div className=\"row mb-3\">\r\n          <div className=\"col-md-4\"><b>Value:</b> {value}</div>\r\n          <div className=\"col-md-4\"><b>Status:</b> {c.status}</div>\r\n          <div className=\"col-md-4\"><b>Cancel Reason:</b> {c.cancelReason || \"-\"}</div>\r\n        </div>\r\n        <h5 className=\"mt-2\">Line Items</h5>\r\n        <table className=\"table table-bordered table-sm\">\r\n          <thead className=\"thead-light\">\r\n            <tr>\r\n              <th>Item Code</th>\r\n              <th>Description</th>\r\n              <th>Qty</th>\r\n              <th>Unit Price</th>\r\n              <th>Item Total</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {(c.lineItems || []).map((li, i) => (\r\n              <tr key={i}>\r\n                <td>{li.itemCode}</td>\r\n                <td>{li.itemDescription}</td>\r\n                <td>{li.qty}</td>\r\n                <td>{li.unitPrice}</td>\r\n                <td>{li.itemTotal}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n        <div className=\"mt-auto pt-3 text-right\">\r\n          <button\r\n            className=\"btn btn-danger mr-2\"\r\n            onClick={this.openCancelDialog}\r\n            disabled={c.status === \"Cancelled\"}\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            className=\"btn btn-secondary\"\r\n            onClick={this.closePreview}\r\n          >\r\n            Back to List\r\n          </button>\r\n        </div>\r\n        {this.state.showCancelDialog && this.renderCancelDialog()}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"container-fluid\">\r\n        {this.state.selected\r\n          ? this.renderPreview()\r\n          : this.renderTable()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default BillingCancel;\r\n"]},"metadata":{},"sourceType":"module"}