{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\College\\\\admin\\\\StarAdmin-Free-React-Admin-Template-master\\\\template\\\\demo_1\\\\src\\\\app\\\\dashboard\\\\Dashboard.js\";\nimport React, { Component } from \"react\";\nimport { Card, Row, Col, ButtonGroup, Button } from \"react-bootstrap\";\nimport { db } from \"../../firebase\";\nimport { collection, onSnapshot } from \"firebase/firestore\";\nimport { Line, Bar } from \"react-chartjs-2\";\nimport \"chart.js\";\n\nclass Dashboard extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      activities: [],\n      lineData: null,\n      barData: null,\n      filter: \"1M\" // default filter\n\n    };\n\n    this.filterByRange = (activities, range) => {\n      const now = new Date();\n      let cutoff;\n\n      switch (range) {\n        case \"1D\":\n          cutoff = new Date(now.setDate(now.getDate() - 1));\n          break;\n\n        case \"5D\":\n          cutoff = new Date(now.setDate(now.getDate() - 5));\n          break;\n\n        case \"1M\":\n          cutoff = new Date(now.setMonth(now.getMonth() - 1));\n          break;\n\n        case \"1Y\":\n          cutoff = new Date(now.setFullYear(now.getFullYear() - 1));\n          break;\n\n        default:\n          cutoff = new Date(\"2000-01-01\");\n        // all\n      }\n\n      return activities.filter(a => new Date(a.date) >= cutoff);\n    };\n\n    this.buildLineChart = () => {\n      const {\n        activities,\n        filter\n      } = this.state;\n      const filtered = this.filterByRange(activities, filter);\n      const grouped = {};\n      filtered.forEach(a => {\n        const date = a.date;\n        if (!grouped[date]) grouped[date] = {};\n        if (!grouped[date][a.source]) grouped[date][a.source] = 0;\n        grouped[date][a.source]++;\n      });\n      const labels = Object.keys(grouped).sort();\n      const sources = [\"Call\", \"Meeting\", \"Demo\", \"Mail\", \"Whatsapp\"];\n      const datasets = sources.map((src, i) => ({\n        label: src,\n        data: labels.map(d => grouped[d][src] || 0),\n        borderColor: this.getColor(i),\n        backgroundColor: this.getColor(i, 0.2),\n        fill: false,\n        tension: 0.3,\n        borderWidth: 2,\n        pointRadius: 4\n      }));\n      this.setState({\n        lineData: {\n          labels,\n          datasets\n        }\n      });\n    };\n\n    this.buildBarChart = () => {\n      const {\n        activities,\n        filter\n      } = this.state;\n      const filtered = this.filterByRange(activities, filter);\n      const grouped = {\n        Call: 0,\n        Meeting: 0,\n        Demo: 0,\n        Mail: 0,\n        Whatsapp: 0\n      };\n      filtered.forEach(a => {\n        const src = a.source || \"Unknown\";\n        grouped[src] = (grouped[src] || 0) + 1;\n      });\n      const labels = Object.keys(grouped);\n      const data = Object.values(grouped);\n      const dataset = {\n        label: \"Total Activities\",\n        data,\n        backgroundColor: labels.map((_, i) => this.getColor(i, 0.7)),\n        borderRadius: 6\n      };\n      this.setState({\n        barData: {\n          labels,\n          datasets: [dataset]\n        }\n      });\n    };\n\n    this.getColor = (i, alpha = 1) => {\n      const colors = [`rgba(99, 102, 241, ${alpha})`, // Indigo\n      `rgba(34, 197, 94, ${alpha})`, // Green\n      `rgba(239, 68, 68, ${alpha})`, // Red\n      `rgba(234, 179, 8, ${alpha})`, // Yellow\n      `rgba(59, 130, 246, ${alpha})` // Blue\n      ];\n      return colors[i % colors.length];\n    };\n\n    this.getGradient = color => {\n      const canvas = document.createElement(\"canvas\");\n      const ctx = canvas.getContext(\"2d\");\n      const gradient = ctx.createLinearGradient(0, 0, 0, 200);\n      gradient.addColorStop(0, color);\n      gradient.addColorStop(1, \"rgba(255,255,255,0)\");\n      return gradient;\n    };\n  }\n\n  componentDidMount() {\n    onSnapshot(collection(db, \"activities\"), snapshot => {\n      const activities = snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        activities\n      }, () => {\n        this.buildLineChart();\n        this.buildBarChart();\n      });\n    });\n  } // Utility: filter by date range\n\n\n  render() {\n    const {\n      lineData,\n      barData,\n      filter\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container mt-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      className: \"p-3 shadow-sm bg-white border-0 mb-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex justify-content-between align-items-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 21\n      }\n    }, \"Activities by Source over Time\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 21\n      }\n    }, \"Daily count of activities split by source\")), /*#__PURE__*/React.createElement(ButtonGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 17\n      }\n    }, [\"1D\", \"5D\", \"1M\", \"1Y\"].map(f => /*#__PURE__*/React.createElement(Button, {\n      key: f,\n      size: \"sm\",\n      variant: filter === f ? \"primary\" : \"light\",\n      onClick: () => this.setState({\n        filter: f\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 21\n      }\n    }, f)))), lineData && /*#__PURE__*/React.createElement(Line, {\n      data: lineData,\n      options: {\n        responsive: true,\n        plugins: {\n          legend: {\n            position: \"top\"\n          },\n          tooltip: {\n            mode: \"index\",\n            intersect: false,\n            backgroundColor: \"#111827\",\n            titleColor: \"#fff\",\n            bodyColor: \"#fff\"\n          }\n        },\n        interaction: {\n          mode: \"nearest\",\n          axis: \"x\",\n          intersect: false\n        },\n        scales: {\n          x: {\n            grid: {\n              display: false\n            }\n          },\n          y: {\n            beginAtZero: true,\n            grid: {\n              color: \"#f3f4f6\"\n            }\n          }\n        }\n      },\n      height: 100,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 17\n      }\n    }))), /*#__PURE__*/React.createElement(Col, {\n      md: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      className: \"p-3 shadow-sm bg-white border-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 17\n      }\n    }, \"Total Activities by Source\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 15\n      }\n    }, \"How many times each source was used\"), barData && /*#__PURE__*/React.createElement(Bar, {\n      data: barData,\n      options: {\n        responsive: true,\n        plugins: {\n          legend: {\n            position: \"top\"\n          },\n          tooltip: {\n            callbacks: {\n              label: ctx => `$${ctx.raw} USD`\n            }\n          }\n        },\n        scales: {\n          x: {\n            stacked: true,\n            grid: {\n              display: false\n            }\n          },\n          y: {\n            stacked: true,\n            beginAtZero: true\n          }\n        }\n      },\n      height: 100,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 17\n      }\n    })))));\n  }\n\n}\n\nexport default Dashboard;","map":{"version":3,"sources":["C:/Users/College/admin/StarAdmin-Free-React-Admin-Template-master/template/demo_1/src/app/dashboard/Dashboard.js"],"names":["React","Component","Card","Row","Col","ButtonGroup","Button","db","collection","onSnapshot","Line","Bar","Dashboard","state","activities","lineData","barData","filter","filterByRange","range","now","Date","cutoff","setDate","getDate","setMonth","getMonth","setFullYear","getFullYear","a","date","buildLineChart","filtered","grouped","forEach","source","labels","Object","keys","sort","sources","datasets","map","src","i","label","data","d","borderColor","getColor","backgroundColor","fill","tension","borderWidth","pointRadius","setState","buildBarChart","Call","Meeting","Demo","Mail","Whatsapp","values","dataset","_","borderRadius","alpha","colors","length","getGradient","color","canvas","document","createElement","ctx","getContext","gradient","createLinearGradient","addColorStop","componentDidMount","snapshot","docs","doc","id","render","f","responsive","plugins","legend","position","tooltip","mode","intersect","titleColor","bodyColor","interaction","axis","scales","x","grid","display","y","beginAtZero","callbacks","raw","stacked"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,IAAT,EAAeC,GAAf,EAAoBC,GAApB,EAAyBC,WAAzB,EAAsCC,MAAtC,QAAoD,iBAApD;AACA,SAASC,EAAT,QAAmB,gBAAnB;AACA,SAASC,UAAT,EAAqBC,UAArB,QAAuC,oBAAvC;AACA,SAASC,IAAT,EAAeC,GAAf,QAA0B,iBAA1B;AACA,OAAO,UAAP;;AAEA,MAAMC,SAAN,SAAwBX,SAAxB,CAAkC;AAAA;AAAA;AAAA,SAChCY,KADgC,GACxB;AACNC,MAAAA,UAAU,EAAE,EADN;AAENC,MAAAA,QAAQ,EAAE,IAFJ;AAGNC,MAAAA,OAAO,EAAE,IAHH;AAINC,MAAAA,MAAM,EAAE,IAJF,CAIQ;;AAJR,KADwB;;AAAA,SAsBhCC,aAtBgC,GAsBhB,CAACJ,UAAD,EAAaK,KAAb,KAAuB;AACrC,YAAMC,GAAG,GAAG,IAAIC,IAAJ,EAAZ;AACA,UAAIC,MAAJ;;AAEA,cAAQH,KAAR;AACE,aAAK,IAAL;AACEG,UAAAA,MAAM,GAAG,IAAID,IAAJ,CAASD,GAAG,CAACG,OAAJ,CAAYH,GAAG,CAACI,OAAJ,KAAgB,CAA5B,CAAT,CAAT;AACA;;AACF,aAAK,IAAL;AACEF,UAAAA,MAAM,GAAG,IAAID,IAAJ,CAASD,GAAG,CAACG,OAAJ,CAAYH,GAAG,CAACI,OAAJ,KAAgB,CAA5B,CAAT,CAAT;AACA;;AACF,aAAK,IAAL;AACEF,UAAAA,MAAM,GAAG,IAAID,IAAJ,CAASD,GAAG,CAACK,QAAJ,CAAaL,GAAG,CAACM,QAAJ,KAAiB,CAA9B,CAAT,CAAT;AACA;;AACF,aAAK,IAAL;AACEJ,UAAAA,MAAM,GAAG,IAAID,IAAJ,CAASD,GAAG,CAACO,WAAJ,CAAgBP,GAAG,CAACQ,WAAJ,KAAoB,CAApC,CAAT,CAAT;AACA;;AACF;AACEN,UAAAA,MAAM,GAAG,IAAID,IAAJ,CAAS,YAAT,CAAT;AAAiC;AAdrC;;AAiBA,aAAOP,UAAU,CAACG,MAAX,CAAmBY,CAAD,IAAO,IAAIR,IAAJ,CAASQ,CAAC,CAACC,IAAX,KAAoBR,MAA7C,CAAP;AACD,KA5C+B;;AAAA,SA8ChCS,cA9CgC,GA8Cf,MAAM;AACrB,YAAM;AAAEjB,QAAAA,UAAF;AAAcG,QAAAA;AAAd,UAAyB,KAAKJ,KAApC;AACA,YAAMmB,QAAQ,GAAG,KAAKd,aAAL,CAAmBJ,UAAnB,EAA+BG,MAA/B,CAAjB;AAEA,YAAMgB,OAAO,GAAG,EAAhB;AACAD,MAAAA,QAAQ,CAACE,OAAT,CAAkBL,CAAD,IAAO;AACtB,cAAMC,IAAI,GAAGD,CAAC,CAACC,IAAf;AACA,YAAI,CAACG,OAAO,CAACH,IAAD,CAAZ,EAAoBG,OAAO,CAACH,IAAD,CAAP,GAAgB,EAAhB;AACpB,YAAI,CAACG,OAAO,CAACH,IAAD,CAAP,CAAcD,CAAC,CAACM,MAAhB,CAAL,EAA8BF,OAAO,CAACH,IAAD,CAAP,CAAcD,CAAC,CAACM,MAAhB,IAA0B,CAA1B;AAC9BF,QAAAA,OAAO,CAACH,IAAD,CAAP,CAAcD,CAAC,CAACM,MAAhB;AACD,OALD;AAOA,YAAMC,MAAM,GAAGC,MAAM,CAACC,IAAP,CAAYL,OAAZ,EAAqBM,IAArB,EAAf;AACA,YAAMC,OAAO,GAAG,CAAC,MAAD,EAAS,SAAT,EAAoB,MAApB,EAA4B,MAA5B,EAAoC,UAApC,CAAhB;AAEA,YAAMC,QAAQ,GAAGD,OAAO,CAACE,GAAR,CAAY,CAACC,GAAD,EAAMC,CAAN,MAAa;AACxCC,QAAAA,KAAK,EAAEF,GADiC;AAExCG,QAAAA,IAAI,EAAEV,MAAM,CAACM,GAAP,CAAYK,CAAD,IAAOd,OAAO,CAACc,CAAD,CAAP,CAAWJ,GAAX,KAAmB,CAArC,CAFkC;AAGxCK,QAAAA,WAAW,EAAE,KAAKC,QAAL,CAAcL,CAAd,CAH2B;AAIxCM,QAAAA,eAAe,EAAE,KAAKD,QAAL,CAAcL,CAAd,EAAiB,GAAjB,CAJuB;AAKxCO,QAAAA,IAAI,EAAE,KALkC;AAMxCC,QAAAA,OAAO,EAAE,GAN+B;AAOxCC,QAAAA,WAAW,EAAE,CAP2B;AAQxCC,QAAAA,WAAW,EAAE;AAR2B,OAAb,CAAZ,CAAjB;AAWA,WAAKC,QAAL,CAAc;AAAExC,QAAAA,QAAQ,EAAE;AAAEqB,UAAAA,MAAF;AAAUK,UAAAA;AAAV;AAAZ,OAAd;AACD,KAzE+B;;AAAA,SA6E/Be,aA7E+B,GA6Ef,MAAM;AACrB,YAAM;AAAE1C,QAAAA,UAAF;AAAcG,QAAAA;AAAd,UAAyB,KAAKJ,KAApC;AACA,YAAMmB,QAAQ,GAAG,KAAKd,aAAL,CAAmBJ,UAAnB,EAA+BG,MAA/B,CAAjB;AAEA,YAAMgB,OAAO,GAAG;AAAEwB,QAAAA,IAAI,EAAE,CAAR;AAAWC,QAAAA,OAAO,EAAE,CAApB;AAAuBC,QAAAA,IAAI,EAAE,CAA7B;AAAgCC,QAAAA,IAAI,EAAE,CAAtC;AAAyCC,QAAAA,QAAQ,EAAE;AAAnD,OAAhB;AACA7B,MAAAA,QAAQ,CAACE,OAAT,CAAkBL,CAAD,IAAO;AACtB,cAAMc,GAAG,GAAGd,CAAC,CAACM,MAAF,IAAY,SAAxB;AACAF,QAAAA,OAAO,CAACU,GAAD,CAAP,GAAe,CAACV,OAAO,CAACU,GAAD,CAAP,IAAgB,CAAjB,IAAsB,CAArC;AACD,OAHD;AAKA,YAAMP,MAAM,GAAGC,MAAM,CAACC,IAAP,CAAYL,OAAZ,CAAf;AACA,YAAMa,IAAI,GAAGT,MAAM,CAACyB,MAAP,CAAc7B,OAAd,CAAb;AAEA,YAAM8B,OAAO,GAAG;AACdlB,QAAAA,KAAK,EAAE,kBADO;AAEdC,QAAAA,IAFc;AAGdI,QAAAA,eAAe,EAAEd,MAAM,CAACM,GAAP,CAAW,CAACsB,CAAD,EAAIpB,CAAJ,KAAU,KAAKK,QAAL,CAAcL,CAAd,EAAiB,GAAjB,CAArB,CAHH;AAIdqB,QAAAA,YAAY,EAAE;AAJA,OAAhB;AAOA,WAAKV,QAAL,CAAc;AACZvC,QAAAA,OAAO,EAAE;AAAEoB,UAAAA,MAAF;AAAUK,UAAAA,QAAQ,EAAE,CAACsB,OAAD;AAApB;AADG,OAAd;AAGD,KApG+B;;AAAA,SAuGhCd,QAvGgC,GAuGrB,CAACL,CAAD,EAAIsB,KAAK,GAAG,CAAZ,KAAkB;AAC3B,YAAMC,MAAM,GAAG,CACZ,sBAAqBD,KAAM,GADf,EACmB;AAC/B,2BAAoBA,KAAM,GAFd,EAEmB;AAC/B,2BAAoBA,KAAM,GAHd,EAGmB;AAC/B,2BAAoBA,KAAM,GAJd,EAImB;AAC/B,4BAAqBA,KAAM,GALf,CAKmB;AALnB,OAAf;AAOA,aAAOC,MAAM,CAACvB,CAAC,GAAGuB,MAAM,CAACC,MAAZ,CAAb;AACD,KAhH+B;;AAAA,SAkHhCC,WAlHgC,GAkHjBC,KAAD,IAAW;AACvB,YAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACA,YAAMC,GAAG,GAAGH,MAAM,CAACI,UAAP,CAAkB,IAAlB,CAAZ;AACA,YAAMC,QAAQ,GAAGF,GAAG,CAACG,oBAAJ,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,GAAlC,CAAjB;AACAD,MAAAA,QAAQ,CAACE,YAAT,CAAsB,CAAtB,EAAyBR,KAAzB;AACAM,MAAAA,QAAQ,CAACE,YAAT,CAAsB,CAAtB,EAAyB,qBAAzB;AACA,aAAOF,QAAP;AACD,KAzH+B;AAAA;;AAQhCG,EAAAA,iBAAiB,GAAG;AAClBtE,IAAAA,UAAU,CAACD,UAAU,CAACD,EAAD,EAAK,YAAL,CAAX,EAAgCyE,QAAD,IAAc;AACrD,YAAMlE,UAAU,GAAGkE,QAAQ,CAACC,IAAT,CAAcvC,GAAd,CAAmBwC,GAAD,KAAU;AAC7CC,QAAAA,EAAE,EAAED,GAAG,CAACC,EADqC;AAE7C,WAAGD,GAAG,CAACpC,IAAJ;AAF0C,OAAV,CAAlB,CAAnB;AAIA,WAAKS,QAAL,CAAc;AAAEzC,QAAAA;AAAF,OAAd,EAA8B,MAAM;AAClC,aAAKiB,cAAL;AACA,aAAKyB,aAAL;AACD,OAHD;AAID,KATS,CAAV;AAUD,GAnB+B,CAqBhC;;;AAsGA4B,EAAAA,MAAM,GAAG;AACP,UAAM;AAAErE,MAAAA,QAAF;AAAYC,MAAAA,OAAZ;AAAqBC,MAAAA;AAArB,QAAgC,KAAKJ,KAA3C;AAEA,wBACE;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,GAAD;AAAK,MAAA,EAAE,EAAE,EAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAC,sCAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,mDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCADJ,eAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mDAFJ,CADF,eAKE,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmB,IAAnB,EAAyB6B,GAAzB,CAA8B2C,CAAD,iBAC5B,oBAAC,MAAD;AACE,MAAA,GAAG,EAAEA,CADP;AAEE,MAAA,IAAI,EAAC,IAFP;AAGE,MAAA,OAAO,EAAEpE,MAAM,KAAKoE,CAAX,GAAe,SAAf,GAA2B,OAHtC;AAIE,MAAA,OAAO,EAAE,MAAM,KAAK9B,QAAL,CAAc;AAAEtC,QAAAA,MAAM,EAAEoE;AAAV,OAAd,CAJjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAMGA,CANH,CADD,CADH,CALF,CADF,EAoBGtE,QAAQ,iBACP,oBAAC,IAAD;AACE,MAAA,IAAI,EAAEA,QADR;AAEE,MAAA,OAAO,EAAE;AACPuE,QAAAA,UAAU,EAAE,IADL;AAEPC,QAAAA,OAAO,EAAE;AACPC,UAAAA,MAAM,EAAE;AAAEC,YAAAA,QAAQ,EAAE;AAAZ,WADD;AAEPC,UAAAA,OAAO,EAAE;AACPC,YAAAA,IAAI,EAAE,OADC;AAEPC,YAAAA,SAAS,EAAE,KAFJ;AAGP1C,YAAAA,eAAe,EAAE,SAHV;AAIP2C,YAAAA,UAAU,EAAE,MAJL;AAKPC,YAAAA,SAAS,EAAE;AALJ;AAFF,SAFF;AAYPC,QAAAA,WAAW,EAAE;AAAEJ,UAAAA,IAAI,EAAE,SAAR;AAAmBK,UAAAA,IAAI,EAAE,GAAzB;AAA8BJ,UAAAA,SAAS,EAAE;AAAzC,SAZN;AAaPK,QAAAA,MAAM,EAAE;AACNC,UAAAA,CAAC,EAAE;AAAEC,YAAAA,IAAI,EAAE;AAAEC,cAAAA,OAAO,EAAE;AAAX;AAAR,WADG;AAENC,UAAAA,CAAC,EAAE;AAAEC,YAAAA,WAAW,EAAE,IAAf;AAAqBH,YAAAA,IAAI,EAAE;AAAE7B,cAAAA,KAAK,EAAE;AAAT;AAA3B;AAFG;AAbD,OAFX;AAoBE,MAAA,MAAM,EAAE,GApBV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MArBJ,CADF,CADF,eAiDE,oBAAC,GAAD;AAAK,MAAA,EAAE,EAAE,EAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAC,iCAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCADJ,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6CAFF,EAGGtD,OAAO,iBACN,oBAAC,GAAD;AACE,MAAA,IAAI,EAAEA,OADR;AAEE,MAAA,OAAO,EAAE;AACPsE,QAAAA,UAAU,EAAE,IADL;AAEPC,QAAAA,OAAO,EAAE;AACPC,UAAAA,MAAM,EAAE;AAAEC,YAAAA,QAAQ,EAAE;AAAZ,WADD;AAEPC,UAAAA,OAAO,EAAE;AACPa,YAAAA,SAAS,EAAE;AACT1D,cAAAA,KAAK,EAAG6B,GAAD,IAAU,IAAGA,GAAG,CAAC8B,GAAI;AADnB;AADJ;AAFF,SAFF;AAUPP,QAAAA,MAAM,EAAE;AACNC,UAAAA,CAAC,EAAE;AAAEO,YAAAA,OAAO,EAAE,IAAX;AAAiBN,YAAAA,IAAI,EAAE;AAAEC,cAAAA,OAAO,EAAE;AAAX;AAAvB,WADG;AAENC,UAAAA,CAAC,EAAE;AAAEI,YAAAA,OAAO,EAAE,IAAX;AAAiBH,YAAAA,WAAW,EAAE;AAA9B;AAFG;AAVD,OAFX;AAiBE,MAAA,MAAM,EAAE,GAjBV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJJ,CADF,CAjDF,CADF,CADF;AAiFD;;AA/M+B;;AAkNlC,eAAe1F,SAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { Card, Row, Col, ButtonGroup, Button } from \"react-bootstrap\";\nimport { db } from \"../../firebase\";\nimport { collection, onSnapshot } from \"firebase/firestore\";\nimport { Line, Bar } from \"react-chartjs-2\";\nimport \"chart.js\";\n\nclass Dashboard extends Component {\n  state = {\n    activities: [],\n    lineData: null,\n    barData: null,\n    filter: \"1M\", // default filter\n  };\n\n  componentDidMount() {\n    onSnapshot(collection(db, \"activities\"), (snapshot) => {\n      const activities = snapshot.docs.map((doc) => ({\n        id: doc.id,\n        ...doc.data(),\n      }));\n      this.setState({ activities }, () => {\n        this.buildLineChart();\n        this.buildBarChart();\n      });\n    });\n  }\n\n  // Utility: filter by date range\n  filterByRange = (activities, range) => {\n    const now = new Date();\n    let cutoff;\n\n    switch (range) {\n      case \"1D\":\n        cutoff = new Date(now.setDate(now.getDate() - 1));\n        break;\n      case \"5D\":\n        cutoff = new Date(now.setDate(now.getDate() - 5));\n        break;\n      case \"1M\":\n        cutoff = new Date(now.setMonth(now.getMonth() - 1));\n        break;\n      case \"1Y\":\n        cutoff = new Date(now.setFullYear(now.getFullYear() - 1));\n        break;\n      default:\n        cutoff = new Date(\"2000-01-01\"); // all\n    }\n\n    return activities.filter((a) => new Date(a.date) >= cutoff);\n  };\n\n  buildLineChart = () => {\n    const { activities, filter } = this.state;\n    const filtered = this.filterByRange(activities, filter);\n\n    const grouped = {};\n    filtered.forEach((a) => {\n      const date = a.date;\n      if (!grouped[date]) grouped[date] = {};\n      if (!grouped[date][a.source]) grouped[date][a.source] = 0;\n      grouped[date][a.source]++;\n    });\n\n    const labels = Object.keys(grouped).sort();\n    const sources = [\"Call\", \"Meeting\", \"Demo\", \"Mail\", \"Whatsapp\"];\n\n    const datasets = sources.map((src, i) => ({\n      label: src,\n      data: labels.map((d) => grouped[d][src] || 0),\n      borderColor: this.getColor(i),\n      backgroundColor: this.getColor(i, 0.2),\n      fill: false,\n      tension: 0.3,\n      borderWidth: 2,\n      pointRadius: 4,\n    }));\n\n    this.setState({ lineData: { labels, datasets } });\n  };\n\n  \n\n   buildBarChart = () => {\n    const { activities, filter } = this.state;\n    const filtered = this.filterByRange(activities, filter);\n\n    const grouped = { Call: 0, Meeting: 0, Demo: 0, Mail: 0, Whatsapp: 0 };\n    filtered.forEach((a) => {\n      const src = a.source || \"Unknown\";\n      grouped[src] = (grouped[src] || 0) + 1;\n    });\n\n    const labels = Object.keys(grouped);\n    const data = Object.values(grouped);\n\n    const dataset = {\n      label: \"Total Activities\",\n      data,\n      backgroundColor: labels.map((_, i) => this.getColor(i, 0.7)),\n      borderRadius: 6,\n    };\n\n    this.setState({\n      barData: { labels, datasets: [dataset] },\n    });\n  };\n\n\n  getColor = (i, alpha = 1) => {\n    const colors = [\n      `rgba(99, 102, 241, ${alpha})`, // Indigo\n      `rgba(34, 197, 94, ${alpha})`,  // Green\n      `rgba(239, 68, 68, ${alpha})`,  // Red\n      `rgba(234, 179, 8, ${alpha})`,  // Yellow\n      `rgba(59, 130, 246, ${alpha})`, // Blue\n    ];\n    return colors[i % colors.length];\n  };\n\n  getGradient = (color) => {\n    const canvas = document.createElement(\"canvas\");\n    const ctx = canvas.getContext(\"2d\");\n    const gradient = ctx.createLinearGradient(0, 0, 0, 200);\n    gradient.addColorStop(0, color);\n    gradient.addColorStop(1, \"rgba(255,255,255,0)\");\n    return gradient;\n  };\n\n  render() {\n    const { lineData, barData, filter } = this.state;\n\n    return (\n      <div className=\"container mt-4\">\n        <Row>\n          <Col md={12}>\n            <Card className=\"p-3 shadow-sm bg-white border-0 mb-4\">\n              <div className=\"d-flex justify-content-between align-items-center\">\n                <div>\n                    <h5>Activities by Source over Time</h5>\n                    <p>Daily count of activities split by source</p>\n                </div>\n                <ButtonGroup>\n                  {[\"1D\", \"5D\", \"1M\", \"1Y\"].map((f) => (\n                    <Button\n                      key={f}\n                      size=\"sm\"\n                      variant={filter === f ? \"primary\" : \"light\"}\n                      onClick={() => this.setState({ filter: f })}\n                    >\n                      {f}\n                    </Button>\n                  ))}\n                </ButtonGroup>\n              </div>\n\n              {lineData && (\n                <Line\n                  data={lineData}\n                  options={{\n                    responsive: true,\n                    plugins: {\n                      legend: { position: \"top\" },\n                      tooltip: {\n                        mode: \"index\",\n                        intersect: false,\n                        backgroundColor: \"#111827\",\n                        titleColor: \"#fff\",\n                        bodyColor: \"#fff\",\n                      },\n                    },\n                    interaction: { mode: \"nearest\", axis: \"x\", intersect: false },\n                    scales: {\n                      x: { grid: { display: false } },\n                      y: { beginAtZero: true, grid: { color: \"#f3f4f6\" } },\n                    },\n                  }}\n                  height={100}\n                />\n              )}\n            </Card>\n          </Col>\n\n          <Col md={12}>\n            <Card className=\"p-3 shadow-sm bg-white border-0\">\n                <h5>Total Activities by Source</h5>\n              <p>How many times each source was used</p>\n              {barData && (\n                <Bar\n                  data={barData}\n                  options={{\n                    responsive: true,\n                    plugins: {\n                      legend: { position: \"top\" },\n                      tooltip: {\n                        callbacks: {\n                          label: (ctx) => `$${ctx.raw} USD`,\n                        },\n                      },\n                    },\n                    scales: {\n                      x: { stacked: true, grid: { display: false } },\n                      y: { stacked: true, beginAtZero: true },\n                    },\n                  }}\n                  height={100}\n                />\n              )}\n            </Card>\n          </Col>\n        </Row>\n      </div>\n    );\n  }\n}\n\nexport default Dashboard;\n"]},"metadata":{},"sourceType":"module"}