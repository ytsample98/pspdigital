{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\College\\\\admin\\\\StarAdmin-Free-React-Admin-Template-master\\\\template\\\\demo_1\\\\src\\\\app\\\\crm\\\\Activity.js\";\n// Activity.js (updated)\n// React 16+ style, using react-bootstrap and firebase/firestore\nimport React, { Component } from \"react\";\nimport { Table, Button, Form, Card, InputGroup, Modal, Row, Col } from \"react-bootstrap\";\nimport { db } from \"../../firebase\";\nimport { collection, getDocs, addDoc, deleteDoc, doc, updateDoc } from \"firebase/firestore\";\n\nclass Activity extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      activities: [],\n      accounts: [],\n      contactOptions: [],\n      // modal control\n      showModal: false,\n      modalMode: \"new\",\n      // 'new' or 'edit'\n      // selected row id (for radio select)\n      selectedId: null,\n      // form used in modal (for both new and edit)\n      form: {\n        acname: \"\",\n        contact: \"\",\n        phone: \"\",\n        email: \"\",\n        source: \"\",\n        remarks: \"\",\n        date: new Date().toISOString().split(\"T\")[0]\n      },\n      // pagination + search\n      searchQuery: \"\",\n      currentPage: 1,\n      pageSize: 10\n    };\n\n    this.fetchActivities = async () => {\n      const snap = await getDocs(collection(db, \"activities\"));\n      const activities = snap.docs.map((docSnap, idx) => ({\n        id: docSnap.id,\n        no: idx + 1,\n        ...docSnap.data()\n      }));\n      this.setState({\n        activities\n      });\n    };\n\n    this.fetchAccounts = async () => {\n      const snap = await getDocs(collection(db, \"accounts\")); // sort alphabetically by acname for datalist\n\n      const accounts = snap.docs.map(d => ({\n        id: d.id,\n        ...d.data()\n      })).sort((a, b) => {\n        if (!a.acname) return 1;\n        if (!b.acname) return -1;\n        return a.acname.localeCompare(b.acname);\n      });\n      this.setState({\n        accounts\n      });\n    };\n\n    this.handleSelectRow = id => {\n      this.setState({\n        selectedId: id\n      });\n    };\n\n    this.openModal = mode => {\n      if (mode === \"edit\") {\n        const {\n          selectedId,\n          activities\n        } = this.state;\n        if (!selectedId) return; // edit requires selection\n\n        const activity = activities.find(a => a.id === selectedId);\n        if (!activity) return; // prepare contactOptions for the selected account\n\n        const account = this.state.accounts.find(acc => acc.acname === activity.acname);\n        let contactOptions = [];\n\n        if (account) {\n          if (account.contact) {\n            contactOptions.push({\n              name: account.contact,\n              designation: \"Main\",\n              phone: account.phone || \"\",\n              email: account.email || \"\"\n            });\n          }\n\n          if (account.contactPersons && account.contactPersons.length > 0) {\n            contactOptions = contactOptions.concat(account.contactPersons);\n          }\n        }\n\n        this.setState({\n          modalMode: \"edit\",\n          showModal: true,\n          form: {\n            acname: activity.acname || \"\",\n            contact: activity.contact || \"\",\n            phone: activity.phone || \"\",\n            email: activity.email || \"\",\n            source: activity.source || \"\",\n            remarks: activity.remarks || \"\",\n            date: activity.date || new Date().toISOString().split(\"T\")[0]\n          },\n          contactOptions\n        });\n      } else {\n        // new\n        this.setState({\n          modalMode: \"new\",\n          showModal: true,\n          form: {\n            acname: \"\",\n            contact: \"\",\n            phone: \"\",\n            email: \"\",\n            source: \"\",\n            remarks: \"\",\n            date: new Date().toISOString().split(\"T\")[0]\n          },\n          contactOptions: []\n        });\n      }\n    };\n\n    this.closeModal = () => {\n      this.setState({\n        showModal: false\n      });\n    };\n\n    this.handleFormChange = (field, value) => {\n      let updatedForm = { ...this.state.form,\n        [field]: value\n      };\n\n      if (field === \"acname\") {\n        // find account by name and populate contactOptions\n        const acc = this.state.accounts.find(a => a.acname === value);\n        let contactOptions = [];\n\n        if (acc) {\n          if (acc.contact) {\n            contactOptions.push({\n              name: acc.contact,\n              designation: \"Main\",\n              phone: acc.phone || \"\",\n              email: acc.email || \"\"\n            });\n          }\n\n          if (acc.contactPersons && acc.contactPersons.length > 0) {\n            contactOptions = contactOptions.concat(acc.contactPersons);\n          }\n        }\n\n        updatedForm.contact = \"\";\n        updatedForm.phone = \"\";\n        updatedForm.email = \"\";\n        this.setState({\n          contactOptions,\n          form: updatedForm\n        });\n        return;\n      }\n\n      if (field === \"contact\") {\n        const cp = this.state.contactOptions.find(c => c.name === value);\n\n        if (cp) {\n          updatedForm.phone = cp.phone || \"\";\n          updatedForm.email = cp.email || \"\";\n        } else {\n          updatedForm.phone = \"\";\n          updatedForm.email = \"\";\n        }\n      }\n\n      if (field === \"remarks\") {\n        if (value.length > 500) {\n          // ignore extra input beyond 500\n          return;\n        }\n      }\n\n      this.setState({\n        form: updatedForm\n      });\n    };\n\n    this.handleSave = async () => {\n      const {\n        modalMode,\n        form,\n        selectedId\n      } = this.state; // basic validation\n\n      if (!form.acname) {\n        alert(\"Please select Account Name.\");\n        return;\n      }\n\n      if (!form.contact) {\n        alert(\"Please select Contact Person.\");\n        return;\n      }\n\n      if (modalMode === \"new\") {\n        await addDoc(collection(db, \"activities\"), form);\n      } else {\n        // update\n        const ref = doc(db, \"activities\", selectedId);\n        await updateDoc(ref, form);\n      } // refresh & close\n\n\n      await this.fetchActivities();\n      this.closeModal();\n    };\n\n    this.deleteSelected = async () => {\n      const {\n        selectedId\n      } = this.state;\n      if (!selectedId) return;\n      if (!window.confirm(\"Delete selected entry?\")) return;\n      await deleteDoc(doc(db, \"activities\", selectedId));\n      this.setState({\n        selectedId: null\n      });\n      this.fetchActivities();\n    };\n\n    this.handleSearch = e => {\n      this.setState({\n        searchQuery: e.target.value,\n        currentPage: 1\n      });\n    };\n\n    this.handlePageChange = page => {\n      this.setState({\n        currentPage: page\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.fetchActivities();\n    this.fetchAccounts();\n  } // fetch activity logs\n\n\n  render() {\n    const {\n      activities,\n      accounts,\n      contactOptions,\n      showModal,\n      modalMode,\n      form,\n      selectedId,\n      searchQuery,\n      currentPage,\n      pageSize\n    } = this.state; // --- Filter activities ---\n\n    const filtered = activities.filter(a => {\n      var _a$acname, _a$contact;\n\n      return ((_a$acname = a.acname) === null || _a$acname === void 0 ? void 0 : _a$acname.toLowerCase().includes(searchQuery.toLowerCase())) || ((_a$contact = a.contact) === null || _a$contact === void 0 ? void 0 : _a$contact.toLowerCase().includes(searchQuery.toLowerCase())) || (a.remarks || \"\").toLowerCase().includes(searchQuery.toLowerCase());\n    }); // --- Pagination logic ---\n\n    const startIndex = (currentPage - 1) * pageSize;\n    const paginated = filtered.slice(startIndex, startIndex + pageSize);\n    const totalPages = Math.max(1, Math.ceil(filtered.length / pageSize));\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container-fluid mt-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      className: \"p-3 shadow-sm bg-white border-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mb-6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 11\n      }\n    }, \"Activities\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex align-items-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        flex: \"0 0 50%\",\n        maxWidth: \"50%\",\n        marginRight: \"10px\"\n      },\n      className: \"me-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(InputGroup, {\n      style: {\n        minWidth: 300\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Form.Control, {\n      type: \"text\",\n      placeholder: \"Search by account, contact, remarks...\",\n      value: searchQuery,\n      onChange: this.handleSearch,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 17\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex \",\n      style: {\n        gap: \"10px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"secondary\",\n      onClick: () => this.openModal(\"new\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 15\n      }\n    }, \"New\"), /*#__PURE__*/React.createElement(Button, {\n      variant: \"secondary\",\n      onClick: () => this.openModal(\"edit\"),\n      disabled: !selectedId,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 15\n      }\n    }, \"Edit\"), /*#__PURE__*/React.createElement(Button, {\n      variant: \"secondary\",\n      onClick: this.deleteSelected,\n      disabled: !selectedId,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 15\n      }\n    }, \"Delete\")))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"table-responsive\",\n      style: {\n        marginTop: \"10px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Table, {\n      bordered: true,\n      hover: true,\n      className: \"w-100\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      className: \"thead-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      style: {\n        width: 40\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 19\n      }\n    }, \"Created Date\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 19\n      }\n    }, \"Account Name\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 19\n      }\n    }, \"Contact Person\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 19\n      }\n    }, \"Phone\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 19\n      }\n    }, \"Mail\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 19\n      }\n    }, \"Source\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 19\n      }\n    }, \"Remarks\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 15\n      }\n    }, paginated.map(act => /*#__PURE__*/React.createElement(\"tr\", {\n      key: act.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      className: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Form.Check, {\n      type: \"radio\",\n      name: \"selectedRow\",\n      checked: selectedId === act.id,\n      onChange: () => this.handleSelectRow(act.id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 23\n      }\n    })), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 21\n      }\n    }, act.date), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 21\n      }\n    }, act.acname), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 21\n      }\n    }, act.contact), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 21\n      }\n    }, act.phone), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 21\n      }\n    }, act.email), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 21\n      }\n    }, act.source), /*#__PURE__*/React.createElement(\"td\", {\n      style: {\n        maxWidth: \"300px\",\n        whiteSpace: \"pre-wrap\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 21\n      }\n    }, act.remarks)))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex justify-content-between align-items-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 13\n      }\n    }, \"Showing \", filtered.length === 0 ? 0 : startIndex + 1, \"\\u2013\", Math.min(startIndex + pageSize, filtered.length), \" of \", filtered.length), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"outline-secondary\",\n      size: \"sm\",\n      disabled: currentPage === 1,\n      onClick: () => this.handlePageChange(currentPage - 1),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 15\n      }\n    }, \"<<\"), \" \", /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 15\n      }\n    }, \"Page \", currentPage, \" of \", totalPages), \" \", /*#__PURE__*/React.createElement(Button, {\n      variant: \"outline-secondary\",\n      size: \"sm\",\n      disabled: currentPage === totalPages,\n      onClick: () => this.handlePageChange(currentPage + 1),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 15\n      }\n    }, \">>\")))), /*#__PURE__*/React.createElement(Modal, {\n      show: showModal,\n      onHide: this.closeModal,\n      centered: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 385,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Modal.Header, {\n      closeButton: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Modal.Title, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 13\n      }\n    }, modalMode === \"new\" ? \"New Entry\" : \"Edit Entry\")), /*#__PURE__*/React.createElement(Modal.Body, {\n      classname: \"bg-white\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Form, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Form.Group, {\n      controlId: \"formDate\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Form.Label, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 21\n      }\n    }, \"Created Date\"), /*#__PURE__*/React.createElement(Form.Control, {\n      type: \"date\",\n      value: form.date,\n      onChange: e => this.handleFormChange(\"date\", e.target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(Col, {\n      md: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Form.Group, {\n      controlId: \"formSource\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Form.Label, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 21\n      }\n    }, \"Source\"), /*#__PURE__*/React.createElement(Form.Control, {\n      as: \"select\",\n      value: form.source,\n      onChange: e => this.handleFormChange(\"source\", e.target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      value: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 23\n      }\n    }, \"Select Source\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"Call\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 23\n      }\n    }, \"Call\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"Meeting\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 23\n      }\n    }, \"Meeting\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"Demo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 414,\n        columnNumber: 23\n      }\n    }, \"Demo\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"Mail\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 23\n      }\n    }, \"Mail\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"Whatsapp\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 416,\n        columnNumber: 23\n      }\n    }, \"Whatsapp\"))))), /*#__PURE__*/React.createElement(Row, {\n      className: \"mt-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Form.Group, {\n      controlId: \"formAccount\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Form.Label, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 21\n      }\n    }, \"Account Name\"), /*#__PURE__*/React.createElement(Form.Control, {\n      type: \"text\",\n      list: \"accounts-datalist\",\n      placeholder: \"Type or pick an account...\",\n      value: form.acname,\n      onChange: e => this.handleFormChange(\"acname\", e.target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"datalist\", {\n      id: \"accounts-datalist\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 17\n      }\n    }, accounts.map(acc => /*#__PURE__*/React.createElement(\"option\", {\n      key: acc.id,\n      value: acc.acname,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(\"datalist\", {\n      id: \"accounts-datalist\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 440,\n        columnNumber: 21\n      }\n    }, accounts.map(acc => /*#__PURE__*/React.createElement(\"option\", {\n      key: acc.id,\n      value: acc.acname,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 442,\n        columnNumber: 25\n      }\n    }))))), /*#__PURE__*/React.createElement(Col, {\n      md: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 448,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Form.Group, {\n      controlId: \"formContact\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Form.Label, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 21\n      }\n    }, \"Contact Person\"), /*#__PURE__*/React.createElement(Form.Control, {\n      as: \"select\",\n      value: form.contact,\n      onChange: e => this.handleFormChange(\"contact\", e.target.value),\n      disabled: !form.acname,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      value: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 457,\n        columnNumber: 23\n      }\n    }, \"Select Contact\"), contactOptions.map((cp, idx) => /*#__PURE__*/React.createElement(\"option\", {\n      key: idx,\n      value: cp.name,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 459,\n        columnNumber: 25\n      }\n    }, cp.name, cp.designation ? ` (${cp.designation})` : \"\")))))), /*#__PURE__*/React.createElement(Row, {\n      className: \"mt-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 470,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Form.Group, {\n      controlId: \"formPhone\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 471,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Form.Label, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 472,\n        columnNumber: 21\n      }\n    }, \"Phone\"), /*#__PURE__*/React.createElement(Form.Control, {\n      type: \"text\",\n      value: form.phone,\n      readOnly: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 473,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(Col, {\n      md: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 476,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Form.Group, {\n      controlId: \"formEmail\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Form.Label, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 478,\n        columnNumber: 21\n      }\n    }, \"Mail\"), /*#__PURE__*/React.createElement(Form.Control, {\n      type: \"text\",\n      value: form.email,\n      readOnly: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 479,\n        columnNumber: 21\n      }\n    })))), /*#__PURE__*/React.createElement(Row, {\n      className: \"mt-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 485,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Form.Group, {\n      controlId: \"formRemarks\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 486,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Form.Label, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 487,\n        columnNumber: 21\n      }\n    }, \"Remarks\"), /*#__PURE__*/React.createElement(Form.Control, {\n      as: \"textarea\",\n      rows: 4,\n      value: form.remarks,\n      onChange: e => this.handleFormChange(\"remarks\", e.target.value),\n      placeholder: \"Remarks (max 500 chars)\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 488,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"small\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 495,\n        columnNumber: 21\n      }\n    }, form.remarks.length, \"/500\")))))), /*#__PURE__*/React.createElement(Modal.Footer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 501,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"secondary\",\n      onClick: this.closeModal,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 502,\n        columnNumber: 13\n      }\n    }, \"Cancel\"), /*#__PURE__*/React.createElement(Button, {\n      variant: \"primary\",\n      onClick: this.handleSave,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 13\n      }\n    }, modalMode === \"new\" ? \"Create\" : \"Update\"))));\n  }\n\n}\n\nexport default Activity;","map":{"version":3,"sources":["C:/Users/College/admin/StarAdmin-Free-React-Admin-Template-master/template/demo_1/src/app/crm/Activity.js"],"names":["React","Component","Table","Button","Form","Card","InputGroup","Modal","Row","Col","db","collection","getDocs","addDoc","deleteDoc","doc","updateDoc","Activity","state","activities","accounts","contactOptions","showModal","modalMode","selectedId","form","acname","contact","phone","email","source","remarks","date","Date","toISOString","split","searchQuery","currentPage","pageSize","fetchActivities","snap","docs","map","docSnap","idx","id","no","data","setState","fetchAccounts","d","sort","a","b","localeCompare","handleSelectRow","openModal","mode","activity","find","account","acc","push","name","designation","contactPersons","length","concat","closeModal","handleFormChange","field","value","updatedForm","cp","c","handleSave","alert","ref","deleteSelected","window","confirm","handleSearch","e","target","handlePageChange","page","componentDidMount","render","filtered","filter","toLowerCase","includes","startIndex","paginated","slice","totalPages","Math","max","ceil","flex","maxWidth","marginRight","minWidth","gap","marginTop","width","act","whiteSpace","min"],"mappings":"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","sourcesContent":["// Activity.js (updated)\r\n// React 16+ style, using react-bootstrap and firebase/firestore\r\nimport React, { Component } from \"react\";\r\nimport {\r\n  Table,\r\n  Button,\r\n  Form,\r\n  Card,\r\n  InputGroup,\r\n  Modal,\r\n  Row,\r\n  Col,\r\n} from \"react-bootstrap\";\r\nimport { db } from \"../../firebase\";\r\nimport {\r\n  collection,\r\n  getDocs,\r\n  addDoc,\r\n  deleteDoc,\r\n  doc,\r\n  updateDoc,\r\n} from \"firebase/firestore\";\r\n\r\nclass Activity extends Component {\r\n  state = {\r\n    activities: [],\r\n    accounts: [],\r\n    contactOptions: [],\r\n    // modal control\r\n    showModal: false,\r\n    modalMode: \"new\", // 'new' or 'edit'\r\n    // selected row id (for radio select)\r\n    selectedId: null,\r\n\r\n    // form used in modal (for both new and edit)\r\n    form: {\r\n      acname: \"\",\r\n      contact: \"\",\r\n      phone: \"\",\r\n      email: \"\",\r\n      source: \"\",\r\n      remarks: \"\",\r\n      date: new Date().toISOString().split(\"T\")[0],\r\n    },\r\n\r\n    // pagination + search\r\n    searchQuery: \"\",\r\n    currentPage: 1,\r\n    pageSize: 10,\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.fetchActivities();\r\n    this.fetchAccounts();\r\n  }\r\n\r\n  // fetch activity logs\r\n  fetchActivities = async () => {\r\n    const snap = await getDocs(collection(db, \"activities\"));\r\n    const activities = snap.docs.map((docSnap, idx) => ({\r\n      id: docSnap.id,\r\n      no: idx + 1,\r\n      ...docSnap.data(),\r\n    }));\r\n    this.setState({ activities });\r\n  };\r\n\r\n  // fetch accounts (and later used to populate contactOptions)\r\n  fetchAccounts = async () => {\r\n    const snap = await getDocs(collection(db, \"accounts\"));\r\n    // sort alphabetically by acname for datalist\r\n    const accounts = snap.docs\r\n      .map((d) => ({ id: d.id, ...d.data() }))\r\n      .sort((a, b) => {\r\n        if (!a.acname) return 1;\r\n        if (!b.acname) return -1;\r\n        return a.acname.localeCompare(b.acname);\r\n      });\r\n    this.setState({ accounts });\r\n  };\r\n\r\n  // radio select a row\r\n  handleSelectRow = (id) => {\r\n    this.setState({ selectedId: id });\r\n  };\r\n\r\n  // open modal (new or edit)\r\n  openModal = (mode) => {\r\n    if (mode === \"edit\") {\r\n      const { selectedId, activities } = this.state;\r\n      if (!selectedId) return; // edit requires selection\r\n      const activity = activities.find((a) => a.id === selectedId);\r\n      if (!activity) return;\r\n      // prepare contactOptions for the selected account\r\n      const account = this.state.accounts.find((acc) => acc.acname === activity.acname);\r\n      let contactOptions = [];\r\n      if (account) {\r\n        if (account.contact) {\r\n          contactOptions.push({\r\n            name: account.contact,\r\n            designation: \"Main\",\r\n            phone: account.phone || \"\",\r\n            email: account.email || \"\",\r\n          });\r\n        }\r\n        if (account.contactPersons && account.contactPersons.length > 0) {\r\n          contactOptions = contactOptions.concat(account.contactPersons);\r\n        }\r\n      }\r\n      this.setState({\r\n        modalMode: \"edit\",\r\n        showModal: true,\r\n        form: {\r\n          acname: activity.acname || \"\",\r\n          contact: activity.contact || \"\",\r\n          phone: activity.phone || \"\",\r\n          email: activity.email || \"\",\r\n          source: activity.source || \"\",\r\n          remarks: activity.remarks || \"\",\r\n          date: activity.date || new Date().toISOString().split(\"T\")[0],\r\n        },\r\n        contactOptions,\r\n      });\r\n    } else {\r\n      // new\r\n      this.setState({\r\n        modalMode: \"new\",\r\n        showModal: true,\r\n        form: {\r\n          acname: \"\",\r\n          contact: \"\",\r\n          phone: \"\",\r\n          email: \"\",\r\n          source: \"\",\r\n          remarks: \"\",\r\n          date: new Date().toISOString().split(\"T\")[0],\r\n        },\r\n        contactOptions: [],\r\n      });\r\n    }\r\n  };\r\n\r\n  closeModal = () => {\r\n    this.setState({ showModal: false });\r\n  };\r\n\r\n  // handle form field changes inside modal\r\n  handleFormChange = (field, value) => {\r\n    let updatedForm = { ...this.state.form, [field]: value };\r\n\r\n    if (field === \"acname\") {\r\n      // find account by name and populate contactOptions\r\n      const acc = this.state.accounts.find((a) => a.acname === value);\r\n      let contactOptions = [];\r\n      if (acc) {\r\n        if (acc.contact) {\r\n          contactOptions.push({\r\n            name: acc.contact,\r\n            designation: \"Main\",\r\n            phone: acc.phone || \"\",\r\n            email: acc.email || \"\",\r\n          });\r\n        }\r\n        if (acc.contactPersons && acc.contactPersons.length > 0) {\r\n          contactOptions = contactOptions.concat(acc.contactPersons);\r\n        }\r\n      }\r\n      updatedForm.contact = \"\";\r\n      updatedForm.phone = \"\";\r\n      updatedForm.email = \"\";\r\n      this.setState({ contactOptions, form: updatedForm });\r\n      return;\r\n    }\r\n\r\n    if (field === \"contact\") {\r\n      const cp = this.state.contactOptions.find((c) => c.name === value);\r\n      if (cp) {\r\n        updatedForm.phone = cp.phone || \"\";\r\n        updatedForm.email = cp.email || \"\";\r\n      } else {\r\n        updatedForm.phone = \"\";\r\n        updatedForm.email = \"\";\r\n      }\r\n    }\r\n\r\n    if (field === \"remarks\") {\r\n      if (value.length > 500) {\r\n        // ignore extra input beyond 500\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.setState({ form: updatedForm });\r\n  };\r\n\r\n  // save modal (new or edit)\r\n  handleSave = async () => {\r\n    const { modalMode, form, selectedId } = this.state;\r\n\r\n    // basic validation\r\n    if (!form.acname) {\r\n      alert(\"Please select Account Name.\");\r\n      return;\r\n    }\r\n    if (!form.contact) {\r\n      alert(\"Please select Contact Person.\");\r\n      return;\r\n    }\r\n\r\n    if (modalMode === \"new\") {\r\n      await addDoc(collection(db, \"activities\"), form);\r\n    } else {\r\n      // update\r\n      const ref = doc(db, \"activities\", selectedId);\r\n      await updateDoc(ref, form);\r\n    }\r\n\r\n    // refresh & close\r\n    await this.fetchActivities();\r\n    this.closeModal();\r\n  };\r\n\r\n  deleteSelected = async () => {\r\n    const { selectedId } = this.state;\r\n    if (!selectedId) return;\r\n    if (!window.confirm(\"Delete selected entry?\")) return;\r\n    await deleteDoc(doc(db, \"activities\", selectedId));\r\n    this.setState({ selectedId: null });\r\n    this.fetchActivities();\r\n  };\r\n\r\n  // Search filter\r\n  handleSearch = (e) => {\r\n    this.setState({ searchQuery: e.target.value, currentPage: 1 });\r\n  };\r\n\r\n  // Pagination controls\r\n  handlePageChange = (page) => {\r\n    this.setState({ currentPage: page });\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      activities,\r\n      accounts,\r\n      contactOptions,\r\n      showModal,\r\n      modalMode,\r\n      form,\r\n      selectedId,\r\n      searchQuery,\r\n      currentPage,\r\n      pageSize,\r\n    } = this.state;\r\n\r\n    // --- Filter activities ---\r\n    const filtered = activities.filter(\r\n      (a) =>\r\n        a.acname?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        a.contact?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        (a.remarks || \"\").toLowerCase().includes(searchQuery.toLowerCase())\r\n    );\r\n\r\n    // --- Pagination logic ---\r\n    const startIndex = (currentPage - 1) * pageSize;\r\n    const paginated = filtered.slice(startIndex, startIndex + pageSize);\r\n    const totalPages = Math.max(1, Math.ceil(filtered.length / pageSize));\r\n\r\n    return (\r\n      <div className=\"container-fluid mt-4\">\r\n        <Card className=\"p-3 shadow-sm bg-white border-0\">\r\n          <div className=\"mb-6\">\r\n          <h4>Activities</h4>\r\n          <div className=\"d-flex align-items-center\">\r\n            \r\n            {/* Search box (fixed half width with right margin) */}\r\n            <div style={{ flex: \"0 0 50%\", maxWidth: \"50%\" ,marginRight: \"10px\"}} className=\"me-3\">\r\n              <InputGroup style={{ minWidth: 300 }}>\r\n                <Form.Control\r\n                  type=\"text\"\r\n                  placeholder=\"Search by account, contact, remarks...\"\r\n                  value={searchQuery}\r\n                  onChange={this.handleSearch}\r\n                />\r\n              </InputGroup>\r\n              </div>\r\n              <div className=\"d-flex \" style={{ gap: \"10px\" }}>\r\n              <Button              \r\n                 variant=\"secondary\"\r\n                 onClick={() => this.openModal(\"new\")}>\r\n                New\r\n              </Button>\r\n              <Button\r\n                variant=\"secondary\"\r\n                onClick={() => this.openModal(\"edit\")}\r\n                disabled={!selectedId}\r\n              >\r\n                Edit\r\n              </Button>\r\n              <Button\r\n                variant=\"secondary\"\r\n                onClick={this.deleteSelected}\r\n                disabled={!selectedId}\r\n              >\r\n                Delete\r\n              </Button>\r\n\r\n              {/* Search box */}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"table-responsive\" style={{marginTop:\"10px\"}}>\r\n            <Table bordered hover className=\"w-100\">\r\n              <thead className=\"thead-light\">\r\n                <tr>\r\n                  <th style={{ width: 40 }}></th>\r\n                  <th>Created Date</th>\r\n                  <th>Account Name</th>\r\n                  <th>Contact Person</th>\r\n                  <th>Phone</th>\r\n                  <th>Mail</th>\r\n                  <th>Source</th>\r\n                  <th>Remarks</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {paginated.map((act) => (\r\n                  <tr key={act.id}>\r\n                    <td className=\"text-center\">\r\n                      <Form.Check\r\n                        type=\"radio\"\r\n                        name=\"selectedRow\"\r\n                        checked={selectedId === act.id}\r\n                        onChange={() => this.handleSelectRow(act.id)}\r\n                      />\r\n                    </td>\r\n                    <td>{act.date}</td>\r\n                    <td>{act.acname}</td>\r\n                    <td>{act.contact}</td>\r\n                    <td>{act.phone}</td>\r\n                    <td>{act.email}</td>\r\n                    <td>{act.source}</td>\r\n                    <td style={{ maxWidth: \"300px\", whiteSpace: \"pre-wrap\" }}>\r\n                      {act.remarks}\r\n                    </td>\r\n                    \r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </Table>\r\n          </div>\r\n\r\n          {/* Pagination controls */}\r\n          <div className=\"d-flex justify-content-between align-items-center\">\r\n            <div>\r\n              Showing {filtered.length === 0 ? 0 : startIndex + 1}\r\n              {Math.min(startIndex + pageSize, filtered.length)} of {filtered.length}\r\n            </div>\r\n            <div>\r\n              <Button\r\n                variant=\"outline-secondary\"\r\n                size=\"sm\"\r\n                disabled={currentPage === 1}\r\n                onClick={() => this.handlePageChange(currentPage - 1)}\r\n              >\r\n                &lt;&lt;\r\n              </Button>{\" \"}\r\n              <span>\r\n                Page {currentPage} of {totalPages}\r\n              </span>{\" \"}\r\n              <Button\r\n                variant=\"outline-secondary\"\r\n                size=\"sm\"\r\n                disabled={currentPage === totalPages}\r\n                onClick={() => this.handlePageChange(currentPage + 1)}\r\n              >\r\n                &gt;&gt;\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </Card>\r\n\r\n        {/* Modal for New / Edit */}\r\n        <Modal show={showModal} onHide={this.closeModal} centered >\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>{modalMode === \"new\" ? \"New Entry\" : \"Edit Entry\"}</Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body classname=\"bg-white\">\r\n            <Form>\r\n              <Row>\r\n                <Col md={6}>\r\n                  <Form.Group controlId=\"formDate\">\r\n                    <Form.Label>Created Date</Form.Label>\r\n                    <Form.Control\r\n                      type=\"date\"\r\n                      value={form.date}\r\n                      onChange={(e) => this.handleFormChange(\"date\", e.target.value)}\r\n                    />\r\n                  </Form.Group>\r\n                </Col>\r\n\r\n                <Col md={6}>\r\n                  <Form.Group controlId=\"formSource\">\r\n                    <Form.Label>Source</Form.Label>\r\n                    <Form.Control\r\n                      as=\"select\"\r\n                      value={form.source}\r\n                      onChange={(e) => this.handleFormChange(\"source\", e.target.value)}\r\n                    >\r\n                      <option value=\"\">Select Source</option>\r\n                      <option value=\"Call\">Call</option>\r\n                      <option value=\"Meeting\">Meeting</option>\r\n                      <option value=\"Demo\">Demo</option>\r\n                      <option value=\"Mail\">Mail</option>\r\n                      <option value=\"Whatsapp\">Whatsapp</option>\r\n                    </Form.Control>\r\n                  </Form.Group>\r\n                </Col>\r\n              </Row>\r\n\r\n              <Row className=\"mt-3\">\r\n                <Col md={6}>\r\n                  <Form.Group controlId=\"formAccount\">\r\n                    <Form.Label>Account Name</Form.Label>\r\n                    {/* searchable with datalist and alphabetized options */}\r\n                    <Form.Control\r\n                  type=\"text\"\r\n                  list=\"accounts-datalist\"\r\n                  placeholder=\"Type or pick an account...\"\r\n                  value={form.acname}\r\n                  onChange={(e) => this.handleFormChange(\"acname\", e.target.value)}\r\n                />\r\n                <datalist id=\"accounts-datalist\">\r\n                  {accounts.map((acc) => (\r\n                    <option key={acc.id} value={acc.acname} />\r\n                  ))}\r\n                </datalist>\r\n\r\n                    <datalist id=\"accounts-datalist\">\r\n                      {accounts.map((acc) => (\r\n                        <option key={acc.id} value={acc.acname} />\r\n                      ))}\r\n                    </datalist>\r\n                  </Form.Group>\r\n                </Col>\r\n\r\n                <Col md={6}>\r\n                  <Form.Group controlId=\"formContact\">\r\n                    <Form.Label>Contact Person</Form.Label>\r\n                    <Form.Control\r\n                      as=\"select\"\r\n                      value={form.contact}\r\n                      onChange={(e) => this.handleFormChange(\"contact\", e.target.value)}\r\n                      disabled={!form.acname}\r\n                    >\r\n                      <option value=\"\">Select Contact</option>\r\n                      {contactOptions.map((cp, idx) => (\r\n                        <option key={idx} value={cp.name}>\r\n                          {cp.name}\r\n                          {cp.designation ? ` (${cp.designation})` : \"\"}\r\n                        </option>\r\n                      ))}\r\n                    </Form.Control>\r\n                  </Form.Group>\r\n                </Col>\r\n              </Row>\r\n\r\n              <Row className=\"mt-3\">\r\n                <Col md={6}>\r\n                  <Form.Group controlId=\"formPhone\">\r\n                    <Form.Label>Phone</Form.Label>\r\n                    <Form.Control type=\"text\" value={form.phone} readOnly />\r\n                  </Form.Group>\r\n                </Col>\r\n                <Col md={6}>\r\n                  <Form.Group controlId=\"formEmail\">\r\n                    <Form.Label>Mail</Form.Label>\r\n                    <Form.Control type=\"text\" value={form.email} readOnly />\r\n                  </Form.Group>\r\n                </Col>\r\n              </Row>\r\n\r\n              <Row className=\"mt-3\">\r\n                <Col>\r\n                  <Form.Group controlId=\"formRemarks\">\r\n                    <Form.Label>Remarks</Form.Label>\r\n                    <Form.Control\r\n                      as=\"textarea\"\r\n                      rows={4}\r\n                      value={form.remarks}\r\n                      onChange={(e) => this.handleFormChange(\"remarks\", e.target.value)}\r\n                      placeholder=\"Remarks (max 500 chars)\"\r\n                    />\r\n                    <small>{form.remarks.length}/500</small>\r\n                  </Form.Group>\r\n                </Col>\r\n              </Row>\r\n            </Form>\r\n          </Modal.Body>\r\n          <Modal.Footer>\r\n            <Button variant=\"secondary\" onClick={this.closeModal}>\r\n              Cancel\r\n            </Button>\r\n            <Button variant=\"primary\" onClick={this.handleSave}>\r\n              {modalMode === \"new\" ? \"Create\" : \"Update\"}\r\n            </Button>\r\n          </Modal.Footer>\r\n        </Modal>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Activity;\r\n"]},"metadata":{},"sourceType":"module"}