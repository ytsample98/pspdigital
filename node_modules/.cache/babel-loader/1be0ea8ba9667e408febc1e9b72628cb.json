{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\College\\\\admin\\\\StarAdmin-Free-React-Admin-Template-master\\\\template\\\\demo_1\\\\src\\\\app\\\\crm\\\\Activity.js\";\nimport React, { Component } from \"react\";\nimport { Table, Button, Form, Card } from \"react-bootstrap\";\nimport { db } from \"../../firebase\";\nimport { collection, getDocs, addDoc } from \"firebase/firestore\";\n\nclass Activity extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      activities: [],\n      accounts: [],\n      addingRow: false,\n      newRow: {\n        acname: \"\",\n        contact: \"\",\n        source: \"\",\n        date: new Date().toISOString().split(\"T\")[0] // yyyy-mm-dd\n\n      },\n      contactOptions: []\n    };\n\n    this.fetchActivities = async () => {\n      const snap = await getDocs(collection(db, \"activities\"));\n      const activities = snap.docs.map((doc, idx) => ({\n        id: doc.id,\n        no: idx + 1,\n        ...doc.data()\n      }));\n      this.setState({\n        activities\n      });\n    };\n\n    this.fetchAccounts = async () => {\n      const snap = await getDocs(collection(db, \"accounts\"));\n      const accounts = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        accounts\n      });\n    };\n\n    this.handleNewRowChange = (field, value) => {\n      let updated = { ...this.state.newRow,\n        [field]: value\n      }; // if account is changed, reset contact + populate contacts\n\n      if (field === \"acname\") {\n        const acc = this.state.accounts.find(a => a.acname === value);\n        const contactOptions = (acc === null || acc === void 0 ? void 0 : acc.contactPersons) || [];\n        updated.contact = \"\";\n        this.setState({\n          contactOptions\n        });\n      }\n\n      this.setState({\n        newRow: updated\n      });\n    };\n\n    this.saveNewRow = async () => {\n      const {\n        newRow\n      } = this.state; // save to firebase\n\n      await addDoc(collection(db, \"activities\"), newRow);\n      this.setState({\n        addingRow: false,\n        newRow: {\n          acname: \"\",\n          contact: \"\",\n          source: \"\",\n          date: new Date().toISOString().split(\"T\")[0]\n        }\n      });\n      this.fetchActivities();\n    };\n  }\n\n  componentDidMount() {\n    this.fetchActivities();\n    this.fetchAccounts();\n  } // fetch activity logs\n\n\n  render() {\n    const {\n      activities,\n      accounts,\n      addingRow,\n      newRow,\n      contactOptions\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container mt-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      className: \"p-3 shadow-sm bg-white border-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex justify-content-between align-items-center mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      className: \"mb-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 13\n      }\n    }, \"Activities\"), !addingRow && /*#__PURE__*/React.createElement(Button, {\n      variant: \"primary\",\n      onClick: () => this.setState({\n        addingRow: true\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 15\n      }\n    }, \"+ Add Activity\")), /*#__PURE__*/React.createElement(Table, {\n      bordered: true,\n      hover: true,\n      responsive: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      className: \"thead-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }\n    }, \"No\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }\n    }, \"a/c Name\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }\n    }, \"Contact\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }\n    }, \"Source\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 17\n      }\n    }, \"Date\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }\n    }, \"Action\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 13\n      }\n    }, activities.map((act, idx) => /*#__PURE__*/React.createElement(\"tr\", {\n      key: act.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 19\n      }\n    }, idx + 1), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 19\n      }\n    }, act.acname), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 19\n      }\n    }, act.contact), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 19\n      }\n    }, act.source), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 19\n      }\n    }, act.date), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 19\n      }\n    }))), addingRow && /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 19\n      }\n    }, activities.length + 1), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Form.Control, {\n      as: \"select\",\n      value: newRow.acname,\n      onChange: e => this.handleNewRowChange(\"acname\", e.target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      value: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 23\n      }\n    }, \"Select Account\"), accounts.map(acc => /*#__PURE__*/React.createElement(\"option\", {\n      key: acc.id,\n      value: acc.acname,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 25\n      }\n    }, acc.acname)))), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Form.Control, {\n      as: \"select\",\n      value: newRow.contact,\n      onChange: e => this.handleNewRowChange(\"contact\", e.target.value),\n      disabled: !newRow.acname,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      value: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 23\n      }\n    }, \"Select Contact\"), contactOptions.map((cp, i) => /*#__PURE__*/React.createElement(\"option\", {\n      key: i,\n      value: cp.name,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 25\n      }\n    }, cp.name, \" (\", cp.designation, \")\")))), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Form.Control, {\n      as: \"select\",\n      value: newRow.source,\n      onChange: e => this.handleNewRowChange(\"source\", e.target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      value: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 23\n      }\n    }, \"Select Source\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"Call\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 23\n      }\n    }, \"Call\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"Meeting\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 23\n      }\n    }, \"Meeting\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"Demo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 23\n      }\n    }, \"Demo\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"Mail\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 23\n      }\n    }, \"Mail\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"Whatsapp\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 23\n      }\n    }, \"Whatsapp\"))), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Form.Control, {\n      type: \"date\",\n      value: newRow.date,\n      onChange: e => this.handleNewRowChange(\"date\", e.target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"success\",\n      size: \"sm\",\n      onClick: this.saveNewRow,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 21\n      }\n    }, \"\\u2713\"), \" \", /*#__PURE__*/React.createElement(Button, {\n      variant: \"secondary\",\n      size: \"sm\",\n      onClick: () => this.setState({\n        addingRow: false,\n        newRow: {\n          acname: \"\",\n          contact: \"\",\n          source: \"\",\n          date: new Date().toISOString().split(\"T\")[0]\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 21\n      }\n    }, \"\\u2715\")))))));\n  }\n\n}\n\nexport default Activity;","map":{"version":3,"sources":["C:/Users/College/admin/StarAdmin-Free-React-Admin-Template-master/template/demo_1/src/app/crm/Activity.js"],"names":["React","Component","Table","Button","Form","Card","db","collection","getDocs","addDoc","Activity","state","activities","accounts","addingRow","newRow","acname","contact","source","date","Date","toISOString","split","contactOptions","fetchActivities","snap","docs","map","doc","idx","id","no","data","setState","fetchAccounts","handleNewRowChange","field","value","updated","acc","find","a","contactPersons","saveNewRow","componentDidMount","render","act","length","e","target","cp","i","name","designation"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { Table, Button, Form, Card } from \"react-bootstrap\";\r\nimport { db } from \"../../firebase\";\r\nimport {\r\n  collection,\r\n  getDocs,\r\n  addDoc\r\n} from \"firebase/firestore\";\r\n\r\nclass Activity extends Component {\r\n  state = {\r\n    activities: [],\r\n    accounts: [],\r\n    addingRow: false,\r\n    newRow: {\r\n      acname: \"\",\r\n      contact: \"\",\r\n      source: \"\",\r\n      date: new Date().toISOString().split(\"T\")[0], // yyyy-mm-dd\r\n    },\r\n    contactOptions: [],\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.fetchActivities();\r\n    this.fetchAccounts();\r\n  }\r\n\r\n  // fetch activity logs\r\n  fetchActivities = async () => {\r\n    const snap = await getDocs(collection(db, \"activities\"));\r\n    const activities = snap.docs.map((doc, idx) => ({\r\n      id: doc.id,\r\n      no: idx + 1,\r\n      ...doc.data(),\r\n    }));\r\n    this.setState({ activities });\r\n  };\r\n\r\n  // fetch accounts + contacts from datalist\r\n  fetchAccounts = async () => {\r\n    const snap = await getDocs(collection(db, \"accounts\"));\r\n    const accounts = snap.docs.map((doc) => ({\r\n      id: doc.id,\r\n      ...doc.data(),\r\n    }));\r\n    this.setState({ accounts });\r\n  };\r\n\r\n  handleNewRowChange = (field, value) => {\r\n    let updated = { ...this.state.newRow, [field]: value };\r\n\r\n    // if account is changed, reset contact + populate contacts\r\n    if (field === \"acname\") {\r\n      const acc = this.state.accounts.find((a) => a.acname === value);\r\n      const contactOptions = acc?.contactPersons || [];\r\n      updated.contact = \"\";\r\n      this.setState({ contactOptions });\r\n    }\r\n\r\n    this.setState({ newRow: updated });\r\n  };\r\n\r\n  saveNewRow = async () => {\r\n    const { newRow } = this.state;\r\n\r\n    // save to firebase\r\n    await addDoc(collection(db, \"activities\"), newRow);\r\n\r\n    this.setState({ addingRow: false, newRow: { acname: \"\", contact: \"\", source: \"\", date: new Date().toISOString().split(\"T\")[0] } });\r\n    this.fetchActivities();\r\n  };\r\n\r\n  render() {\r\n    const { activities, accounts, addingRow, newRow, contactOptions } = this.state;\r\n\r\n    return (\r\n      <div className=\"container mt-4\">\r\n        <Card className=\"p-3 shadow-sm bg-white border-0\">\r\n          <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n            <h3 className=\"mb-0\">Activities</h3>\r\n            {!addingRow && (\r\n              <Button variant=\"primary\" onClick={() => this.setState({ addingRow: true })}>\r\n                + Add Activity\r\n              </Button>\r\n            )}\r\n          </div>\r\n\r\n          <Table bordered hover responsive>\r\n            <thead className=\"thead-light\">\r\n              <tr>\r\n                <th>No</th>\r\n                <th>a/c Name</th>\r\n                <th>Contact</th>\r\n                <th>Source</th>\r\n                <th>Date</th>\r\n                <th>Action</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {activities.map((act, idx) => (\r\n                <tr key={act.id}>\r\n                  <td>{idx + 1}</td>\r\n                  <td>{act.acname}</td>\r\n                  <td>{act.contact}</td>\r\n                  <td>{act.source}</td>\r\n                  <td>{act.date}</td>\r\n                  <td></td>\r\n                </tr>\r\n              ))}\r\n\r\n              {addingRow && (\r\n                <tr>\r\n                  <td>{activities.length + 1}</td>\r\n\r\n                  {/* account name dropdown */}\r\n                  <td>\r\n                    <Form.Control\r\n                      as=\"select\"\r\n                      value={newRow.acname}\r\n                      onChange={(e) => this.handleNewRowChange(\"acname\", e.target.value)}\r\n                    >\r\n                      <option value=\"\">Select Account</option>\r\n                      {accounts.map((acc) => (\r\n                        <option key={acc.id} value={acc.acname}>\r\n                          {acc.acname}\r\n                        </option>\r\n                      ))}\r\n                    </Form.Control>\r\n                  </td>\r\n\r\n                  {/* contact dropdown filtered */}\r\n                  <td>\r\n                    <Form.Control\r\n                      as=\"select\"\r\n                      value={newRow.contact}\r\n                      onChange={(e) => this.handleNewRowChange(\"contact\", e.target.value)}\r\n                      disabled={!newRow.acname}\r\n                    >\r\n                      <option value=\"\">Select Contact</option>\r\n                      {contactOptions.map((cp, i) => (\r\n                        <option key={i} value={cp.name}>\r\n                          {cp.name} ({cp.designation})\r\n                        </option>\r\n                      ))}\r\n                    </Form.Control>\r\n                  </td>\r\n\r\n                  {/* source dropdown */}\r\n                  <td>\r\n                    <Form.Control\r\n                      as=\"select\"\r\n                      value={newRow.source}\r\n                      onChange={(e) => this.handleNewRowChange(\"source\", e.target.value)}\r\n                    >\r\n                      <option value=\"\">Select Source</option>\r\n                      <option value=\"Call\">Call</option>\r\n                      <option value=\"Meeting\">Meeting</option>\r\n                      <option value=\"Demo\">Demo</option>\r\n                      <option value=\"Mail\">Mail</option>\r\n                      <option value=\"Whatsapp\">Whatsapp</option>\r\n                    </Form.Control>\r\n                  </td>\r\n\r\n                  {/* date input */}\r\n                  <td>\r\n                    <Form.Control\r\n                      type=\"date\"\r\n                      value={newRow.date}\r\n                      onChange={(e) => this.handleNewRowChange(\"date\", e.target.value)}\r\n                    />\r\n                  </td>\r\n\r\n                  {/* action buttons */}\r\n                  <td>\r\n                    <Button variant=\"success\" size=\"sm\" onClick={this.saveNewRow}>\r\n                      ✓\r\n                    </Button>{\" \"}\r\n                    <Button\r\n                      variant=\"secondary\"\r\n                      size=\"sm\"\r\n                      onClick={() =>\r\n                        this.setState({ addingRow: false, newRow: { acname: \"\", contact: \"\", source: \"\", date: new Date().toISOString().split(\"T\")[0] } })\r\n                      }\r\n                    >\r\n                      ✕\r\n                    </Button>\r\n                  </td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </Table>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Activity;\r\n"]},"metadata":{},"sourceType":"module"}