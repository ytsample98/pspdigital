{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\College\\\\admin\\\\StarAdmin-Free-React-Admin-Template-master\\\\template\\\\demo_1\\\\src\\\\app\\\\panelone\\\\Invoice.js\";\nimport React, { Component } from 'react';\nimport { Form } from 'react-bootstrap';\nimport bsCustomFileInput from 'bs-custom-file-input';\nimport { db } from '../../firebase';\nimport { collection, getDocs, addDoc, doc, updateDoc } from 'firebase/firestore';\nimport { withRouter } from 'react-router-dom';\nimport html2canvas from 'html2canvas';\nimport { jsPDF } from 'jspdf';\n\nconst numberToWords = num => {\n  const a = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine', 'Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];\n  const b = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];\n  if (num === 0) return 'Zero';\n  if (num < 20) return a[num];\n  if (num < 100) return b[Math.floor(num / 10)] + ' ' + a[num % 10];\n  if (num < 1000) return a[Math.floor(num / 100)] + ' Hundred ' + numberToWords(num % 100);\n  if (num < 100000) return numberToWords(Math.floor(num / 1000)) + ' Thousand ' + numberToWords(num % 1000);\n  return 'Amount too large';\n};\n\nclass Invoice extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      activeTab: 'co',\n      Invoices: [],\n      customers: [],\n      products: [],\n      despatchModes: [],\n      paymentTerms: [],\n      showForm: false,\n      showTaxOverlay: false,\n      currentTaxLineIdx: null,\n      editingId: null,\n      overlayType: '',\n      overlaySearch: '',\n      productOverlayVisible: false,\n      productOverlaySearch: '',\n      selectedProductIds: [],\n      selectedTaxGroups: [],\n      taxComponents: [],\n      taxGroups: [],\n      previewMode: false,\n      selectedInvoice: null,\n      formData: {\n        InvoiceNo: '',\n        InvoiceDate: new Date().toISOString().split('T')[0],\n        InvoiceType: 'Standard',\n        customer: '',\n        status: 'Entered',\n        // Static 'Entered'\n        choose: 'Service',\n        qrefNo: '',\n        impExp: 'None',\n        currency: '',\n        conversionRate: '',\n        taxAmount: '',\n        InvoiceValue: '',\n        billTo: '',\n        shipTo: '',\n        despatchMode: 'By Air',\n        paymentTerms: '',\n        freightCharges: '',\n        freighttaxAmount: '',\n        taxPercent: '',\n        packingCharges: '',\n        lineItems: []\n      }\n    };\n    this.customerInputRef = React.createRef();\n\n    this.formatAddress = addr => {\n      if (!addr) return '';\n      if (typeof addr === 'string') return addr;\n      return [addr.address, [addr.city, addr.state, addr.country].filter(Boolean).join(', '), addr.zip].filter(Boolean).join('\\n');\n    };\n\n    this.handleLineItemChange = (idx, field, value) => {\n      const updatedItems = [...this.state.formData.lineItems];\n      const item = { ...updatedItems[idx]\n      };\n\n      if (field === 'taxId') {\n        if (value === 'more') {\n          this.setState({\n            showTaxOverlay: true\n          });\n          return;\n        }\n\n        item.taxId = value;\n      } else {\n        item[field] = value;\n      }\n\n      updatedItems[idx] = item;\n      this.setState(prev => ({\n        formData: { ...prev.formData,\n          lineItems: updatedItems\n        }\n      }), this.recalculateInvoiceTotals);\n    };\n\n    this.recalculateInvoiceTotals = () => {\n      const {\n        lineItems,\n        freightCharges,\n        packingCharges,\n        taxPercent\n      } = this.state.formData;\n      let lineTotal = 0;\n      let lineTaxTotal = 0;\n      const updatedLineItems = lineItems.map(item => {\n        var _item$taxGroupNames;\n\n        const qty = parseFloat(item.qty || 1);\n        const unitPrice = parseFloat(item.unitPrice || 0);\n        const baseTotal = unitPrice * qty;\n        const groupNames = ((_item$taxGroupNames = item.taxGroupNames) === null || _item$taxGroupNames === void 0 ? void 0 : _item$taxGroupNames.length) ? item.taxGroupNames : [item.taxGroupName || item.taxId || ''];\n        let percent = 0;\n        let amount = 0;\n        let cgst = 0,\n            sgst = 0,\n            igst = 0;\n        groupNames.forEach(groupName => {\n          const group = this.state.taxGroups.find(t => t.groupName === groupName);\n\n          if (group && Array.isArray(group.lineItems)) {\n            group.lineItems.forEach(comp => {\n              const val = parseFloat(comp.percentOrAmt || 0);\n\n              if (comp.type === 'Percentage') {\n                percent += val;\n                const name = comp.component.toLowerCase();\n                if (name.includes('cgst')) cgst += val;\n                if (name.includes('sgst')) sgst += val;\n                if (name.includes('igst')) igst += val;\n              } else if (comp.type === 'Amount') {\n                amount += val;\n              }\n            });\n          }\n        }); // Total tax = percentage tax + fixed amount tax\n\n        const itemTaxAmt = baseTotal * percent / 100 + amount;\n        const itemTotal = baseTotal + itemTaxAmt;\n        lineTotal += baseTotal;\n        lineTaxTotal += itemTaxAmt;\n        console.log('Item:', item.itemCode, 'GroupNames:', groupNames, 'Tax %:', percent, 'Tax Amt:', itemTaxAmt);\n        return { ...item,\n          cgst,\n          sgst,\n          igst,\n          taxAmt: itemTaxAmt.toFixed(2),\n          total: itemTotal.toFixed(2)\n        };\n      }); // Freight + Freight Tax\n\n      const freight = parseFloat(freightCharges || 0);\n      const packing = parseFloat(packingCharges || 0);\n      const freightPercent = parseFloat(taxPercent || 0);\n      const freightTaxAmount = freight * freightPercent / 100; // Final tax and Invoice value\n\n      const totalTaxAmount = lineTaxTotal + freightTaxAmount;\n      const InvoiceValue = lineTotal + lineTaxTotal + freight + packing + freightTaxAmount; // Set final state\n\n      this.setState(prev => ({\n        formData: { ...prev.formData,\n          lineItems: updatedLineItems,\n          freighttaxAmount: freightTaxAmount.toFixed(2),\n          taxAmount: totalTaxAmount.toFixed(2),\n          InvoiceValue: InvoiceValue.toFixed(2)\n        }\n      }));\n    };\n\n    this.resetFOBFields = () => {\n      const {\n        freightCharges,\n        taxPercent,\n        taxAmount,\n        packingCharges,\n        InvoiceValue\n      } = this.state.formData;\n      const needsReset = [freightCharges, taxPercent, taxAmount, packingCharges, InvoiceValue].some(val => val !== '' && val !== null && val !== undefined);\n\n      if (needsReset) {\n        this.setState(prev => ({\n          formData: { ...prev.formData,\n            freightCharges: '',\n            taxPercent: '',\n            taxAmount: '',\n            packingCharges: '',\n            InvoiceValue: ''\n          }\n        }));\n      }\n    };\n\n    this.fetchTaxGroups = async () => {\n      const snap = await getDocs(collection(db, 'taxGroups'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        taxGroups: data\n      });\n    };\n\n    this.fetchInvoices = async () => {\n      const snap = await getDocs(collection(db, 'Invoices'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        Invoices: data.reverse()\n      });\n    };\n\n    this.fetchCustomers = async () => {\n      const snap = await getDocs(collection(db, 'customers'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        customers: data\n      });\n    };\n\n    this.fetchProducts = async () => {\n      const snap = await getDocs(collection(db, 'products'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        products: data\n      });\n    };\n\n    this.fetchDespatchModes = async () => {\n      const snap = await getDocs(collection(db, 'modes'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        despatchModes: data\n      });\n    };\n\n    this.fetchPaymentTerms = async () => {\n      const snap = await getDocs(collection(db, 'paymentTerms'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        paymentTerms: data\n      });\n    };\n\n    this.handleInputChange = (field, value) => {\n      this.setState(prev => ({\n        formData: { ...prev.formData,\n          [field]: value\n        }\n      }), () => {\n        if (['freightCharges', 'taxPercent', 'packingCharges'].includes(field)) {\n          this.recalculateInvoiceTotals();\n        }\n      });\n    };\n\n    this.handleSubmit = async e => {\n      e.preventDefault();\n      const {\n        editingId,\n        formData,\n        Invoices\n      } = this.state;\n      if (!formData.customer) return alert(\"Customer is required\");\n      if (formData.lineItems.length === 0) return alert(\"At least one line item is required\");\n\n      if (editingId) {\n        await updateDoc(doc(db, 'Invoices', editingId), formData);\n      } else {\n        formData.InvoiceNo = `IN${1000 + Invoices.length}`;\n        await addDoc(collection(db, 'Invoices'), formData);\n      }\n\n      this.setState({\n        showForm: false,\n        editingId: null\n      });\n      this.fetchInvoices();\n    };\n\n    this.loadInvoicePreview = q => {\n      this.setState({\n        selectedInvoice: q,\n        previewMode: true\n      });\n    };\n\n    this.getTaxPercentage = taxId => {\n      if (!taxId || taxId === 'nill') return 0;\n      const tax = this.state.taxComponents.find(tc => tc.id === taxId);\n      return (tax === null || tax === void 0 ? void 0 : tax.percentage) || 0;\n    };\n\n    this.loadInvoiceForEdit = Invoice => {\n      this.setState({\n        formData: { ...Invoice,\n          lineItems: Array.isArray(Invoice.lineItems) ? Invoice.lineItems : [] // Ensure array\n\n        },\n        editingId: Invoice.id,\n        showForm: true,\n        previewMode: false,\n        activeTab: 'co'\n      }, () => {\n        if (this.customerInputRef.current) {\n          this.customerInputRef.current.value = Invoice.customer;\n        }\n      });\n    };\n\n    this.convertToOrder = Invoice => {\n      // Save Invoice in sessionStorage (or navigate with state via router if you use react-router)\n      sessionStorage.setItem('InvoiceToConvert', JSON.stringify(Invoice));\n      this.props.history.push('/panelone/Order');\n    };\n\n    this.showInvoicePDFWithOrg = async Invoice => {\n      var _orgSnap$docs$, _Invoice$billTo, _Invoice$shipTo;\n\n      if (!Invoice || !Array.isArray(Invoice.lineItems) || Invoice.lineItems.length === 0) {\n        alert(\"Invoice data is incomplete.\");\n        return;\n      }\n\n      const orgSnap = await getDocs(collection(db, 'businessGroups'));\n      const org = ((_orgSnap$docs$ = orgSnap.docs[0]) === null || _orgSnap$docs$ === void 0 ? void 0 : _orgSnap$docs$.data()) || {};\n      const customer = this.state.customers.find(c => c.custshortName === Invoice.customer) || {};\n      const enrichedItems = Invoice.lineItems.map(item => {\n        const product = this.state.products.find(p => p.productId === item.itemCode) || {};\n        return { ...item,\n          ptshortName: product.ptshortName || '',\n          hsnCode: product.hsnCode || '',\n          uom: product.stockingUOM || '',\n          cgst: item.cgst || 0,\n          sgst: item.sgst || 0,\n          igst: item.igst || 0\n        };\n      }); // Calculate subtotal based on item.total\n\n      const subtotal = enrichedItems.reduce((sum, item) => sum + (parseFloat(item.total) || 0), 0);\n      const freightCharges = parseFloat(Invoice.freightCharges || 0);\n      const freightTax = parseFloat(Invoice.freighttaxAmount || 0);\n      const totalTaxAmount = parseFloat(Invoice.taxAmount || 0);\n      const grandTotal = parseFloat(Invoice.InvoiceValue || subtotal + totalTaxAmount);\n      const amountWords = `INR ${numberToWords(Math.floor(grandTotal))} Only`; // Build tax group breakdown\n\n      let taxBreakdown = {};\n      enrichedItems.forEach(item => {\n        const qty = parseFloat(item.qty || 0);\n        const unitPrice = parseFloat(item.unitPrice || 0);\n        const base = qty * unitPrice;\n\n        if (item.cgst) {\n          const key = `CGST ${item.cgst}%`;\n          taxBreakdown[key] = (taxBreakdown[key] || 0) + base * item.cgst / 100;\n        }\n\n        if (item.sgst) {\n          const key = `SGST ${item.sgst}%`;\n          taxBreakdown[key] = (taxBreakdown[key] || 0) + base * item.sgst / 100;\n        }\n\n        if (item.igst) {\n          const key = `IGST ${item.igst}%`;\n          taxBreakdown[key] = (taxBreakdown[key] || 0) + base * item.igst / 100;\n        }\n      });\n      if (freightTax > 0) taxBreakdown[\"Freight Tax\"] = freightTax;\n      const container = document.createElement('div');\n      container.id = 'pdf-preview-container';\n      container.style.width = '794px';\n      container.style.padding = '40px';\n      container.style.fontFamily = 'Arial';\n      container.innerHTML = `\n    <div style=\"display:flex; justify-content:space-between; align-items:center;\">\n      <img src=\"${org.logoUrl || ''}\" style=\"height:50px;\" />\n      <div style=\"font-size:18px; font-weight:bold;\">QUOTATION</div>\n    </div>\n    <hr/>\n    <div style=\"display:flex; justify-content:space-between; font-size:11px;\">\n      <div style=\"line-height:1.5; width:50%;\">\n        <b>${org.bgName || ''}</b><br/>\n        ${org.address || ''}<br/>\n        <b>Email:</b> ${org.email || ''}<br/>\n        <b>Website:</b> ${org.website || ''}<br/>\n        <b>GSTIN:</b> ${org.gstin || ''}\n      </div>\n      <table style=\"font-size:11px; text-align:left;\">\n        <tr><td><b>Invoice No</b></td><td>: ${Invoice.InvoiceNo}</td></tr>\n        <tr><td><b>Invoice Date</b></td><td>: ${Invoice.InvoiceDate}</td></tr>\n        <tr><td><b>Currency</b></td><td>: ${Invoice.currency || 'INR'}</td></tr>\n        <tr><td><b>Despatch</b></td><td>: ${Invoice.despatchMode || ''}</td></tr>\n      </table>\n    </div>\n\n    <div style=\"margin-top:15px; display:flex; justify-content:space-between; font-size:11px;\">\n      <div style=\"width:48%;\">\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Bill To</b>\n        <div style=\"border:1px solid #ccc; padding:6px;\">\n         <b>${Invoice.customer || ''}</b><br/>\n          ${((_Invoice$billTo = Invoice.billTo) === null || _Invoice$billTo === void 0 ? void 0 : _Invoice$billTo.replace(/\\n/g, '<br/>')) || ''}\n        </div>\n        <div style=\"font-size:10px; margin-top:6px;\">\n            <b>GSTIN:</b> ${customer.gstin || ''}<br/>\n            <b>Email:</b> ${customer.email || ''}<br/>\n            <b>Contact:</b> ${customer.contactPerson || ''}<br/>\n            <b>Phone:</b> ${customer.phone || ''}\n        </div>\n      </div>\n      <div style=\"width:48%;\">\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Ship To</b>\n        <div style=\"border:1px solid #ccc; padding:6px;\">\n         <b>${Invoice.customer || ''}</b><br/>\n          ${((_Invoice$shipTo = Invoice.shipTo) === null || _Invoice$shipTo === void 0 ? void 0 : _Invoice$shipTo.replace(/\\n/g, '<br/>')) || ''}\n        </div>\n      </div>\n    </div>\n\n    <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\n  <thead>\n    <tr style=\"background:#f4f6fa;\">\n      <th style=\"border:1px solid #011b56;\">Item Code</th>\n      <th style=\"border:1px solid #011b56;\">Short</th>\n      <th style=\"border:1px solid #011b56;\">Description</th>\n      <th style=\"border:1px solid #011b56;\">HSN</th>\n      <th style=\"border:1px solid #011b56;\">UOM</th>\n      <th style=\"border:1px solid #011b56;\">Qty</th>\n      <th style=\"border:1px solid #011b56;\">Unit Price</th>\n      <th style=\"border:1px solid #011b56;\">GST%</th>\n      <th style=\"border:1px solid #011b56;\">Item Total</th>\n    </tr>\n  </thead>\n  <tbody>\n    ${enrichedItems.map(item => {\n        const gstParts = [];\n        if (item.cgst) gstParts.push(`CGST ${item.cgst}%`);\n        if (item.sgst) gstParts.push(`SGST ${item.sgst}%`);\n        if (item.igst) gstParts.push(`IGST ${item.igst}%`);\n        const gstLabel = gstParts.length ? gstParts.join(' + ') : '-';\n        return `\n        <tr>\n          <td style=\"border:1px solid #011b56;\">${item.itemCode}</td>\n          <td style=\"border:1px solid #011b56;\">${item.ptshortName}</td>\n          <td style=\"border:1px solid #011b56;\">${item.itemDescription}</td>\n          <td style=\"border:1px solid #011b56;\">${item.hsnCode}</td>\n          <td style=\"border:1px solid #011b56;\">${item.uom}</td>\n          <td style=\"border:1px solid #011b56;\">${item.qty}</td>\n          <td style=\"border:1px solid #011b56;\">${item.unitPrice}</td>\n          <td style=\"border:1px solid #011b56;\">${gstLabel}</td>\n          <td style=\"border:1px solid #011b56;\">${item.total}</td>\n        </tr>`;\n      }).join('')}\n\n        <tr><td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td><td style=\"border:1px solid #011b56;\"><b>${totalTaxAmount.toFixed(2)}</b></td></tr>\n        <tr><td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Grand Total</b></td><td style=\"border:1px solid #011b56;\"><b>${grandTotal.toFixed(2)}</b></td></tr>\n      </tbody>\n    </table>\n\n    <div style=\"margin-top:8px; font-size:11px;\"><b>Amount in Words:</b> ${amountWords}</div>\n    <div style=\"text-align:right; font-size:11px; margin-top:30px;\">For ${org.bgName}<br/><br/><br/>Authorized Signatory</div>\n    <div style=\"margin-top:20px; text-align:right; font-size:10px;\">Printed on ${new Date().toLocaleString()}</div>\n  `;\n      document.body.appendChild(container);\n      const canvas = await html2canvas(container, {\n        scale: 2,\n        useCORS: true\n      });\n      const imgData = canvas.toDataURL('image/png');\n      const pdf = new jsPDF('p', 'pt', 'a4');\n      const width = 595.28;\n      const height = canvas.height * width / canvas.width;\n      pdf.addImage(imgData, 'PNG', 0, 0, width, height);\n      const blob = pdf.output('blob');\n      const url = URL.createObjectURL(blob);\n      const newWin = window.open();\n      newWin.document.write(`\n    <html><head><title>Invoice PDF Preview</title></head>\n    <body style=\"margin:0;\">\n      <iframe width=\"100%\" height=\"100%\" style=\"border:none;\" src=\"${url}\"></iframe>\n      <button onclick=\"document.querySelector('iframe').contentWindow.print()\" style=\"position:fixed;top:10px;right:110px;\"></button>\n      <a href=\"${url}\" download=\"Invoice_${Invoice.InvoiceNo || 'PDF'}.pdf\" style=\"position:fixed;top:10px;right:10px;\"></a>\n    </body></html>\n  `);\n      newWin.document.close();\n      document.body.removeChild(container);\n    };\n\n    this.toggleTaxGroupSelection = (groupName, lineIdx, isChecked) => {\n      const formData = { ...this.state.formData\n      };\n      const item = formData.lineItems[lineIdx];\n      if (!item.taxGroupNames) item.taxGroupNames = [];\n\n      if (isChecked) {\n        if (!item.taxGroupNames.includes(groupName)) {\n          item.taxGroupNames.push(groupName);\n        }\n      } else {\n        item.taxGroupNames = item.taxGroupNames.filter(g => g !== groupName);\n      } // Recalculates individual tax fields â€” but not totals\n\n\n      let cgst = 0,\n          sgst = 0,\n          igst = 0;\n      item.taxGroupNames.forEach(gname => {\n        const tg = this.state.taxGroups.find(t => t.groupName === gname);\n\n        if (tg) {\n          tg.lineItems.forEach(l => {\n            const comp = l.component.toLowerCase();\n            const val = parseFloat(l.percentOrAmt || 0);\n            if (comp.includes('cgst')) cgst += val;\n            if (comp.includes('sgst')) sgst += val;\n            if (comp.includes('igst')) igst += val;\n          });\n        }\n      });\n      const itemTotal = item.unitPrice * item.qty;\n      const totalTaxPercent = cgst + sgst + igst;\n      const taxAmt = itemTotal * totalTaxPercent / 100;\n      item.cgst = cgst;\n      item.sgst = sgst;\n      item.igst = igst;\n      item.taxAmt = taxAmt;\n      item.total = itemTotal + taxAmt;\n      this.setState({\n        formData\n      }, () => this.recalculateInvoiceTotals());\n    };\n\n    this.showOverlay = type => this.setState({\n      overlayType: type,\n      overlaySearch: ''\n    });\n\n    this.hideOverlay = () => this.setState({\n      overlayType: '',\n      overlaySearch: ''\n    });\n\n    this.selectOverlayValue = value => {\n      if (this.state.overlayType === 'customer') {\n        this.setState(prev => ({\n          formData: { ...prev.formData,\n            customer: value.custname || value.custcode || '',\n            // Use custname or custcode\n            billTo: this.formatAddress(value.billTo),\n            shipTo: this.formatAddress(value.shipTo),\n            currency: value.currency || '' // despatchMode: value.despatchMode || '', // No auto-fill for despatch mode\n            // paymentTerms: value.paymentTerms || '' // No auto-fill for payment terms\n\n          },\n          overlayType: '',\n          overlaySearch: ''\n        }), () => {\n          if (this.customerInputRef.current) {\n            this.customerInputRef.current.value = value.custname || value.custcode || '';\n          }\n        });\n      }\n    };\n\n    this.renderTaxOverlay = () => {\n      const {\n        taxGroups,\n        currentTaxLineIdx,\n        formData\n      } = this.state;\n      if (currentTaxLineIdx === null) return null;\n      const item = formData.lineItems[currentTaxLineIdx];\n      const selected = new Set(item.taxGroupNames || []);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          position: 'absolute',\n          zIndex: 9999,\n          top: '10%',\n          left: '20%',\n          background: '#fff',\n          border: '1px solid #ccc',\n          padding: '20px',\n          boxShadow: '0 0 10px rgba(0,0,0,0.3)',\n          width: '800px',\n          maxHeight: '60vh',\n          overflowY: 'auto'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 629,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"h5\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 642,\n          columnNumber: 7\n        }\n      }, \"Select Tax Groups\"), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-sm table-bordered\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 643,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 644,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 645,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 645,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 645,\n          columnNumber: 24\n        }\n      }, \"Group\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 645,\n          columnNumber: 38\n        }\n      }, \"Type\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 645,\n          columnNumber: 51\n        }\n      }, \"%\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 647,\n          columnNumber: 9\n        }\n      }, taxGroups.map(tg => /*#__PURE__*/React.createElement(\"tr\", {\n        key: tg.groupName,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 649,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 650,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        checked: selected.has(tg.groupName),\n        onChange: e => this.toggleTaxGroupSelection(tg.groupName, currentTaxLineIdx, e.target.checked),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 651,\n          columnNumber: 17\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 657,\n          columnNumber: 15\n        }\n      }, tg.groupName), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 658,\n          columnNumber: 15\n        }\n      }, tg.lineItems.map(li => li.component).join(', ')), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 659,\n          columnNumber: 15\n        }\n      }, tg.lineItems.map(li => li.percentOrAmt).join(', ')))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-right mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 664,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-sm btn-primary\",\n        onClick: () => this.setState({\n          showTaxOverlay: false\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 665,\n          columnNumber: 9\n        }\n      }, \"Done\")));\n    };\n\n    this.renderOverlay = () => {\n      const {\n        overlayType,\n        overlaySearch,\n        customers,\n        despatchModes,\n        paymentTerms\n      } = this.state;\n\n      const getFilteredRows = (list, nameKey = 'name', codeKey = 'shortName') => list.filter(item => (item[nameKey] || '').toLowerCase().includes((overlaySearch || '').toLowerCase()) || (item[codeKey] || '').toLowerCase().includes((overlaySearch || '').toLowerCase()));\n\n      const handleSelect = item => {\n        if (overlayType === 'customer') {\n          this.selectOverlayValue(item);\n        } else if (overlayType === 'despatchMode') {\n          this.setState(prev => ({\n            formData: { ...prev.formData,\n              despatchMode: item.name\n            },\n            overlayType: '',\n            overlaySearch: ''\n          }));\n        } else if (overlayType === 'paymentTerms') {\n          this.setState(prev => ({\n            formData: { ...prev.formData,\n              paymentTerms: item.name\n            },\n            overlayType: '',\n            overlaySearch: ''\n          }));\n        }\n      };\n\n      let title = '';\n      let headers = [];\n      let rows = [];\n\n      if (overlayType === 'customer') {\n        title = 'Select Customer';\n        headers = ['Name', 'Code', 'Short Name'];\n        rows = getFilteredRows(customers, 'custname', 'custcode');\n      } else if (overlayType === 'despatchMode') {\n        title = 'Select Despatch Mode';\n        headers = ['Name', 'Short Name'];\n        rows = getFilteredRows(despatchModes);\n      } else if (overlayType === 'paymentTerms') {\n        title = 'Select Payment Terms';\n        headers = ['Name', 'Short Name'];\n        rows = getFilteredRows(paymentTerms);\n      } else {\n        return null;\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 729,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 730,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 731,\n          columnNumber: 9\n        }\n      }, title), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control mb-2\",\n        placeholder: `Search ${overlayType}...`,\n        value: overlaySearch,\n        onChange: e => this.setState({\n          overlaySearch: e.target.value\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 732,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          maxHeight: 300,\n          overflowY: 'auto'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 739,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered table-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 740,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 741,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 742,\n          columnNumber: 15\n        }\n      }, headers.map((h, i) => /*#__PURE__*/React.createElement(\"th\", {\n        key: i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 743,\n          columnNumber: 40\n        }\n      }, h)))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 746,\n          columnNumber: 13\n        }\n      }, rows.map((item, i) => /*#__PURE__*/React.createElement(\"tr\", {\n        key: item.id || i,\n        onClick: () => handleSelect(item),\n        style: {\n          cursor: 'pointer'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 748,\n          columnNumber: 17\n        }\n      }, headers.map((h, j) => /*#__PURE__*/React.createElement(\"td\", {\n        key: j,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 750,\n          columnNumber: 21\n        }\n      }, overlayType === 'customer' ? h === 'Name' ? item.custname : h === 'Code' ? item.custcode : item.custshortName : h === 'Name' ? item.name : item.shortName)))), rows.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 762,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        colSpan: headers.length,\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 763,\n          columnNumber: 19\n        }\n      }, \"No records found\"))))), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-secondary btn-sm mt-2\",\n        onClick: this.hideOverlay,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 769,\n          columnNumber: 9\n        }\n      }, \"Cancel\")));\n    };\n\n    this.renderProductOverlay = () => {\n      const {\n        products,\n        productOverlaySearch,\n        selectedProductIds\n      } = this.state;\n      const filtered = products.filter(p => (p.ptshortName || '').toLowerCase().includes(productOverlaySearch.toLowerCase()) || (p.ptdescription || '').toLowerCase().includes(productOverlaySearch.toLowerCase()) || (p.itemCode || '').toLowerCase().includes(productOverlaySearch.toLowerCase()));\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 783,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 784,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 785,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 786,\n          columnNumber: 13\n        }\n      }, \"Select Products\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-success btn-sm\",\n        onClick: () => {\n          const selectedProducts = products.filter(p => this.state.selectedProductIds.includes(p.id));\n          this.setState(prev => ({\n            formData: { ...prev.formData,\n              lineItems: [...prev.formData.lineItems, ...selectedProducts.filter(p => !prev.formData.lineItems.some(item => item.id === p.id)).map(p => ({\n                id: p.id,\n                itemCode: p.productId || '',\n                itemDescription: p.ptdescription || '',\n                itemType: p.itemType || '',\n                materialType: p.materialType || '',\n                onHand: p.onHand || 0,\n                taxGroup: p.taxGroup || '',\n                taxGroupName: p.taxGroup || '',\n                custPartNo: p.custPartNo || '',\n                hsnNo: p.hsnNo || '',\n                unitPrice: p.unitPrice || 0,\n                qty: 1,\n                total: (p.unitPrice || 0).toFixed(2)\n              }))]\n            },\n            productOverlayVisible: false,\n            selectedProductIds: []\n          }));\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 787,\n          columnNumber: 13\n        }\n      }, \"Add Selected\")), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control mb-2\",\n        placeholder: \"Search products...\",\n        value: productOverlaySearch,\n        onChange: e => this.setState({\n          productOverlaySearch: e.target.value\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 821,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          maxHeight: 300,\n          overflowY: 'auto'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 828,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered table-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 829,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 830,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 831,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 832,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 833,\n          columnNumber: 19\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 834,\n          columnNumber: 19\n        }\n      }, \"Item Desc\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 835,\n          columnNumber: 19\n        }\n      }, \"Item Type\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 836,\n          columnNumber: 19\n        }\n      }, \"Material Type\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 837,\n          columnNumber: 19\n        }\n      }, \"On Hand\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 838,\n          columnNumber: 19\n        }\n      }, \"Tax Grp\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 839,\n          columnNumber: 19\n        }\n      }, \"Cust Part No\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 842,\n          columnNumber: 15\n        }\n      }, filtered.map(p => /*#__PURE__*/React.createElement(\"tr\", {\n        key: p.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 844,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 845,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        checked: selectedProductIds.includes(p.id),\n        onChange: e => {\n          const checked = e.target.checked;\n          this.setState(prev => ({\n            selectedProductIds: checked ? [...prev.selectedProductIds, p.id] : prev.selectedProductIds.filter(id => id !== p.id)\n          }));\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 846,\n          columnNumber: 23\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 859,\n          columnNumber: 21\n        }\n      }, p.productId), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 860,\n          columnNumber: 21\n        }\n      }, p.ptdescription || ''), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 861,\n          columnNumber: 21\n        }\n      }, p.itemType || ''), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 862,\n          columnNumber: 21\n        }\n      }, p.materialType || ''), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 863,\n          columnNumber: 21\n        }\n      }, p.onHand || 0), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 864,\n          columnNumber: 21\n        }\n      }, p.taxGroup || ''), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 865,\n          columnNumber: 21\n        }\n      }, p.custPartNo || ''))), filtered.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 869,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        colSpan: \"8\",\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 870,\n          columnNumber: 21\n        }\n      }, \"No products found\"))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 877,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 878,\n          columnNumber: 13\n        }\n      }, \"Page 1 of 1\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-secondary btn-sm\",\n        onClick: () => this.setState({\n          productOverlayVisible: false,\n          selectedProductIds: []\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 879,\n          columnNumber: 13\n        }\n      }, \"Cancel\"))));\n    };\n\n    this.renderInvoiceTable = () => /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card mt-4 full-height\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 889,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 890,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex justify-content-between align-items-center mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 891,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      className: \"card-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 892,\n        columnNumber: 11\n      }\n    }, \"Invoices\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-primary\",\n      onClick: () => this.setState({\n        showForm: true\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 893,\n        columnNumber: 11\n      }\n    }, \"+ Add Invoice\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"table-responsive\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 895,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"table\", {\n      className: \"table table-bordered table-hover\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 896,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      className: \"thead-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 897,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      style: {\n        fontSize: '14px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 898,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 899,\n        columnNumber: 17\n      }\n    }, \"Invoice No\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 900,\n        columnNumber: 17\n      }\n    }, \"Customer\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 901,\n        columnNumber: 17\n      }\n    }, \"Date\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 902,\n        columnNumber: 17\n      }\n    }, \"Invoice Value\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 903,\n        columnNumber: 17\n      }\n    }, \"Status\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 904,\n        columnNumber: 17\n      }\n    }, \"Print\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 907,\n        columnNumber: 13\n      }\n    }, this.state.Invoices.map((q, i) => /*#__PURE__*/React.createElement(\"tr\", {\n      key: i,\n      style: {\n        fontSize: '14px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 909,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 910,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-link p-0\",\n      onClick: () => this.loadInvoicePreview(q),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 911,\n        columnNumber: 21\n      }\n    }, q.InvoiceNo)), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 918,\n        columnNumber: 19\n      }\n    }, q.customer), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 919,\n        columnNumber: 19\n      }\n    }, q.InvoiceDate), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 920,\n        columnNumber: 19\n      }\n    }, q.InvoiceValue), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 921,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"badge badge-info\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 921,\n        columnNumber: 23\n      }\n    }, q.status)), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 922,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"mdi mdi-printer menu-icon\",\n      onClick: () => this.showInvoicePDFWithOrg(q),\n      style: {\n        fontSize: '24px',\n        color: '#2196F3',\n        cursor: 'pointer'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 923,\n        columnNumber: 19\n      }\n    })))), this.state.Invoices.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 934,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      colSpan: \"6\",\n      className: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 934,\n        columnNumber: 21\n      }\n    }, \"No Invoices found.\")))))));\n\n    this.renderInvoiceForm = () => {\n      const {\n        formData,\n        overlayType,\n        productOverlayVisible,\n        showTaxOverlay,\n        taxGroups\n      } = this.state;\n      const isFOB = formData.impExp === 'FOB';\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 948,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card full-height\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 949,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          flex: 1,\n          overflowY: 'auto',\n          padding: '24px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 950,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 951,\n          columnNumber: 13\n        }\n      }, \"Invoice Form\"), /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"nav nav-tabs\",\n        role: \"tablist\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 952,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        className: \"nav-item\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 953,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: `nav-link ${this.state.activeTab === 'co' ? 'active' : ''}`,\n        onClick: () => this.setState({\n          activeTab: 'co'\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 954,\n          columnNumber: 17\n        }\n      }, \"CO Details\")), /*#__PURE__*/React.createElement(\"li\", {\n        className: \"nav-item\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 956,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: `nav-link ${this.state.activeTab === 'commercial' ? 'active' : ''}`,\n        onClick: () => this.setState({\n          activeTab: 'commercial'\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 957,\n          columnNumber: 17\n        }\n      }, \"Commercial Terms\"))), /*#__PURE__*/React.createElement(\"form\", {\n        className: \"form-sample\",\n        onSubmit: this.handleSubmit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 960,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"tab-content pt-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 961,\n          columnNumber: 15\n        }\n      }, this.state.activeTab === 'co' && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 964,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 965,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 966,\n          columnNumber: 25\n        }\n      }, \"Invoice No\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.InvoiceNo,\n        onChange: e => this.handleInputChange('InvoiceNo', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 967,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 969,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 970,\n          columnNumber: 25\n        }\n      }, \"Invoice Date\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"date\",\n        className: \"form-control form-control-sm\",\n        value: formData.InvoiceDate,\n        onChange: e => this.handleInputChange('InvoiceDate', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 971,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 973,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 974,\n          columnNumber: 25\n        }\n      }, \"Invoice Type\"), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"form-control form-control-sm\",\n        value: formData.InvoiceType,\n        onChange: e => this.handleInputChange('InvoiceType', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 975,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 976,\n          columnNumber: 27\n        }\n      }, \"Standard\"), /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 977,\n          columnNumber: 27\n        }\n      }, \"Manual\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 980,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 981,\n          columnNumber: 25\n        }\n      }, \"Status\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.status,\n        style: {\n          backgroundColor: '#fff'\n        },\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 982,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 985,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 986,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 987,\n          columnNumber: 25\n        }\n      }, \"Customer\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group input-group-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 988,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        placeholder: \"Choose Customer\",\n        ref: this.customerInputRef,\n        value: formData.customer,\n        readOnly: true,\n        onClick: () => this.showOverlay('customer'),\n        style: {\n          cursor: 'pointer'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 989,\n          columnNumber: 27\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group-append\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 999,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-outline-secondary btn-sm\",\n        type: \"button\",\n        onClick: () => this.showOverlay('customer'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1000,\n          columnNumber: 29\n        }\n      }, \"Select\")))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1004,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1005,\n          columnNumber: 25\n        }\n      }, \"IMP/EXP\"), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"form-control form-control-sm\",\n        value: formData.impExp,\n        onChange: e => this.handleInputChange('impExp', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1006,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1011,\n          columnNumber: 27\n        }\n      }, \"None\"), /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1012,\n          columnNumber: 27\n        }\n      }, \"COB\"), /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1013,\n          columnNumber: 27\n        }\n      }, \"FOB\"), /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1014,\n          columnNumber: 27\n        }\n      }, \"CIF\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1017,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1018,\n          columnNumber: 25\n        }\n      }, \"Ref No.\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.qrefNo,\n        onChange: e => this.handleInputChange('qrefNo', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1019,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1026,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1027,\n          columnNumber: 25\n        }\n      }, \"Choose\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex align-items-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1028,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-check mr-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1029,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"radio\",\n        className: \"form-check-input\",\n        name: \"choose\",\n        id: \"chooseService\",\n        value: \"Service\",\n        checked: formData.choose === 'Service',\n        onChange: e => this.handleInputChange('choose', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1030,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"label\", {\n        className: \"form-check-label\",\n        htmlFor: \"chooseService\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1031,\n          columnNumber: 29\n        }\n      }, \"Service\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-check\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1033,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"radio\",\n        className: \"form-check-input\",\n        name: \"choose\",\n        id: \"chooseProduct\",\n        value: \"Product\",\n        checked: formData.choose === 'Product',\n        onChange: e => this.handleInputChange('choose', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1034,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"label\", {\n        className: \"form-check-label\",\n        htmlFor: \"chooseProduct\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1035,\n          columnNumber: 29\n        }\n      }, \"Product\"))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1040,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1041,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1042,\n          columnNumber: 25\n        }\n      }, \"Currency\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.currency,\n        style: {\n          backgroundColor: '#fff'\n        },\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1043,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1051,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1052,\n          columnNumber: 25\n        }\n      }, \"Conversion Rate\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.conversionRate,\n        onChange: e => this.handleInputChange('conversionRate', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1053,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1060,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1061,\n          columnNumber: 25\n        }\n      }, \"Tax Amount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.taxAmount,\n        onChange: e => this.handleInputChange('taxAmount', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1062,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1070,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1071,\n          columnNumber: 25\n        }\n      }, \"Invoice Value\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.InvoiceValue,\n        onChange: e => this.handleInputChange('InvoiceValue', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1072,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1082,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"card-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1083,\n          columnNumber: 29\n        }\n      }, \"Line Item\"), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-primary btn-sm\",\n        onClick: () => this.setState({\n          productOverlayVisible: true\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1084,\n          columnNumber: 29\n        }\n      }, \"+ Add Product\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"table-responsive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1088,\n          columnNumber: 24\n        }\n      }, /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1089,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        className: \"thead-light\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1090,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1091,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1092,\n          columnNumber: 15\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1093,\n          columnNumber: 15\n        }\n      }, \"Item Desc\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1094,\n          columnNumber: 15\n        }\n      }, \"Cust Part No\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1095,\n          columnNumber: 15\n        }\n      }, \"HSN No\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1096,\n          columnNumber: 15\n        }\n      }, \"UOM\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1097,\n          columnNumber: 15\n        }\n      }, \"On Hand\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1098,\n          columnNumber: 15\n        }\n      }, \"Unit Price\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1099,\n          columnNumber: 15\n        }\n      }, \"Quantity\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1100,\n          columnNumber: 15\n        }\n      }, \"Tax Id\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1101,\n          columnNumber: 15\n        }\n      }, \"Item Total\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1104,\n          columnNumber: 11\n        }\n      }, formData.lineItems.map((item, idx) => {\n        const itemTotal = item.unitPrice * item.qty;\n        const taxDetails = this.getTaxDetailsFromGroup(item.taxGroupName);\n        const taxAmt = itemTotal * taxDetails.totalPercent / 100 + itemTotal * taxDetails.totalAmount;\n        const totalWithTax = itemTotal + taxAmt;\n        return /*#__PURE__*/React.createElement(\"tr\", {\n          key: item.id || idx,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1113,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1114,\n            columnNumber: 19\n          }\n        }, item.itemCode), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1115,\n            columnNumber: 19\n          }\n        }, item.itemDescription), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1116,\n            columnNumber: 19\n          }\n        }, item.custPartNo), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1117,\n            columnNumber: 19\n          }\n        }, item.hsnNo), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1118,\n            columnNumber: 19\n          }\n        }, item.uom), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1119,\n            columnNumber: 19\n          }\n        }, item.onHand), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1120,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"input\", {\n          type: \"number\",\n          value: item.unitPrice,\n          onChange: e => this.handleLineItemChange(idx, 'unitPrice', e.target.value),\n          style: {\n            width: 80\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1121,\n            columnNumber: 21\n          }\n        })), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1128,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"input\", {\n          type: \"number\",\n          min: \"1\",\n          value: item.qty,\n          onChange: e => this.handleLineItemChange(idx, 'qty', e.target.value),\n          style: {\n            width: 60\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1129,\n            columnNumber: 21\n          }\n        })), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1137,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"button\", {\n          type: \"button\",\n          className: \"btn btn-outline-secondary btn-sm btn-rounded btn-icon\",\n          style: {\n            padding: '2px 6px',\n            fontSize: '12px',\n            lineHeight: '1'\n          },\n          onClick: () => this.setState({\n            showTaxOverlay: true,\n            currentTaxLineIdx: idx\n          }),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1138,\n            columnNumber: 19\n          }\n        }, \"+\"), /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            fontSize: '13px',\n            marginTop: '4px'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1146,\n            columnNumber: 19\n          }\n        }, (item.taxGroupNames || []).join(', ') || '-')), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1151,\n            columnNumber: 15\n          }\n        }, parseFloat(item.total || 0).toFixed(2)));\n      })))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1162,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1163,\n          columnNumber: 29\n        }\n      }, \"Page 1 of 1\"))), this.state.activeTab === 'commercial' && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1170,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1171,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1172,\n          columnNumber: 25\n        }\n      }, \"Bill To\"), /*#__PURE__*/React.createElement(\"textarea\", {\n        className: \"form-control form-control-sm\",\n        rows: \"3\",\n        value: formData.billTo,\n        onChange: e => this.handleInputChange('billTo', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1173,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1180,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1181,\n          columnNumber: 25\n        }\n      }, \"Ship To\"), /*#__PURE__*/React.createElement(\"textarea\", {\n        className: \"form-control form-control-sm\",\n        rows: \"3\",\n        value: formData.shipTo,\n        onChange: e => this.handleInputChange('shipTo', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1182,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1190,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1191,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1192,\n          columnNumber: 3\n        }\n      }, \"Despatch Mode\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group input-group-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1193,\n          columnNumber: 3\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        value: formData.despatchMode,\n        readOnly: true,\n        onClick: () => !isFOB && this.showOverlay('despatchMode'),\n        style: {\n          cursor: isFOB ? 'not-allowed' : 'pointer',\n          backgroundColor: '#fff'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1194,\n          columnNumber: 5\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group-append\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1202,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-outline-secondary btn-sm\",\n        type: \"button\",\n        disabled: isFOB,\n        onClick: () => this.showOverlay('despatchMode'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1203,\n          columnNumber: 7\n        }\n      }, \"Select\")))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1215,\n          columnNumber: 1\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1216,\n          columnNumber: 3\n        }\n      }, \"Payment Terms\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group input-group-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1217,\n          columnNumber: 3\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        value: formData.paymentTerms,\n        readOnly: true,\n        onClick: () => !isFOB && this.showOverlay('paymentTerms'),\n        style: {\n          cursor: isFOB ? 'not-allowed' : 'pointer',\n          backgroundColor: '#fff'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1218,\n          columnNumber: 5\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group-append\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1226,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-outline-secondary btn-sm\",\n        type: \"button\",\n        disabled: isFOB,\n        onClick: () => this.showOverlay('paymentTerms'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1227,\n          columnNumber: 7\n        }\n      }, \"Select\")))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1239,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1240,\n          columnNumber: 25\n        }\n      }, \"Freight Charges\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.freightCharges,\n        onChange: e => this.handleInputChange('freightCharges', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1241,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1250,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1251,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1252,\n          columnNumber: 25\n        }\n      }, \"Tax %\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.taxPercent,\n        onChange: e => this.handleInputChange('taxPercent', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1253,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1261,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1262,\n          columnNumber: 25\n        }\n      }, \"Freight Tax Amount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.freighttaxAmount,\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1263,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1270,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1271,\n          columnNumber: 25\n        }\n      }, \"Packing Charges\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.packingCharges,\n        onChange: e => this.handleInputChange('packingCharges', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1272,\n          columnNumber: 25\n        }\n      }))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"fixed-card-footer text-right p-3 border-top bg-white\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1287,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-success mr-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1288,\n          columnNumber: 17\n        }\n      }, \"Save All Details\"), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-secondary\",\n        onClick: () => this.setState({\n          showForm: false,\n          editingId: null\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1289,\n          columnNumber: 17\n        }\n      }, \"Cancel\"))), overlayType && this.renderOverlay(), productOverlayVisible && this.renderProductOverlay(), this.state.showTaxOverlay && this.renderTaxOverlay())));\n    };\n\n    this.renderInvoicePreview = () => {\n      var _q$lineItems;\n\n      const q = this.state.selectedInvoice;\n      if (!q) return null;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card mt-4 full-height p-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1313,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1314,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"card-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1315,\n          columnNumber: 9\n        }\n      }, \"Invoice Preview - \", q.InvoiceNo), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1316,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-sm btn-info mr-2\",\n        onClick: () => this.loadInvoiceForEdit(q),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1317,\n          columnNumber: 11\n        }\n      }, \"Edit\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-sm btn-success\",\n        onClick: () => this.convertToOrder(q),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1318,\n          columnNumber: 11\n        }\n      }, \"Convert to Order\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1321,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1322,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1322,\n          columnNumber: 35\n        }\n      }, \"Customer:\"), \" \", q.customer), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1323,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1323,\n          columnNumber: 35\n        }\n      }, \"Date:\"), \" \", q.InvoiceDate), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1324,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1324,\n          columnNumber: 35\n        }\n      }, \"Status:\"), \" \", q.status)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1326,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1327,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1327,\n          columnNumber: 35\n        }\n      }, \"Bill To:\"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1327,\n          columnNumber: 50\n        }\n      }), q.billTo), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1328,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1328,\n          columnNumber: 35\n        }\n      }, \"Ship To:\"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1328,\n          columnNumber: 50\n        }\n      }), q.shipTo)), /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"mt-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1330,\n          columnNumber: 7\n        }\n      }, \"Line Items\"), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1331,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1332,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1333,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1334,\n          columnNumber: 13\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1334,\n          columnNumber: 31\n        }\n      }, \"Description\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1334,\n          columnNumber: 51\n        }\n      }, \"Qty\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1334,\n          columnNumber: 63\n        }\n      }, \"Unit Price\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1334,\n          columnNumber: 82\n        }\n      }, \"Total\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1337,\n          columnNumber: 9\n        }\n      }, (_q$lineItems = q.lineItems) === null || _q$lineItems === void 0 ? void 0 : _q$lineItems.map((item, i) => /*#__PURE__*/React.createElement(\"tr\", {\n        key: i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1339,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1340,\n          columnNumber: 15\n        }\n      }, item.itemCode), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1341,\n          columnNumber: 15\n        }\n      }, item.itemDescription), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1342,\n          columnNumber: 15\n        }\n      }, item.qty), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1343,\n          columnNumber: 15\n        }\n      }, item.unitPrice), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1344,\n          columnNumber: 15\n        }\n      }, item.total))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1349,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1349,\n          columnNumber: 35\n        }\n      }, \"Total:\"), \" \", q.InvoiceValue), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-secondary mt-3\",\n        onClick: () => this.setState({\n          previewMode: false\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1350,\n          columnNumber: 7\n        }\n      }, \"Back to List\"));\n    };\n  }\n\n  componentDidMount() {\n    var _location$state;\n\n    bsCustomFileInput.init();\n    this.fetchInvoices();\n    this.fetchCustomers();\n    this.fetchProducts();\n    this.fetchDespatchModes();\n    this.fetchPaymentTerms();\n    this.fetchTaxGroups();\n    const location = this.props.location;\n    const invoiceData = location === null || location === void 0 ? void 0 : (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.invoiceDataFromOrder;\n\n    if (invoiceData) {\n      console.log(\"Invoice Data From Order:\", invoiceData); // Merge only matching fields\n\n      const allowedKeys = Object.keys(this.state.formData);\n      const mergedFormData = { ...this.state.formData\n      };\n      allowedKeys.forEach(key => {\n        if (invoiceData.hasOwnProperty(key)) {\n          mergedFormData[key] = invoiceData[key];\n        }\n      }); // Set state and recalculate totals\n\n      this.setState({\n        formData: mergedFormData,\n        showForm: true,\n        previewMode: false,\n        activeTab: 'co'\n      }, () => {\n        if (this.customerInputRef.current) {\n          this.customerInputRef.current.value = mergedFormData.customer || '';\n        }\n\n        this.recalculateInvoiceTotals();\n      });\n    }\n  }\n\n  getTaxDetailsFromGroup(groupName) {\n    if (!groupName || groupName === 'nill' || groupName === 'more') return {\n      totalPercent: 0,\n      totalAmount: 0\n    };\n    const group = this.state.taxGroups.find(tg => tg.groupName === groupName);\n    if (!group || !Array.isArray(group.lineItems)) return {\n      totalPercent: 0,\n      totalAmount: 0\n    };\n    let totalPercent = 0;\n    let totalAmount = 0;\n    group.lineItems.forEach(item => {\n      if (item.type === 'Percentage') {\n        totalPercent += parseFloat(item.percentOrAmt || 0);\n      } else if (item.type === 'Amount') {\n        totalAmount += parseFloat(item.percentOrAmt || 0);\n      }\n    });\n    return {\n      totalPercent,\n      totalAmount\n    };\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (JSON.stringify(prevState.formData.lineItems) !== JSON.stringify(this.state.formData.lineItems)) {\n      this.recalculateInvoiceTotals();\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container-fluid\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1357,\n        columnNumber: 7\n      }\n    }, this.state.previewMode ? this.renderInvoicePreview() : this.state.showForm ? this.renderInvoiceForm() : this.renderInvoiceTable());\n  }\n\n}\n\nexport default withRouter(Invoice);","map":{"version":3,"sources":["C:/Users/College/admin/StarAdmin-Free-React-Admin-Template-master/template/demo_1/src/app/panelone/Invoice.js"],"names":["React","Component","Form","bsCustomFileInput","db","collection","getDocs","addDoc","doc","updateDoc","withRouter","html2canvas","jsPDF","numberToWords","num","a","b","Math","floor","Invoice","state","activeTab","Invoices","customers","products","despatchModes","paymentTerms","showForm","showTaxOverlay","currentTaxLineIdx","editingId","overlayType","overlaySearch","productOverlayVisible","productOverlaySearch","selectedProductIds","selectedTaxGroups","taxComponents","taxGroups","previewMode","selectedInvoice","formData","InvoiceNo","InvoiceDate","Date","toISOString","split","InvoiceType","customer","status","choose","qrefNo","impExp","currency","conversionRate","taxAmount","InvoiceValue","billTo","shipTo","despatchMode","freightCharges","freighttaxAmount","taxPercent","packingCharges","lineItems","customerInputRef","createRef","formatAddress","addr","address","city","country","filter","Boolean","join","zip","handleLineItemChange","idx","field","value","updatedItems","item","setState","taxId","prev","recalculateInvoiceTotals","lineTotal","lineTaxTotal","updatedLineItems","map","qty","parseFloat","unitPrice","baseTotal","groupNames","taxGroupNames","length","taxGroupName","percent","amount","cgst","sgst","igst","forEach","groupName","group","find","t","Array","isArray","comp","val","percentOrAmt","type","name","component","toLowerCase","includes","itemTaxAmt","itemTotal","console","log","itemCode","taxAmt","toFixed","total","freight","packing","freightPercent","freightTaxAmount","totalTaxAmount","resetFOBFields","needsReset","some","undefined","fetchTaxGroups","snap","data","docs","id","fetchInvoices","reverse","fetchCustomers","fetchProducts","fetchDespatchModes","fetchPaymentTerms","handleInputChange","handleSubmit","e","preventDefault","alert","loadInvoicePreview","q","getTaxPercentage","tax","tc","percentage","loadInvoiceForEdit","current","convertToOrder","sessionStorage","setItem","JSON","stringify","props","history","push","showInvoicePDFWithOrg","orgSnap","org","c","custshortName","enrichedItems","product","p","productId","ptshortName","hsnCode","uom","stockingUOM","subtotal","reduce","sum","freightTax","grandTotal","amountWords","taxBreakdown","base","key","container","document","createElement","style","width","padding","fontFamily","innerHTML","logoUrl","bgName","email","website","gstin","replace","contactPerson","phone","gstParts","gstLabel","itemDescription","toLocaleString","body","appendChild","canvas","scale","useCORS","imgData","toDataURL","pdf","height","addImage","blob","output","url","URL","createObjectURL","newWin","window","open","write","close","removeChild","toggleTaxGroupSelection","lineIdx","isChecked","g","gname","tg","l","totalTaxPercent","showOverlay","hideOverlay","selectOverlayValue","custname","custcode","renderTaxOverlay","selected","Set","position","zIndex","top","left","background","border","boxShadow","maxHeight","overflowY","has","target","checked","li","renderOverlay","getFilteredRows","list","nameKey","codeKey","handleSelect","title","headers","rows","h","i","cursor","j","shortName","renderProductOverlay","filtered","ptdescription","selectedProducts","itemType","materialType","onHand","taxGroup","custPartNo","hsnNo","renderInvoiceTable","fontSize","color","renderInvoiceForm","isFOB","flex","backgroundColor","taxDetails","getTaxDetailsFromGroup","totalPercent","totalAmount","totalWithTax","lineHeight","marginTop","renderInvoicePreview","componentDidMount","init","location","invoiceData","invoiceDataFromOrder","allowedKeys","Object","keys","mergedFormData","hasOwnProperty","componentDidUpdate","prevProps","prevState","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Form } from 'react-bootstrap';\r\nimport bsCustomFileInput from 'bs-custom-file-input';\r\nimport { db } from '../../firebase';\r\nimport { collection, getDocs, addDoc, doc, updateDoc } from 'firebase/firestore';\r\nimport { withRouter } from 'react-router-dom';\r\nimport html2canvas from 'html2canvas';\r\nimport { jsPDF } from 'jspdf';\r\n\r\n\r\nconst numberToWords = (num) => {\r\n  const a = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine',\r\n    'Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen',\r\n    'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];\r\n  const b = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];\r\n\r\n  if (num === 0) return 'Zero';\r\n  if (num < 20) return a[num];\r\n  if (num < 100) return b[Math.floor(num / 10)] + ' ' + a[num % 10];\r\n  if (num < 1000)\r\n    return a[Math.floor(num / 100)] + ' Hundred ' + numberToWords(num % 100);\r\n  if (num < 100000)\r\n    return numberToWords(Math.floor(num / 1000)) + ' Thousand ' + numberToWords(num % 1000);\r\n  return 'Amount too large';\r\n};\r\n\r\n\r\nclass Invoice extends Component {\r\n  state = {\r\n    activeTab: 'co',\r\n    Invoices: [],\r\n    customers: [],\r\n    products: [],\r\n    despatchModes: [],\r\n    paymentTerms: [],\r\n    showForm: false,\r\n    showTaxOverlay: false,\r\n    currentTaxLineIdx: null,\r\n    editingId: null,\r\n    overlayType: '',\r\n    overlaySearch: '',\r\n    productOverlayVisible: false,\r\n    productOverlaySearch: '',\r\n    selectedProductIds: [],\r\n    selectedTaxGroups: [],\r\n    taxComponents: [],\r\n    taxGroups:[],\r\n    previewMode: false,\r\n    selectedInvoice: null,\r\n    formData: {\r\n      InvoiceNo: '',\r\n      InvoiceDate: new Date().toISOString().split('T')[0],\r\n      InvoiceType: 'Standard',\r\n      customer: '',\r\n      status: 'Entered', // Static 'Entered'\r\n      choose: 'Service',\r\n      qrefNo: '',\r\n      impExp: 'None',\r\n      currency: '',\r\n      conversionRate: '',\r\n      taxAmount: '',\r\n      InvoiceValue: '',\r\n      billTo: '',\r\n      shipTo: '',\r\n      despatchMode: 'By Air',\r\n      paymentTerms: '',\r\n      freightCharges: '',\r\n      freighttaxAmount: '',\r\n      taxPercent: '',\r\n      packingCharges: '',\r\n      lineItems: [],\r\n    }\r\n  };\r\n  customerInputRef = React.createRef();\r\n\r\n  // Helper to format address for Bill To / Ship To\r\n  formatAddress = (addr) => {\r\n    if (!addr) return '';\r\n    if (typeof addr === 'string') return addr;\r\n    return [\r\n      addr.address,\r\n      [addr.city, addr.state, addr.country].filter(Boolean).join(', '),\r\n      addr.zip\r\n    ].filter(Boolean).join('\\n');\r\n  };\r\n\r\n  componentDidMount() {\r\n  bsCustomFileInput.init();\r\n  this.fetchInvoices();\r\n  this.fetchCustomers();\r\n  this.fetchProducts();\r\n  this.fetchDespatchModes();\r\n  this.fetchPaymentTerms();\r\n  this.fetchTaxGroups();\r\n\r\n  const location = this.props.location;\r\n  const invoiceData = location?.state?.invoiceDataFromOrder;\r\n\r\n  if (invoiceData) {\r\n    console.log(\"Invoice Data From Order:\", invoiceData);\r\n\r\n    // Merge only matching fields\r\n    const allowedKeys = Object.keys(this.state.formData);\r\n    const mergedFormData = { ...this.state.formData };\r\n\r\n    allowedKeys.forEach((key) => {\r\n      if (invoiceData.hasOwnProperty(key)) {\r\n        mergedFormData[key] = invoiceData[key];\r\n      }\r\n    });\r\n\r\n    // Set state and recalculate totals\r\n    this.setState(\r\n      {\r\n        formData: mergedFormData,\r\n        showForm: true,\r\n        previewMode: false,\r\n        activeTab: 'co'\r\n      },\r\n      () => {\r\n        if (this.customerInputRef.current) {\r\n          this.customerInputRef.current.value = mergedFormData.customer || '';\r\n        }\r\n        this.recalculateInvoiceTotals();\r\n      }\r\n    );\r\n  }\r\n}\r\n\r\ngetTaxDetailsFromGroup(groupName) {\r\n  if (!groupName || groupName === 'nill' || groupName === 'more') return { totalPercent: 0, totalAmount: 0 };\r\n\r\n  const group = this.state.taxGroups.find(tg => tg.groupName === groupName);\r\n  if (!group || !Array.isArray(group.lineItems)) return { totalPercent: 0, totalAmount: 0 };\r\n\r\n  let totalPercent = 0;\r\n  let totalAmount = 0;\r\n\r\n  group.lineItems.forEach(item => {\r\n    if (item.type === 'Percentage') {\r\n      totalPercent += parseFloat(item.percentOrAmt || 0);\r\n    } else if (item.type === 'Amount') {\r\n      totalAmount += parseFloat(item.percentOrAmt || 0);\r\n    }\r\n  });\r\n\r\n  return { totalPercent, totalAmount };\r\n}\r\n\r\n\r\n\r\nhandleLineItemChange = (idx, field, value) => {\r\n  const updatedItems = [...this.state.formData.lineItems];\r\n  const item = { ...updatedItems[idx] };\r\n\r\n  if (field === 'taxId') {\r\n    if (value === 'more') {\r\n      this.setState({ showTaxOverlay: true });\r\n      return;\r\n    }\r\n    item.taxId = value;\r\n  } else {\r\n    item[field] = value;\r\n  }\r\n\r\n  updatedItems[idx] = item;\r\n\r\n  this.setState(prev => ({\r\n    formData: {\r\n      ...prev.formData,\r\n      lineItems: updatedItems\r\n    }\r\n  }), this.recalculateInvoiceTotals);\r\n};\r\n\r\nrecalculateInvoiceTotals = () => {\r\n  const { lineItems, freightCharges, packingCharges, taxPercent } = this.state.formData;\r\n\r\n  let lineTotal = 0;\r\n  let lineTaxTotal = 0;\r\n\r\n  const updatedLineItems = lineItems.map(item => {\r\n    const qty = parseFloat(item.qty || 1);\r\n    const unitPrice = parseFloat(item.unitPrice || 0);\r\n    const baseTotal = unitPrice * qty;\r\n\r\n   const groupNames = item.taxGroupNames?.length ? item.taxGroupNames : [item.taxGroupName || item.taxId || ''];\r\n\r\n    let percent = 0;\r\n    let amount = 0;\r\n    let cgst = 0, sgst = 0, igst = 0;\r\n\r\n    groupNames.forEach(groupName => {\r\n      const group = this.state.taxGroups.find(t => t.groupName === groupName);\r\n      if (group && Array.isArray(group.lineItems)) {\r\n        group.lineItems.forEach(comp => {\r\n          const val = parseFloat(comp.percentOrAmt || 0);\r\n          if (comp.type === 'Percentage') {\r\n            percent += val;\r\n            const name = comp.component.toLowerCase();\r\n            if (name.includes('cgst')) cgst += val;\r\n            if (name.includes('sgst')) sgst += val;\r\n            if (name.includes('igst')) igst += val;\r\n          } else if (comp.type === 'Amount') {\r\n            amount += val;\r\n          }\r\n        });\r\n      }\r\n    });\r\n\r\n\r\n    // Total tax = percentage tax + fixed amount tax\r\n    const itemTaxAmt = (baseTotal * percent) / 100 + amount;\r\n    const itemTotal = baseTotal + itemTaxAmt;\r\n\r\n    lineTotal += baseTotal;\r\n    lineTaxTotal += itemTaxAmt;\r\n    console.log('Item:', item.itemCode, 'GroupNames:', groupNames, 'Tax %:', percent, 'Tax Amt:', itemTaxAmt);\r\n\r\n\r\n    return {\r\n      ...item,\r\n      cgst,\r\n      sgst,\r\n      igst,\r\n      taxAmt: itemTaxAmt.toFixed(2),\r\n      total: itemTotal.toFixed(2)\r\n    };\r\n  });\r\n\r\n  // Freight + Freight Tax\r\n  const freight = parseFloat(freightCharges || 0);\r\n  const packing = parseFloat(packingCharges || 0);\r\n  const freightPercent = parseFloat(taxPercent || 0);\r\n  const freightTaxAmount = (freight * freightPercent) / 100;\r\n\r\n  // Final tax and Invoice value\r\n  const totalTaxAmount = lineTaxTotal + freightTaxAmount;\r\n  const InvoiceValue = lineTotal + lineTaxTotal + freight + packing + freightTaxAmount;\r\n\r\n  // Set final state\r\n  this.setState(prev => ({\r\n    formData: {\r\n      ...prev.formData,\r\n      lineItems: updatedLineItems,\r\n      freighttaxAmount: freightTaxAmount.toFixed(2),\r\n      taxAmount: totalTaxAmount.toFixed(2),\r\n      InvoiceValue: InvoiceValue.toFixed(2)\r\n    }\r\n  }));\r\n};\r\n\r\n\r\nresetFOBFields = () => {\r\n  const { freightCharges, taxPercent, taxAmount, packingCharges, InvoiceValue } = this.state.formData;\r\n  const needsReset = [freightCharges, taxPercent, taxAmount, packingCharges, InvoiceValue]\r\n    .some(val => val !== '' && val !== null && val !== undefined);\r\n\r\n  if (needsReset) {\r\n    this.setState(prev => ({\r\n      formData: {\r\n        ...prev.formData,\r\n        freightCharges: '',\r\n        taxPercent: '',\r\n        taxAmount: '',\r\n        packingCharges: '',\r\n        InvoiceValue: ''\r\n      }\r\n    }));\r\n  }\r\n};\r\n\r\ncomponentDidUpdate(prevProps, prevState) {\r\n  if (JSON.stringify(prevState.formData.lineItems) !== JSON.stringify(this.state.formData.lineItems)) {\r\n    this.recalculateInvoiceTotals();\r\n  }\r\n}\r\nfetchTaxGroups = async () => {\r\n  const snap = await getDocs(collection(db, 'taxGroups'));\r\n  const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n  this.setState({ taxGroups: data });\r\n};\r\n\r\n\r\n  fetchInvoices = async () => {\r\n    const snap = await getDocs(collection(db, 'Invoices'));\r\n    const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    this.setState({ Invoices: data.reverse() });\r\n  };\r\n\r\n  fetchCustomers = async () => {\r\n    const snap = await getDocs(collection(db, 'customers'));\r\n    const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    this.setState({ customers: data });\r\n  };\r\n\r\n  fetchProducts = async () => {\r\n    const snap = await getDocs(collection(db, 'products'));\r\n    const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    this.setState({ products: data });\r\n  };\r\n  fetchDespatchModes = async () => {\r\n  const snap = await getDocs(collection(db, 'modes'));\r\n  const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n  this.setState({ despatchModes: data });\r\n};\r\n\r\nfetchPaymentTerms = async () => {\r\n  const snap = await getDocs(collection(db, 'paymentTerms'));\r\n  const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n  this.setState({ paymentTerms: data });\r\n};\r\n\r\n\r\n  handleInputChange = (field, value) => {\r\n  this.setState(prev => ({\r\n    formData: { ...prev.formData, [field]: value }\r\n  }), () => {\r\n    if (['freightCharges', 'taxPercent', 'packingCharges'].includes(field)) {\r\n      this.recalculateInvoiceTotals();\r\n    }\r\n  });\r\n};\r\n\r\n\r\n  handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const { editingId, formData, Invoices } = this.state;\r\n    if (!formData.customer) return alert(\"Customer is required\");\r\n    if (formData.lineItems.length === 0) return alert(\"At least one line item is required\");\r\n\r\n    if (editingId) {\r\n      await updateDoc(doc(db, 'Invoices', editingId), formData);\r\n    } else {\r\n      formData.InvoiceNo = `IN${1000 + Invoices.length}`;\r\n      await addDoc(collection(db, 'Invoices'), formData);\r\n    }\r\n    this.setState({ showForm: false, editingId: null });\r\n    this.fetchInvoices();\r\n  };\r\nloadInvoicePreview = (q) => {\r\n  this.setState({\r\n    selectedInvoice: q,\r\n    previewMode: true\r\n  });\r\n};\r\ngetTaxPercentage = (taxId) => {\r\n  if (!taxId || taxId === 'nill') return 0;\r\n  const tax = this.state.taxComponents.find(tc => tc.id === taxId);\r\n  return tax?.percentage || 0;\r\n};\r\n\r\n\r\n  loadInvoiceForEdit = (Invoice) => {\r\n    this.setState({\r\n      formData: {\r\n        ...Invoice,\r\n        lineItems: Array.isArray(Invoice.lineItems) ? Invoice.lineItems : [] // Ensure array\r\n      },\r\n      editingId: Invoice.id,\r\n      showForm: true,\r\n      previewMode: false,\r\n      activeTab: 'co'\r\n    }, () => {\r\n      if (this.customerInputRef.current) {\r\n        this.customerInputRef.current.value = Invoice.customer;\r\n      }\r\n    });\r\n  };\r\nconvertToOrder = (Invoice) => {\r\n  // Save Invoice in sessionStorage (or navigate with state via router if you use react-router)\r\n  sessionStorage.setItem('InvoiceToConvert', JSON.stringify(Invoice));\r\n this.props.history.push('/panelone/Order');\r\n};\r\n// âœ… FULL UPDATED PDF FUNCTION â€” showInvoicePDFWithOrg()\r\n\r\nshowInvoicePDFWithOrg = async (Invoice) => {\r\n  if (!Invoice || !Array.isArray(Invoice.lineItems) || Invoice.lineItems.length === 0) {\r\n    alert(\"Invoice data is incomplete.\");\r\n    return;\r\n  }\r\n\r\n  const orgSnap = await getDocs(collection(db, 'businessGroups'));\r\n  const org = orgSnap.docs[0]?.data() || {};\r\n  const customer = this.state.customers.find(c => c.custshortName === Invoice.customer) || {};\r\n\r\n  const enrichedItems = Invoice.lineItems.map(item => {\r\n    const product = this.state.products.find(p => p.productId === item.itemCode) || {};\r\n    return {\r\n      ...item,\r\n      ptshortName: product.ptshortName || '',\r\n      hsnCode: product.hsnCode || '',\r\n      uom: product.stockingUOM || '',\r\n      cgst: item.cgst || 0,\r\n      sgst: item.sgst || 0,\r\n      igst: item.igst || 0\r\n    };\r\n  });\r\n\r\n  // Calculate subtotal based on item.total\r\n  const subtotal = enrichedItems.reduce((sum, item) => sum + (parseFloat(item.total) || 0), 0);\r\n  const freightCharges = parseFloat(Invoice.freightCharges || 0);\r\n  const freightTax = parseFloat(Invoice.freighttaxAmount || 0);\r\n  const totalTaxAmount = parseFloat(Invoice.taxAmount || 0);\r\n  const grandTotal = parseFloat(Invoice.InvoiceValue || (subtotal + totalTaxAmount));\r\n  const amountWords = `INR ${numberToWords(Math.floor(grandTotal))} Only`;\r\n\r\n  // Build tax group breakdown\r\n  let taxBreakdown = {};\r\n  enrichedItems.forEach(item => {\r\n    const qty = parseFloat(item.qty || 0);\r\n    const unitPrice = parseFloat(item.unitPrice || 0);\r\n    const base = qty * unitPrice;\r\n\r\n    if (item.cgst) {\r\n      const key = `CGST ${item.cgst}%`;\r\n      taxBreakdown[key] = (taxBreakdown[key] || 0) + (base * item.cgst) / 100;\r\n    }\r\n    if (item.sgst) {\r\n      const key = `SGST ${item.sgst}%`;\r\n      taxBreakdown[key] = (taxBreakdown[key] || 0) + (base * item.sgst) / 100;\r\n    }\r\n    if (item.igst) {\r\n      const key = `IGST ${item.igst}%`;\r\n      taxBreakdown[key] = (taxBreakdown[key] || 0) + (base * item.igst) / 100;\r\n    }\r\n  });\r\n  if (freightTax > 0) taxBreakdown[\"Freight Tax\"] = freightTax;\r\n\r\n  const container = document.createElement('div');\r\n  container.id = 'pdf-preview-container';\r\n  container.style.width = '794px';\r\n  container.style.padding = '40px';\r\n  container.style.fontFamily = 'Arial';\r\n\r\n  container.innerHTML = `\r\n    <div style=\"display:flex; justify-content:space-between; align-items:center;\">\r\n      <img src=\"${org.logoUrl || ''}\" style=\"height:50px;\" />\r\n      <div style=\"font-size:18px; font-weight:bold;\">QUOTATION</div>\r\n    </div>\r\n    <hr/>\r\n    <div style=\"display:flex; justify-content:space-between; font-size:11px;\">\r\n      <div style=\"line-height:1.5; width:50%;\">\r\n        <b>${org.bgName || ''}</b><br/>\r\n        ${org.address || ''}<br/>\r\n        <b>Email:</b> ${org.email || ''}<br/>\r\n        <b>Website:</b> ${org.website || ''}<br/>\r\n        <b>GSTIN:</b> ${org.gstin || ''}\r\n      </div>\r\n      <table style=\"font-size:11px; text-align:left;\">\r\n        <tr><td><b>Invoice No</b></td><td>: ${Invoice.InvoiceNo}</td></tr>\r\n        <tr><td><b>Invoice Date</b></td><td>: ${Invoice.InvoiceDate}</td></tr>\r\n        <tr><td><b>Currency</b></td><td>: ${Invoice.currency || 'INR'}</td></tr>\r\n        <tr><td><b>Despatch</b></td><td>: ${Invoice.despatchMode || ''}</td></tr>\r\n      </table>\r\n    </div>\r\n\r\n    <div style=\"margin-top:15px; display:flex; justify-content:space-between; font-size:11px;\">\r\n      <div style=\"width:48%;\">\r\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Bill To</b>\r\n        <div style=\"border:1px solid #ccc; padding:6px;\">\r\n         <b>${Invoice.customer || ''}</b><br/>\r\n          ${Invoice.billTo?.replace(/\\n/g, '<br/>') || ''}\r\n        </div>\r\n        <div style=\"font-size:10px; margin-top:6px;\">\r\n            <b>GSTIN:</b> ${customer.gstin || ''}<br/>\r\n            <b>Email:</b> ${customer.email || ''}<br/>\r\n            <b>Contact:</b> ${customer.contactPerson || ''}<br/>\r\n            <b>Phone:</b> ${customer.phone || ''}\r\n        </div>\r\n      </div>\r\n      <div style=\"width:48%;\">\r\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Ship To</b>\r\n        <div style=\"border:1px solid #ccc; padding:6px;\">\r\n         <b>${Invoice.customer || ''}</b><br/>\r\n          ${Invoice.shipTo?.replace(/\\n/g, '<br/>') || ''}\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:10px;\">\r\n  <thead>\r\n    <tr style=\"background:#f4f6fa;\">\r\n      <th style=\"border:1px solid #011b56;\">Item Code</th>\r\n      <th style=\"border:1px solid #011b56;\">Short</th>\r\n      <th style=\"border:1px solid #011b56;\">Description</th>\r\n      <th style=\"border:1px solid #011b56;\">HSN</th>\r\n      <th style=\"border:1px solid #011b56;\">UOM</th>\r\n      <th style=\"border:1px solid #011b56;\">Qty</th>\r\n      <th style=\"border:1px solid #011b56;\">Unit Price</th>\r\n      <th style=\"border:1px solid #011b56;\">GST%</th>\r\n      <th style=\"border:1px solid #011b56;\">Item Total</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    ${enrichedItems.map(item => {\r\n      const gstParts = [];\r\n      if (item.cgst) gstParts.push(`CGST ${item.cgst}%`);\r\n      if (item.sgst) gstParts.push(`SGST ${item.sgst}%`);\r\n      if (item.igst) gstParts.push(`IGST ${item.igst}%`);\r\n      const gstLabel = gstParts.length ? gstParts.join(' + ') : '-';\r\n\r\n      return `\r\n        <tr>\r\n          <td style=\"border:1px solid #011b56;\">${item.itemCode}</td>\r\n          <td style=\"border:1px solid #011b56;\">${item.ptshortName}</td>\r\n          <td style=\"border:1px solid #011b56;\">${item.itemDescription}</td>\r\n          <td style=\"border:1px solid #011b56;\">${item.hsnCode}</td>\r\n          <td style=\"border:1px solid #011b56;\">${item.uom}</td>\r\n          <td style=\"border:1px solid #011b56;\">${item.qty}</td>\r\n          <td style=\"border:1px solid #011b56;\">${item.unitPrice}</td>\r\n          <td style=\"border:1px solid #011b56;\">${gstLabel}</td>\r\n          <td style=\"border:1px solid #011b56;\">${item.total}</td>\r\n        </tr>`;\r\n    }).join('')}\r\n\r\n        <tr><td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td><td style=\"border:1px solid #011b56;\"><b>${totalTaxAmount.toFixed(2)}</b></td></tr>\r\n        <tr><td colspan=\"7\" style=\"text-align:right; border:1px solid #011b56;\"><b>Grand Total</b></td><td style=\"border:1px solid #011b56;\"><b>${grandTotal.toFixed(2)}</b></td></tr>\r\n      </tbody>\r\n    </table>\r\n\r\n    <div style=\"margin-top:8px; font-size:11px;\"><b>Amount in Words:</b> ${amountWords}</div>\r\n    <div style=\"text-align:right; font-size:11px; margin-top:30px;\">For ${org.bgName}<br/><br/><br/>Authorized Signatory</div>\r\n    <div style=\"margin-top:20px; text-align:right; font-size:10px;\">Printed on ${new Date().toLocaleString()}</div>\r\n  `;\r\n\r\n  document.body.appendChild(container);\r\n  const canvas = await html2canvas(container, { scale: 2, useCORS: true });\r\n  const imgData = canvas.toDataURL('image/png');\r\n  const pdf = new jsPDF('p', 'pt', 'a4');\r\n  const width = 595.28;\r\n  const height = canvas.height * width / canvas.width;\r\n  pdf.addImage(imgData, 'PNG', 0, 0, width, height);\r\n\r\n  const blob = pdf.output('blob');\r\n  const url = URL.createObjectURL(blob);\r\n  const newWin = window.open();\r\n  newWin.document.write(`\r\n    <html><head><title>Invoice PDF Preview</title></head>\r\n    <body style=\"margin:0;\">\r\n      <iframe width=\"100%\" height=\"100%\" style=\"border:none;\" src=\"${url}\"></iframe>\r\n      <button onclick=\"document.querySelector('iframe').contentWindow.print()\" style=\"position:fixed;top:10px;right:110px;\"></button>\r\n      <a href=\"${url}\" download=\"Invoice_${Invoice.InvoiceNo || 'PDF'}.pdf\" style=\"position:fixed;top:10px;right:10px;\"></a>\r\n    </body></html>\r\n  `);\r\n  newWin.document.close();\r\n  document.body.removeChild(container);\r\n};\r\n\r\n\r\ntoggleTaxGroupSelection = (groupName, lineIdx, isChecked) => {\r\n  const formData = { ...this.state.formData };\r\n  const item = formData.lineItems[lineIdx];\r\n\r\n  if (!item.taxGroupNames) item.taxGroupNames = [];\r\n\r\n  if (isChecked) {\r\n    if (!item.taxGroupNames.includes(groupName)) {\r\n      item.taxGroupNames.push(groupName);\r\n    }\r\n  } else {\r\n    item.taxGroupNames = item.taxGroupNames.filter(g => g !== groupName);\r\n  }\r\n\r\n  // Recalculates individual tax fields â€” but not totals\r\n  let cgst = 0, sgst = 0, igst = 0;\r\n  item.taxGroupNames.forEach(gname => {\r\n    const tg = this.state.taxGroups.find(t => t.groupName === gname);\r\n    if (tg) {\r\n      tg.lineItems.forEach(l => {\r\n        const comp = l.component.toLowerCase();\r\n        const val = parseFloat(l.percentOrAmt || 0);\r\n        if (comp.includes('cgst')) cgst += val;\r\n        if (comp.includes('sgst')) sgst += val;\r\n        if (comp.includes('igst')) igst += val;\r\n      });\r\n    }\r\n  });\r\n\r\n  const itemTotal = item.unitPrice * item.qty;\r\n  const totalTaxPercent = cgst + sgst + igst;\r\n  const taxAmt = (itemTotal * totalTaxPercent) / 100;\r\n\r\n  item.cgst = cgst;\r\n  item.sgst = sgst;\r\n  item.igst = igst;\r\n  item.taxAmt = taxAmt;\r\n  item.total = itemTotal + taxAmt;\r\n\r\n  this.setState({ formData }, () => this.recalculateInvoiceTotals());\r\n};\r\n\r\n\r\n\r\n\r\n  showOverlay = (type) => this.setState({ overlayType: type, overlaySearch: '' });\r\n  hideOverlay = () => this.setState({ overlayType: '', overlaySearch: '' });\r\n\r\n\r\n  selectOverlayValue = (value) => {\r\n    if (this.state.overlayType === 'customer') {\r\n      this.setState(prev => ({\r\n        formData: {\r\n          ...prev.formData,\r\n          customer: value.custname || value.custcode || '', // Use custname or custcode\r\n          billTo: this.formatAddress(value.billTo),\r\n          shipTo: this.formatAddress(value.shipTo),\r\n          currency: value.currency || '',\r\n          // despatchMode: value.despatchMode || '', // No auto-fill for despatch mode\r\n          // paymentTerms: value.paymentTerms || '' // No auto-fill for payment terms\r\n        },\r\n        overlayType: '',\r\n        overlaySearch: ''\r\n      }), () => {\r\n        if (this.customerInputRef.current) {\r\n          this.customerInputRef.current.value = value.custname || value.custcode || '';\r\n        }\r\n      });\r\n    }\r\n  };\r\nrenderTaxOverlay = () => {\r\n  const { taxGroups, currentTaxLineIdx, formData } = this.state;\r\n  if (currentTaxLineIdx === null) return null;\r\n\r\n  const item = formData.lineItems[currentTaxLineIdx];\r\n  const selected = new Set(item.taxGroupNames || []);\r\n\r\n  return (\r\n    <div style={{\r\n      position: 'absolute',\r\n      zIndex: 9999,\r\n      top: '10%',\r\n      left: '20%',\r\n      background: '#fff',\r\n      border: '1px solid #ccc',\r\n      padding: '20px',\r\n      boxShadow: '0 0 10px rgba(0,0,0,0.3)',\r\n      width: '800px',\r\n      maxHeight: '60vh',\r\n      overflowY: 'auto'\r\n    }}>\r\n      <h5>Select Tax Groups</h5>\r\n      <table className=\"table table-sm table-bordered\">\r\n        <thead>\r\n          <tr><th></th><th>Group</th><th>Type</th><th>%</th></tr>\r\n        </thead>\r\n        <tbody>\r\n          {taxGroups.map(tg => (\r\n            <tr key={tg.groupName}>\r\n              <td>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={selected.has(tg.groupName)}\r\n                  onChange={e => this.toggleTaxGroupSelection(tg.groupName, currentTaxLineIdx, e.target.checked)}\r\n                />\r\n              </td>\r\n              <td>{tg.groupName}</td>\r\n              <td>{tg.lineItems.map(li => li.component).join(', ')}</td>\r\n              <td>{tg.lineItems.map(li => li.percentOrAmt).join(', ')}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n      <div className=\"text-right mt-2\">\r\n        <button type=\"button\" className=\"btn btn-sm btn-primary\" onClick={() => this.setState({ showTaxOverlay: false })}>\r\n          Done\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\n\r\n renderOverlay = () => {\r\n  const { overlayType, overlaySearch, customers, despatchModes, paymentTerms } = this.state;\r\n\r\n  const getFilteredRows = (list, nameKey = 'name', codeKey = 'shortName') =>\r\n    list.filter(item =>\r\n      (item[nameKey] || '').toLowerCase().includes((overlaySearch || '').toLowerCase()) ||\r\n      (item[codeKey] || '').toLowerCase().includes((overlaySearch || '').toLowerCase())\r\n    );\r\n\r\n  const handleSelect = (item) => {\r\n    if (overlayType === 'customer') {\r\n      this.selectOverlayValue(item);\r\n    } else if (overlayType === 'despatchMode') {\r\n      this.setState(prev => ({\r\n        formData: {\r\n          ...prev.formData,\r\n          despatchMode: item.name\r\n        },\r\n        overlayType: '',\r\n        overlaySearch: ''\r\n      }));\r\n    } else if (overlayType === 'paymentTerms') {\r\n      this.setState(prev => ({\r\n        formData: {\r\n          ...prev.formData,\r\n          paymentTerms: item.name\r\n        },\r\n        overlayType: '',\r\n        overlaySearch: ''\r\n      }));\r\n    }\r\n  };\r\n\r\n  let title = '';\r\n  let headers = [];\r\n  let rows = [];\r\n\r\n  if (overlayType === 'customer') {\r\n    title = 'Select Customer';\r\n    headers = ['Name', 'Code', 'Short Name'];\r\n    rows = getFilteredRows(customers, 'custname', 'custcode');\r\n  } else if (overlayType === 'despatchMode') {\r\n    title = 'Select Despatch Mode';\r\n    headers = ['Name', 'Short Name'];\r\n    rows = getFilteredRows(despatchModes);\r\n  } else if (overlayType === 'paymentTerms') {\r\n    title = 'Select Payment Terms';\r\n    headers = ['Name', 'Short Name'];\r\n    rows = getFilteredRows(paymentTerms);\r\n  } else {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"custom-overlay\">\r\n      <div className=\"custom-overlay-content\">\r\n        <div className=\"custom-overlay-title\">{title}</div>\r\n        <input\r\n          type=\"text\"\r\n          className=\"form-control mb-2\"\r\n          placeholder={`Search ${overlayType}...`}\r\n          value={overlaySearch}\r\n          onChange={e => this.setState({ overlaySearch: e.target.value })}\r\n        />\r\n        <div style={{ maxHeight: 300, overflowY: 'auto' }}>\r\n          <table className=\"table table-bordered table-sm\">\r\n            <thead>\r\n              <tr>\r\n                {headers.map((h, i) => <th key={i}>{h}</th>)}\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {rows.map((item, i) => (\r\n                <tr key={item.id || i} onClick={() => handleSelect(item)} style={{ cursor: 'pointer' }}>\r\n                  {headers.map((h, j) => (\r\n                    <td key={j}>\r\n                      {overlayType === 'customer'\r\n                        ? h === 'Name' ? item.custname\r\n                          : h === 'Code' ? item.custcode\r\n                          : item.custshortName\r\n                        : h === 'Name' ? item.name\r\n                          : item.shortName}\r\n                    </td>\r\n                  ))}\r\n                </tr>\r\n              ))}\r\n              {rows.length === 0 && (\r\n                <tr>\r\n                  <td colSpan={headers.length} className=\"text-center\">No records found</td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <button className=\"btn btn-secondary btn-sm mt-2\" onClick={this.hideOverlay}>Cancel</button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n  renderProductOverlay = () => {\r\n    const { products, productOverlaySearch, selectedProductIds } = this.state;\r\n    const filtered = products.filter(p =>\r\n      (p.ptshortName || '').toLowerCase().includes(productOverlaySearch.toLowerCase()) ||\r\n      (p.ptdescription || '').toLowerCase().includes(productOverlaySearch.toLowerCase()) ||\r\n      (p.itemCode || '').toLowerCase().includes(productOverlaySearch.toLowerCase())\r\n    );\r\n    return (\r\n      <div className=\"custom-overlay\">\r\n        <div className=\"custom-overlay-content\">\r\n          <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n            <div className=\"custom-overlay-title\">Select Products</div>\r\n            <button\r\n              className=\"btn btn-success btn-sm\"\r\n              onClick={() => {\r\n                const selectedProducts = products.filter(p => this.state.selectedProductIds.includes(p.id));\r\n                this.setState(prev => ({\r\n                  formData: {\r\n                    ...prev.formData,\r\n                    lineItems: [\r\n                      ...prev.formData.lineItems,\r\n                      ...selectedProducts\r\n                        .filter(p => !prev.formData.lineItems.some(item => item.id === p.id))\r\n                        .map(p => ({\r\n                          id: p.id,\r\n                          itemCode: p.productId || '',\r\n                          itemDescription: p.ptdescription || '',\r\n                          itemType: p.itemType || '',\r\n                          materialType: p.materialType || '',\r\n                          onHand: p.onHand || 0,\r\n                          taxGroup: p.taxGroup || '',\r\n                          taxGroupName: p.taxGroup || '',\r\n                          custPartNo: p.custPartNo || '', \r\n                          hsnNo: p.hsnNo || '',\r\n                          unitPrice: p.unitPrice || 0,\r\n                          qty: 1,\r\n                          total: (p.unitPrice || 0).toFixed(2)\r\n                        }))\r\n                    ]\r\n                  },\r\n                  productOverlayVisible: false,\r\n                  selectedProductIds: []\r\n                }));\r\n              }}\r\n            >Add Selected</button>\r\n          </div>\r\n          <input\r\n            type=\"text\"\r\n            className=\"form-control mb-2\"\r\n            placeholder=\"Search products...\"\r\n            value={productOverlaySearch}\r\n            onChange={e => this.setState({ productOverlaySearch: e.target.value })}\r\n          />\r\n          <div style={{ maxHeight: 300, overflowY: 'auto' }}>\r\n            <table className=\"table table-bordered table-sm\">\r\n              <thead>\r\n                <tr>\r\n                  <th></th>\r\n                  <th>Item Code</th>\r\n                  <th>Item Desc</th>\r\n                  <th>Item Type</th>\r\n                  <th>Material Type</th>\r\n                  <th>On Hand</th>\r\n                  <th>Tax Grp</th>\r\n                  <th>Cust Part No</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {filtered.map(p => (\r\n                  <tr key={p.id}>\r\n                    <td>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedProductIds.includes(p.id)}\r\n                        onChange={e => {\r\n                          const checked = e.target.checked;\r\n                          this.setState(prev => ({\r\n                            selectedProductIds: checked\r\n                              ? [...prev.selectedProductIds, p.id]\r\n                              : prev.selectedProductIds.filter(id => id !== p.id)\r\n                          }));\r\n                        }}\r\n                      />\r\n                    </td>\r\n                    <td>{p.productId}</td>\r\n                    <td>{p.ptdescription || ''}</td>\r\n                    <td>{p.itemType || ''}</td>\r\n                    <td>{p.materialType || ''}</td>\r\n                    <td>{p.onHand || 0}</td>\r\n                    <td>{p.taxGroup || ''}</td>\r\n                    <td>{p.custPartNo || ''}</td>\r\n                  </tr>\r\n                ))}\r\n                {filtered.length === 0 && (\r\n                  <tr>\r\n                    <td colSpan=\"8\" className=\"text-center\">No products found</td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          {/* Add pagination here if needed, for now, it's just a placeholder */}\r\n          <div className=\"d-flex justify-content-between align-items-center mt-2\">\r\n            <span>Page 1 of 1</span>\r\n            <button className=\"btn btn-secondary btn-sm\" onClick={() => this.setState({ productOverlayVisible: false, selectedProductIds: [] })}>Cancel</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n\r\n\r\n  renderInvoiceTable = () => (\r\n    <div className=\"card mt-4 full-height\">\r\n      <div className=\"card-body\">\r\n        <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n          <h4 className=\"card-title\">Invoices</h4>\r\n          <button className=\"btn btn-primary\" onClick={() => this.setState({ showForm: true })}>+ Add Invoice</button>\r\n        </div>\r\n        <div className=\"table-responsive\">\r\n          <table className=\"table table-bordered table-hover\">\r\n            <thead className=\"thead-light\">\r\n              <tr style={{ fontSize: '14px' }}>\r\n                <th>Invoice No</th>\r\n                <th>Customer</th>\r\n                <th>Date</th>\r\n                <th>Invoice Value</th>\r\n                <th>Status</th>\r\n                <th>Print</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {this.state.Invoices.map((q, i) => (\r\n                <tr key={i} style={{ fontSize: '14px' }}>\r\n                  <td>\r\n                    <button\r\n                      className=\"btn btn-link p-0\"\r\n                      onClick={() => this.loadInvoicePreview(q)}\r\n                    >\r\n                      {q.InvoiceNo}\r\n                    </button>\r\n                  </td>\r\n                  <td>{q.customer}</td>\r\n                  <td>{q.InvoiceDate}</td>\r\n                  <td>{q.InvoiceValue}</td>\r\n                  <td><label className=\"badge badge-info\">{q.status}</label></td>\r\n                  <td>\r\n                  <i\r\n                    className=\"mdi mdi-printer menu-icon\"\r\n                    onClick={() => this.showInvoicePDFWithOrg(q)}\r\n                    style={{ fontSize: '24px', color: '#2196F3', cursor: 'pointer' }}\r\n                  ></i>\r\n                </td>\r\n\r\n          \r\n                </tr>\r\n              ))}\r\n              {this.state.Invoices.length === 0 && (\r\n                <tr><td colSpan=\"6\" className=\"text-center\">No Invoices found.</td></tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  renderInvoiceForm = () => {\r\n    const { formData, overlayType, productOverlayVisible ,showTaxOverlay,taxGroups} = this.state;\r\n    const isFOB = formData.impExp === 'FOB';\r\n\r\n    return (\r\n      <div>\r\n        <div className=\"card full-height\">\r\n          <div style={{ flex: 1, overflowY: 'auto', padding: '24px' }}>\r\n            <h4 className=\"mb-3\">Invoice Form</h4>\r\n            <ul className=\"nav nav-tabs\" role=\"tablist\">\r\n              <li className=\"nav-item\">\r\n                <button type=\"button\" className={`nav-link ${this.state.activeTab === 'co' ? 'active' : ''}`} onClick={() => this.setState({ activeTab: 'co' })}>CO Details</button>\r\n              </li>\r\n              <li className=\"nav-item\">\r\n                <button type=\"button\" className={`nav-link ${this.state.activeTab === 'commercial' ? 'active' : ''}`} onClick={() => this.setState({ activeTab: 'commercial' })}>Commercial Terms</button>\r\n              </li>\r\n            </ul>\r\n            <form className=\"form-sample\" onSubmit={this.handleSubmit}>\r\n              <div className=\"tab-content pt-3\">\r\n                {this.state.activeTab === 'co' && (\r\n                  <>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Invoice No</label>\r\n                        <input type=\"text\" className=\"form-control form-control-sm\" value={formData.InvoiceNo} onChange={(e) => this.handleInputChange('InvoiceNo', e.target.value)} />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Invoice Date</label>\r\n                        <input type=\"date\" className=\"form-control form-control-sm\" value={formData.InvoiceDate} onChange={(e) => this.handleInputChange('InvoiceDate', e.target.value)} />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Invoice Type</label>\r\n                        <select className=\"form-control form-control-sm\" value={formData.InvoiceType} onChange={(e) => this.handleInputChange('InvoiceType', e.target.value)}>\r\n                          <option>Standard</option>\r\n                          <option>Manual</option>\r\n                        </select>\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Status</label>\r\n                        <input type=\"text\" className=\"form-control form-control-sm\" value={formData.status}   style={{ backgroundColor: '#fff' }} readOnly />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Customer</label>\r\n                        <div className=\"input-group input-group-sm\">\r\n                          <input\r\n                            type=\"text\"\r\n                            className=\"form-control\"\r\n                            placeholder=\"Choose Customer\"\r\n                            ref={this.customerInputRef}\r\n                            value={formData.customer}\r\n                            readOnly\r\n                            onClick={() => this.showOverlay('customer')}\r\n                            style={{ cursor: 'pointer' }}\r\n                          />\r\n                          <div className=\"input-group-append\">\r\n                            <button className=\"btn btn-outline-secondary btn-sm\" type=\"button\" onClick={() => this.showOverlay('customer')}>Select</button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>IMP/EXP</label>\r\n                        <select\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.impExp}\r\n                          onChange={(e) => this.handleInputChange('impExp', e.target.value)}\r\n                        >\r\n                          <option>None</option>\r\n                          <option>COB</option>\r\n                          <option>FOB</option>\r\n                          <option>CIF</option>\r\n                        </select>\r\n                      </div>\r\n                      <div className=\"form-group col-md-2\">\r\n                        <label>Ref No.</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.qrefNo}\r\n                          onChange={(e) => this.handleInputChange('qrefNo', e.target.value)}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Choose</label>\r\n                        <div className=\"d-flex align-items-center\">\r\n                          <div className=\"form-check mr-4\">\r\n                            <input type=\"radio\" className=\"form-check-input\" name=\"choose\" id=\"chooseService\" value=\"Service\" checked={formData.choose === 'Service'} onChange={(e) => this.handleInputChange('choose', e.target.value)} />\r\n                            <label className=\"form-check-label\" htmlFor=\"chooseService\">Service</label>\r\n                          </div>\r\n                          <div className=\"form-check\">\r\n                            <input type=\"radio\" className=\"form-check-input\" name=\"choose\" id=\"chooseProduct\" value=\"Product\" checked={formData.choose === 'Product'} onChange={(e) => this.handleInputChange('choose', e.target.value)} />\r\n                            <label className=\"form-check-label\" htmlFor=\"chooseProduct\">Product</label>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Currency</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.currency}\r\n                          style={{ backgroundColor: '#fff' }}\r\n                          readOnly\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Conversion Rate</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.conversionRate}\r\n                          onChange={(e) => this.handleInputChange('conversionRate', e.target.value)}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Tax Amount</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.taxAmount}\r\n                          onChange={(e) => this.handleInputChange('taxAmount', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Invoice Value</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.InvoiceValue}\r\n                          onChange={(e) => this.handleInputChange('InvoiceValue', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                   \r\n                          <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n                            <h4 className=\"card-title\">Line Item</h4>\r\n                            <button type=\"button\" className=\"btn btn-primary btn-sm\" onClick={() => this.setState({ productOverlayVisible: true })}>\r\n                              + Add Product\r\n                            </button>\r\n                          </div>\r\n                       <div className=\"table-responsive\">\r\n        <table className=\"table table-bordered\">\r\n          <thead className=\"thead-light\">\r\n            <tr>\r\n              <th>Item Code</th>\r\n              <th>Item Desc</th>\r\n              <th>Cust Part No</th>\r\n              <th>HSN No</th>\r\n              <th>UOM</th>\r\n              <th>On Hand</th>\r\n              <th>Unit Price</th>\r\n              <th>Quantity</th>\r\n              <th>Tax Id</th>\r\n              <th>Item Total</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {formData.lineItems.map((item, idx) => {\r\n              const itemTotal = item.unitPrice * item.qty;\r\n              const taxDetails = this.getTaxDetailsFromGroup(item.taxGroupName);\r\n              const taxAmt = (itemTotal * taxDetails.totalPercent / 100) + (itemTotal * taxDetails.totalAmount);\r\n              const totalWithTax = itemTotal + taxAmt;\r\n             \r\n              \r\n              return (\r\n                <tr key={item.id || idx}>\r\n                  <td>{item.itemCode}</td>\r\n                  <td>{item.itemDescription}</td>\r\n                  <td>{item.custPartNo}</td>\r\n                  <td>{item.hsnNo}</td>\r\n                  <td>{item.uom}</td>\r\n                  <td>{item.onHand}</td>\r\n                  <td>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={item.unitPrice}\r\n                      onChange={e => this.handleLineItemChange(idx, 'unitPrice', e.target.value)}\r\n                      style={{ width: 80 }}\r\n                    />\r\n                  </td>\r\n                  <td>\r\n                    <input\r\n                      type=\"number\"\r\n                      min=\"1\"\r\n                      value={item.qty}\r\n                      onChange={e => this.handleLineItemChange(idx, 'qty', e.target.value)}\r\n                      style={{ width: 60 }}\r\n                    />\r\n                  </td>\r\n                  <td>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn btn-outline-secondary btn-sm btn-rounded btn-icon\"\r\n                    style={{ padding: '2px 6px', fontSize: '12px', lineHeight: '1' }}\r\n                    onClick={() => this.setState({ showTaxOverlay: true, currentTaxLineIdx: idx })}\r\n                  >\r\n                    +\r\n                  </button>\r\n                  <div style={{ fontSize: '13px', marginTop: '4px' }}>\r\n                    {(item.taxGroupNames || []).join(', ') || '-'}\r\n                  </div>\r\n                </td>\r\n\r\n              <td>{parseFloat(item.total || 0).toFixed(2)}</td>\r\n\r\n\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n                          {/* Add pagination for line items here if needed */}\r\n                          <div className=\"d-flex justify-content-between align-items-center mt-2\">\r\n                            <span>Page 1 of 1</span>\r\n                          </div>\r\n                      \r\n                  </>\r\n                )}\r\n                {this.state.activeTab === 'commercial' && (\r\n                  <>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-6\">\r\n                        <label>Bill To</label>\r\n                        <textarea\r\n                          className=\"form-control form-control-sm\"\r\n                          rows=\"3\"\r\n                          value={formData.billTo}\r\n                          onChange={(e) => this.handleInputChange('billTo', e.target.value)}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-6\">\r\n                        <label>Ship To</label>\r\n                        <textarea\r\n                          className=\"form-control form-control-sm\"\r\n                          rows=\"3\"\r\n                          value={formData.shipTo}\r\n                          onChange={(e) => this.handleInputChange('shipTo', e.target.value)}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                    <div className=\"form-group col-md-4\">\r\n  <label>Despatch Mode</label>\r\n  <div className=\"input-group input-group-sm\">\r\n    <input\r\n      type=\"text\"\r\n      className=\"form-control\"\r\n      value={formData.despatchMode}\r\n      readOnly\r\n      onClick={() => !isFOB && this.showOverlay('despatchMode')}\r\n      style={{ cursor: isFOB ? 'not-allowed' : 'pointer', backgroundColor: '#fff' }}\r\n    />\r\n    <div className=\"input-group-append\">\r\n      <button\r\n        className=\"btn btn-outline-secondary btn-sm\"\r\n        type=\"button\"\r\n        disabled={isFOB}\r\n        onClick={() => this.showOverlay('despatchMode')}\r\n      >\r\n        Select\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div className=\"form-group col-md-4\">\r\n  <label>Payment Terms</label>\r\n  <div className=\"input-group input-group-sm\">\r\n    <input\r\n      type=\"text\"\r\n      className=\"form-control\"\r\n      value={formData.paymentTerms}\r\n      readOnly\r\n      onClick={() => !isFOB && this.showOverlay('paymentTerms')}\r\n      style={{ cursor: isFOB ? 'not-allowed' : 'pointer', backgroundColor: '#fff' }}\r\n    />\r\n    <div className=\"input-group-append\">\r\n      <button\r\n        className=\"btn btn-outline-secondary btn-sm\"\r\n        type=\"button\"\r\n        disabled={isFOB}\r\n        onClick={() => this.showOverlay('paymentTerms')}\r\n      >\r\n        Select\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Freight Charges</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.freightCharges}\r\n                          onChange={(e) => this.handleInputChange('freightCharges', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Tax %</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.taxPercent}\r\n                          onChange={(e) => this.handleInputChange('taxPercent', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Freight Tax Amount</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.freighttaxAmount}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Packing Charges</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.packingCharges}\r\n                          onChange={(e) => this.handleInputChange('packingCharges', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    \r\n                  </>\r\n                )}\r\n                \r\n\r\n              </div>\r\n              <div className=\"fixed-card-footer text-right p-3 border-top bg-white\">\r\n                <button type=\"submit\" className=\"btn btn-success mr-2\">Save All Details</button>\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"btn btn-secondary\"\r\n                  onClick={() => this.setState({ showForm: false, editingId: null })}\r\n                >\r\n                  Cancel\r\n                </button>\r\n              </div>\r\n            </form>\r\n            {overlayType && this.renderOverlay()}\r\n            {productOverlayVisible && this.renderProductOverlay()}\r\n            {this.state.showTaxOverlay && this.renderTaxOverlay()}\r\n\r\n          </div>\r\n          \r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\nrenderInvoicePreview = () => {\r\n  const q = this.state.selectedInvoice;\r\n  if (!q) return null;\r\n\r\n  return (\r\n    <div className=\"card mt-4 full-height p-4\">\r\n      <div className=\"d-flex justify-content-between mb-3\">\r\n        <h4 className=\"card-title\">Invoice Preview - {q.InvoiceNo}</h4>\r\n        <div>\r\n          <button className=\"btn btn-sm btn-info mr-2\" onClick={() => this.loadInvoiceForEdit(q)}>Edit</button>\r\n          <button className=\"btn btn-sm btn-success\" onClick={() => this.convertToOrder(q)}>Convert to Order</button>\r\n        </div>\r\n      </div>\r\n      <div className=\"row\">\r\n        <div className=\"col-md-4\"><b>Customer:</b> {q.customer}</div>\r\n        <div className=\"col-md-4\"><b>Date:</b> {q.InvoiceDate}</div>\r\n        <div className=\"col-md-4\"><b>Status:</b> {q.status}</div>\r\n      </div>\r\n      <div className=\"row mt-2\">\r\n        <div className=\"col-md-6\"><b>Bill To:</b><br />{q.billTo}</div>\r\n        <div className=\"col-md-6\"><b>Ship To:</b><br />{q.shipTo}</div>\r\n      </div>\r\n      <h5 className=\"mt-4\">Line Items</h5>\r\n      <table className=\"table table-bordered\">\r\n        <thead>\r\n          <tr>\r\n            <th>Item Code</th><th>Description</th><th>Qty</th><th>Unit Price</th><th>Total</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {q.lineItems?.map((item, i) => (\r\n            <tr key={i}>\r\n              <td>{item.itemCode}</td>\r\n              <td>{item.itemDescription}</td>\r\n              <td>{item.qty}</td>\r\n              <td>{item.unitPrice}</td>\r\n              <td>{item.total}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n      <div className=\"text-right\"><b>Total:</b> {q.InvoiceValue}</div>\r\n      <button className=\"btn btn-secondary mt-3\" onClick={() => this.setState({ previewMode: false })}>Back to List</button>\r\n    </div>\r\n  );\r\n};\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"container-fluid\">\r\n        {this.state.previewMode? this.renderInvoicePreview(): this.state.showForm ? this.renderInvoiceForm() : this.renderInvoiceTable()}\r\n        \r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Invoice);\r\n"]},"metadata":{},"sourceType":"module"}