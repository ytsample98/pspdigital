{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\College\\\\admin\\\\StarAdmin-Free-React-Admin-Template-master\\\\template\\\\demo_1\\\\src\\\\app\\\\sales\\\\salestransactions\\\\order\\\\Order.js\";\nimport React, { Component } from 'react';\nimport { Form } from 'react-bootstrap';\nimport bsCustomFileInput from 'bs-custom-file-input';\nimport { db } from '../../../../firebase';\nimport { collection, getDocs, addDoc, doc, updateDoc, serverTimestamp } from 'firebase/firestore';\nimport html2canvas from 'html2canvas';\nimport { jsPDF } from 'jspdf';\nimport { toWords } from \"number-to-words\";\nimport { withRouter } from 'react-router-dom';\n\nconst numberToWords = num => {\n  const a = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine', 'Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];\n  const b = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];\n  if (num === 0) return 'Zero';\n  if (num < 20) return a[num];\n  if (num < 100) return b[Math.floor(num / 10)] + ' ' + a[num % 10];\n  if (num < 1000) return a[Math.floor(num / 100)] + ' Hundred ' + numberToWords(num % 100);\n  if (num < 100000) return numberToWords(Math.floor(num / 1000)) + ' Thousand ' + numberToWords(num % 1000);\n  return 'Amount too large';\n};\n\nclass Order extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      activeTab: 'co',\n      breakdownItems: [],\n      orders: [],\n      customers: [],\n      products: [],\n      despatchModes: [],\n      paymentTerms: [],\n      showForm: false,\n      editingId: null,\n      overlayType: '',\n      overlaySearch: '',\n      productOverlayVisible: false,\n      productOverlaySearch: '',\n      selectedProductIds: [],\n      taxGroups: [],\n      showTaxOverlay: false,\n      currentTaxIdx: null,\n      breakdownType: 'Amount',\n      searchTerm: '',\n      formData: {\n        orderNo: '',\n        orderDate: new Date().toISOString().split('T')[0],\n        orderType: 'Standard',\n        customer: '',\n        status: 'Entered',\n        choose: 'Service',\n        qrefNo: '',\n        impExp: 'None',\n        currency: '',\n        conversionRate: '',\n        taxAmount: '',\n        orderValue: '',\n        discountPercent: 0,\n        discountAmount: 0,\n        afterDiscountValue: 0,\n        billTo: '',\n        shipTo: '',\n        despatchMode: 'By Air',\n        paymentTerms: '',\n        freightCharges: '',\n        freighttaxAmount: '',\n        taxPercent: '',\n        packingCharges: '',\n        lineItems: []\n      }\n    };\n    this.customerInputRef = React.createRef();\n\n    this.formatAddress = addr => {\n      if (!addr) return '';\n      if (typeof addr === 'string') return addr;\n      return [addr.address, [addr.city, addr.state, addr.country].filter(Boolean).join(', '), addr.zip].filter(Boolean).join('\\n');\n    };\n\n    this.handleOverlayClose = () => {\n      this.setState({\n        overlayType: '',\n        overlaySearch: '',\n        productOverlayVisible: false,\n        showTaxOverlay: false,\n        currentTaxLineIdx: null,\n        selectedProductIds: []\n      });\n    };\n\n    this.calculateOrderTotals = () => {\n      const {\n        impExp,\n        freightCharges,\n        taxPercent,\n        packingCharges,\n        lineItems\n      } = this.state.formData;\n      const freight = parseFloat(freightCharges) || 0;\n      const packing = parseFloat(packingCharges) || 0;\n      let taxOnFreight = 0;\n\n      if (['None', 'CIF'].includes(impExp)) {\n        taxOnFreight = freight * (parseFloat(taxPercent) || 0) / 100;\n      }\n\n      let lineTotal = 0; // sum of base totals (without tax)\n\n      let itemTaxTotal = 0; // sum of line taxes\n\n      const updatedLineItems = (lineItems || []).map(item => {\n        const qty = parseFloat(item.qty || 0);\n        const unitPrice = parseFloat(item.unitPrice || 0);\n        const baseTotal = qty * unitPrice; // tax group(s)\n\n        const groupNames = item.taxGroupNames && item.taxGroupNames.length ? item.taxGroupNames : item.taxGroup ? [item.taxGroup] : [];\n        let percent = 0;\n        let amount = 0;\n        groupNames.forEach(groupName => {\n          const group = this.state.taxGroups.find(t => t.groupName === groupName);\n\n          if (group && Array.isArray(group.lineItems)) {\n            group.lineItems.forEach(comp => {\n              const val = parseFloat(comp.percentOrAmt || 0);\n              if (comp.type === 'Percentage') percent += val;\n              if (comp.type === 'Amount') amount += val;\n            });\n          }\n        });\n        const taxAmt = baseTotal * percent / 100 + amount;\n        const itemTotalWithTax = baseTotal + taxAmt; // accumulate totals\n\n        lineTotal += baseTotal;\n        itemTaxTotal += taxAmt;\n        return { ...item,\n          qty,\n          unitPrice,\n          baseTotal: baseTotal.toFixed(2),\n          taxAmt: taxAmt.toFixed(2),\n          itemTotal: itemTotalWithTax.toFixed(2)\n        };\n      });\n      const totalTaxAmount = itemTaxTotal + taxOnFreight;\n      const orderValue = lineTotal + itemTaxTotal + freight + packing + taxOnFreight;\n      this.setState(prev => ({\n        formData: { ...prev.formData,\n          lineItems: updatedLineItems,\n          totalTaxAmount: totalTaxAmount.toFixed(2),\n          orderValue: orderValue.toFixed(2)\n        }\n      }));\n    };\n\n    this.handleDiscountChange = (field, value) => {\n      let {\n        formData\n      } = this.state;\n      formData[field] = value;\n      const quoteValue = parseFloat(formData.quoteValue || 0);\n      const discountPercent = parseFloat(formData.discountPercent || 0);\n      const discountAmount = quoteValue * discountPercent / 100;\n      const afterDiscountValue = quoteValue - discountAmount;\n      formData.discountAmount = discountAmount;\n      formData.afterDiscountValue = afterDiscountValue;\n      this.setState({\n        formData\n      });\n    };\n\n    this.handleChooseChange = value => {\n      this.setState(prev => ({\n        formData: { ...prev.formData,\n          choose: value\n        }\n      }), this.filterProductsByCategory);\n    };\n\n    this.filterProductsByCategory = () => {\n      const {\n        choose\n      } = this.state.formData;\n      let filteredProducts = [];\n\n      if (choose === \"Service\") {\n        filteredProducts = this.state.products.filter(p => p.category === \"Service\");\n      } else if (choose === \"Product\") {\n        filteredProducts = this.state.products.filter(p => p.category === \"Product\");\n      } else if (choose === \"Bundle\") {\n        filteredProducts = this.state.products; // All products\n      }\n\n      this.setState({\n        filteredProducts\n      });\n    };\n\n    this.fetchTaxGroups = async () => {\n      const snap = await getDocs(collection(db, 'taxGroups'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        taxGroups: data\n      });\n    };\n\n    this.fetchorders = async () => {\n      const snap = await getDocs(collection(db, 'orders'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      data.sort((a, b) => {\n        var _a$createdAt, _a$createdAt$toDate, _b$createdAt, _b$createdAt$toDate;\n\n        const dateA = new Date(a.orderDate || ((_a$createdAt = a.createdAt) === null || _a$createdAt === void 0 ? void 0 : (_a$createdAt$toDate = _a$createdAt.toDate) === null || _a$createdAt$toDate === void 0 ? void 0 : _a$createdAt$toDate.call(_a$createdAt)) || a.createdAt || 0);\n        const dateB = new Date(b.orderDate || ((_b$createdAt = b.createdAt) === null || _b$createdAt === void 0 ? void 0 : (_b$createdAt$toDate = _b$createdAt.toDate) === null || _b$createdAt$toDate === void 0 ? void 0 : _b$createdAt$toDate.call(_b$createdAt)) || b.createdAt || 0);\n        return dateA - dateB;\n      });\n      this.setState({\n        orders: data.reverse()\n      });\n    };\n\n    this.fetchCustomers = async () => {\n      const snap = await getDocs(collection(db, 'customers'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        customers: data\n      });\n    };\n\n    this.fetchProducts = async () => {\n      const snap = await getDocs(collection(db, 'products'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        products: data,\n        filteredProducts: data\n      }, this.filterProductsByCategory);\n    };\n\n    this.fetchDespatchModes = async () => {\n      const snap = await getDocs(collection(db, 'modes'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        despatchModes: data\n      });\n    };\n\n    this.fetchPaymentTerms = async () => {\n      const snap = await getDocs(collection(db, 'paymentTerms'));\n      const data = snap.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      this.setState({\n        paymentTerms: data\n      });\n    };\n\n    this.handleInputChange = (field, value) => {\n      this.setState(prev => ({\n        formData: { ...prev.formData,\n          [field]: value\n        }\n      }), () => {\n        if (field === 'discountPercent') this.calculateOrderTotals();\n      });\n    };\n\n    this.handleBreakdownChange = (idx, field, value) => {\n      this.setState(prev => {\n        const items = [...prev.breakdownItems];\n        items[idx][field] = value;\n        return {\n          breakdownItems: items\n        };\n      });\n    };\n\n    this.handleBreakdownTypeChange = val => {\n      this.setState({\n        breakdownType: val\n      });\n    };\n\n    this.handleAddInlineSubProduct = (breakdownIdx, initial = null) => {\n      this.setState(prev => {\n        const items = [...prev.breakdownItems];\n        const item = items[breakdownIdx] ? { ...items[breakdownIdx]\n        } : null;\n        if (!item) return {};\n        const subProducts = Array.isArray(item.subProducts) ? [...item.subProducts] : [];\n        const defaultSP = {\n          name: '',\n          value: ''\n        };\n        subProducts.push(initial ? { ...defaultSP,\n          ...initial\n        } : defaultSP);\n        item.subProducts = subProducts;\n        items[breakdownIdx] = item;\n        return {\n          breakdownItems: items\n        };\n      });\n    };\n\n    this.handleRemoveSubProduct = (biIdx, spIdx) => {\n      this.setState(prev => {\n        const items = [...prev.breakdownItems];\n        if (!items[biIdx]) return {};\n        const item = { ...items[biIdx]\n        };\n        const subProducts = Array.isArray(item.subProducts) ? [...item.subProducts] : [];\n        subProducts.splice(spIdx, 1);\n        item.subProducts = subProducts;\n        items[biIdx] = item;\n        return {\n          breakdownItems: items\n        };\n      });\n    };\n\n    this.handleSubProductChange = (biIdx, spIdx, field, value) => {\n      this.setState(prev => {\n        const items = [...prev.breakdownItems];\n        if (!items[biIdx]) return {};\n        const item = { ...items[biIdx]\n        };\n        const subProducts = Array.isArray(item.subProducts) ? [...item.subProducts] : [];\n        const sp = { ...subProducts[spIdx],\n          [field]: value\n        };\n        subProducts[spIdx] = sp;\n        item.subProducts = subProducts;\n        items[biIdx] = item;\n        return {\n          breakdownItems: items\n        };\n      });\n    };\n\n    this.getSubProductsSum = bi => {\n      const {\n        breakdownType,\n        formData\n      } = this.state;\n      const itemTotals = (formData.lineItems || []).reduce((acc, li) => {\n        acc[li.itemCode] = parseFloat(li.total || 0) || 0;\n        return acc;\n      }, {});\n      const mainTotal = itemTotals[bi.productId] || 0;\n      const subs = Array.isArray(bi.subProducts) ? bi.subProducts : [];\n      return subs.reduce((s, sp) => {\n        const val = parseFloat(sp.value || 0) || 0;\n\n        if (breakdownType === 'Percentage') {\n          return s + mainTotal * val / 100;\n        }\n\n        return s + val;\n      }, 0);\n    };\n\n    this.isBreakdownValid = () => {\n      const {\n        breakdownItems,\n        formData\n      } = this.state;\n      const itemTotals = (formData.lineItems || []).reduce((acc, li) => {\n        acc[li.itemCode] = parseFloat(li.total || 0) || 0;\n        return acc;\n      }, {});\n      const TOL = 0.01;\n\n      for (let bi of breakdownItems) {\n        const mainTotal = itemTotals[bi.productId] || 0;\n\n        if (mainTotal > 0) {\n          const subSum = this.getSubProductsSum(bi);\n          if (Math.abs(subSum - mainTotal) > TOL) return false;\n        }\n      }\n\n      return true;\n    };\n\n    this.handleLineItemChange = (idx, field, value) => {\n      const updatedItems = [...this.state.formData.lineItems];\n      updatedItems[idx] = { ...updatedItems[idx],\n        [field]: value\n      }; // recalc tax & totals for this line\n\n      const qty = parseFloat(updatedItems[idx].qty || 0);\n      const unitPrice = parseFloat(updatedItems[idx].unitPrice || 0);\n      const baseTotal = qty * unitPrice;\n      let percent = 0;\n      let amount = 0;\n      (updatedItems[idx].taxGroupNames || []).forEach(groupName => {\n        const group = this.state.taxGroups.find(t => t.groupName === groupName);\n\n        if (group && Array.isArray(group.lineItems)) {\n          group.lineItems.forEach(comp => {\n            const val = parseFloat(comp.percentOrAmt || 0);\n            if (comp.type === 'Percentage') percent += val;\n            if (comp.type === 'Amount') amount += val;\n          });\n        }\n      });\n      const taxAmt = baseTotal * percent / 100 + amount;\n      updatedItems[idx].taxAmt = taxAmt.toFixed(2);\n      updatedItems[idx].itemTotal = (baseTotal + taxAmt).toFixed(2); // update state + recalc full totals\n\n      this.setState(prev => ({\n        formData: { ...prev.formData,\n          lineItems: updatedItems\n        }\n      }), this.calculateOrderTotals);\n    };\n\n    this.handleSubmit = async e => {\n      e.preventDefault();\n      const {\n        editingId,\n        formData,\n        orders,\n        breakdownItems\n      } = this.state;\n      if (!formData.customer) return alert(\"Customer is required\");\n      if (formData.lineItems.length === 0) return alert(\"At least one line item is required\");\n      formData.breakdownItems = breakdownItems;\n      const payload = { ...formData,\n        status: \"Awaiting for Approval\",\n        // Always set to Awaiting for Approval on save\n        breakdownItems: this.state.breakdownItems || []\n      };\n      let orderDocId = editingId;\n\n      if (editingId) {\n        await updateDoc(doc(db, \"orders\", editingId), { ...formData,\n          breakdownItems,\n          status: \"Awaiting for Approval\",\n          updatedAt: serverTimestamp()\n        });\n        orderDocId = editingId;\n      } else {\n        formData.orderNo = `CO${1000 + orders.length}`;\n        const docRef = await addDoc(collection(db, \"orders\"), { ...formData,\n          status: \"Awaiting for Approval\",\n          createdAt: serverTimestamp()\n        }); // Save the docId back into the document\n\n        await updateDoc(docRef, {\n          id: docRef.id\n        });\n        orderDocId = docRef.id;\n      } // If this order was created from a quote, update quote status now\n\n\n      if (formData.quoteNo) {\n        const quoteSnap = await getDocs(collection(db, \"quotes\"));\n        const quoteDoc = quoteSnap.docs.find(q => q.data().quoteNo === formData.quoteNo);\n\n        if (quoteDoc) {\n          await updateDoc(doc(db, \"quotes\", quoteDoc.id), {\n            status: \"CO Created\"\n          });\n        }\n      }\n\n      this.setState({\n        showForm: false,\n        editingId: null,\n        previewOrderMode: false,\n        formData: this.getEmptyOrderForm()\n      });\n      this.fetchorders();\n    };\n\n    this.getEmptyOrderForm = () => ({\n      orderNo: '',\n      orderDate: new Date().toISOString().split('T')[0],\n      orderType: 'Standard',\n      customer: '',\n      status: 'Entered',\n      choose: 'Service',\n      qrefNo: '',\n      impExp: 'None',\n      currency: '',\n      conversionRate: '',\n      taxAmount: '',\n      orderValue: '',\n      discountPercent: 0,\n      discountAmount: 0,\n      afterDiscountValue: 0,\n      billTo: '',\n      shipTo: '',\n      despatchMode: 'By Air',\n      paymentTerms: '',\n      freightCharges: '',\n      freighttaxAmount: '',\n      taxPercent: '',\n      packingCharges: '',\n      lineItems: []\n    });\n\n    this.loadOrderPreview = order => {\n      this.setState({\n        selectedOrder: order,\n        previewOrderMode: true\n      });\n    };\n\n    this.loadorderForEdit = order => {\n      this.setState({\n        formData: { ...order,\n          lineItems: Array.isArray(order.lineItems) ? order.lineItems : []\n        },\n        breakdownItems: Array.isArray(order.breakdownItems) ? order.breakdownItems : [],\n        editingId: order.id,\n        showForm: true,\n        previewOrderMode: false,\n        // <-- Ensure preview mode is off\n        activeTab: 'co'\n      }, () => {\n        if (this.customerInputRef.current) {\n          this.customerInputRef.current.value = order.customer;\n        }\n      });\n    };\n\n    this.toggleOrderForm = () => {\n      this.setState(prev => ({\n        showForm: !prev.showForm,\n        formData: { ...this.initialFormData,\n          // however you reset it\n          orderNo: `CO${1000 + prev.orders.length}`,\n          orderDate: new Date().toISOString().split('T')[0],\n          status: 'Entered',\n          lineItems: []\n        }\n      }), this.calculateOrderTotals);\n    };\n\n    this.toggleTaxGroupSelection = (groupName, lineIdx, isChecked) => {\n      const formData = { ...this.state.formData\n      };\n      const item = formData.lineItems[lineIdx];\n      if (!item.taxGroupNames) item.taxGroupNames = [];\n\n      if (isChecked) {\n        if (!item.taxGroupNames.includes(groupName)) {\n          item.taxGroupNames.push(groupName);\n        }\n      } else {\n        item.taxGroupNames = item.taxGroupNames.filter(g => g !== groupName);\n      }\n\n      this.setState({\n        formData\n      }, () => this.calculateOrderTotals());\n    };\n\n    this.showOverlay = type => this.setState({\n      overlayType: type,\n      overlaySearch: ''\n    });\n\n    this.hideOverlay = () => this.setState({\n      overlayType: '',\n      overlaySearch: ''\n    });\n\n    this.selectOverlayValue = async value => {\n      if (this.state.overlayType === 'customer') {\n        let conversionRate = '';\n\n        if (value.currency && value.currency !== 'INR') {\n          const snap = await getDocs(collection(db, 'currencies'));\n          const currencies = snap.docs.map(d => ({\n            id: d.id,\n            ...d.data()\n          }));\n          const cur = currencies.find(c => c.code === value.currency);\n          conversionRate = cur ? cur.conversionRate : '';\n        }\n\n        this.setState(prev => ({\n          formData: { ...prev.formData,\n            customer: value.custname || value.custcode || '',\n            // Use custname or custcode\n            billTo: this.formatAddress(value.billTo),\n            shipTo: this.formatAddress(value.shipTo),\n            currency: value.currency || '',\n            conversionRate: conversionRate\n          },\n          overlayType: '',\n          overlaySearch: ''\n        }), () => {\n          if (this.customerInputRef.current) {\n            this.customerInputRef.current.value = value.custname || value.custcode || '';\n          }\n        });\n      }\n    };\n\n    this.renderOverlay = () => {\n      const {\n        overlayType,\n        overlaySearch,\n        customers,\n        despatchModes,\n        paymentTerms\n      } = this.state;\n\n      const getFilteredRows = (list, nameKey = 'name', codeKey = 'shortName') => list.filter(item => (item[nameKey] || '').toLowerCase().includes((overlaySearch || '').toLowerCase()) || (item[codeKey] || '').toLowerCase().includes((overlaySearch || '').toLowerCase()));\n\n      const handleSelect = item => {\n        if (overlayType === 'customer') {\n          this.selectOverlayValue(item);\n        } else if (overlayType === 'despatchMode') {\n          this.setState(prev => ({\n            formData: { ...prev.formData,\n              despatchMode: item.name\n            },\n            overlayType: '',\n            overlaySearch: ''\n          }));\n        } else if (overlayType === 'paymentTerms') {\n          this.setState(prev => ({\n            formData: { ...prev.formData,\n              paymentTerms: item.name\n            },\n            overlayType: '',\n            overlaySearch: ''\n          }));\n        }\n      };\n\n      let title = '';\n      let headers = [];\n      let rows = [];\n\n      if (overlayType === 'customer') {\n        title = 'Select Customer';\n        headers = ['Name', 'Code', 'Short Name'];\n        rows = getFilteredRows(customers, 'custname', 'custcode');\n      } else if (overlayType === 'despatchMode') {\n        title = 'Select Despatch Mode';\n        headers = ['Name'];\n        rows = getFilteredRows(despatchModes);\n      } else if (overlayType === 'paymentTerms') {\n        title = 'Select Payment Terms';\n        headers = ['Name'];\n        rows = getFilteredRows(paymentTerms);\n      } else {\n        return null;\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1063,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1064,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1065,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1066,\n          columnNumber: 9\n        }\n      }, title), /*#__PURE__*/React.createElement(\"i\", {\n        className: \"mdi mdi-close-box-outline\",\n        style: {\n          fontSize: \"24px\",\n          color: \"#2196F3\",\n          cursor: \"pointer\"\n        },\n        onClick: this.handleOverlayClose,\n        \"aria-label\": \"Close\",\n        type: \"button\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1067,\n          columnNumber: 9\n        }\n      })), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control mb-2\",\n        placeholder: `Search ${overlayType}...`,\n        value: overlaySearch,\n        onChange: e => this.setState({\n          overlaySearch: e.target.value\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1075,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          maxHeight: 300,\n          overflowY: 'auto'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1082,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered table-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1083,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1084,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1085,\n          columnNumber: 15\n        }\n      }, headers.map((h, i) => /*#__PURE__*/React.createElement(\"th\", {\n        key: i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1086,\n          columnNumber: 40\n        }\n      }, h)))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1089,\n          columnNumber: 13\n        }\n      }, rows.map((item, i) => /*#__PURE__*/React.createElement(\"tr\", {\n        key: item.id || i,\n        onClick: () => handleSelect(item),\n        style: {\n          cursor: 'pointer'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1091,\n          columnNumber: 17\n        }\n      }, headers.map((h, j) => /*#__PURE__*/React.createElement(\"td\", {\n        key: j,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1093,\n          columnNumber: 21\n        }\n      }, overlayType === 'customer' ? h === 'Name' ? item.custname : h === 'Code' ? item.custcode : item.custshortName : h === 'Name' ? item.name : item.shortName)))), rows.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1105,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        colSpan: headers.length,\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1106,\n          columnNumber: 19\n        }\n      }, \"No records found\")))))));\n    };\n\n    this.renderTaxOverlay = () => {\n      const {\n        taxGroups,\n        currentTaxIdx,\n        formData\n      } = this.state;\n      if (currentTaxIdx === null) return null;\n      const item = formData.lineItems[currentTaxIdx];\n      const selected = new Set(item.taxGroupNames || []);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1125,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1126,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1127,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1128,\n          columnNumber: 11\n        }\n      }, \"Select Tax Groups\"), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1129,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-primary btn-sm mr-2\",\n        onClick: () => this.setState({\n          showTaxOverlay: false\n        }),\n        type: \"button\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1130,\n          columnNumber: 13\n        }\n      }, \"Submit\"), /*#__PURE__*/React.createElement(\"i\", {\n        className: \"mdi mdi-close-box-outline\",\n        style: {\n          fontSize: \"24px\",\n          color: \"#2196F3\",\n          cursor: \"pointer\"\n        },\n        onClick: this.handleOverlayClose,\n        \"aria-label\": \"Close\",\n        type: \"button\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1137,\n          columnNumber: 13\n        }\n      }))), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-sm table-bordered\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1146,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        style: {\n          background: '#f4f6fa'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1147,\n          columnNumber: 1\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1148,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1149,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1150,\n          columnNumber: 15\n        }\n      }, \"Group\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1151,\n          columnNumber: 15\n        }\n      }, \"Components\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1152,\n          columnNumber: 15\n        }\n      }, \"%\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1155,\n          columnNumber: 9\n        }\n      }, taxGroups.map(tg => /*#__PURE__*/React.createElement(\"tr\", {\n        key: tg.groupName,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1157,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1158,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        checked: selected.has(tg.groupName),\n        onChange: e => this.toggleTaxGroupSelection(tg.groupName, currentTaxIdx, e.target.checked),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1159,\n          columnNumber: 17\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1167,\n          columnNumber: 15\n        }\n      }, tg.groupName), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1168,\n          columnNumber: 15\n        }\n      }, tg.lineItems.map(li => li.component).join(', ')), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1169,\n          columnNumber: 15\n        }\n      }, tg.lineItems.map(li => li.percentOrAmt).join(', '))))))));\n    };\n\n    this.renderOrderPreview = () => {\n      var _o$lineItems, _o$lineItems2;\n\n      const o = this.state.selectedOrder;\n      if (!o) return null;\n      const subtotal = ((_o$lineItems = o.lineItems) === null || _o$lineItems === void 0 ? void 0 : _o$lineItems.reduce((sum, item) => sum + (parseFloat(item.total) || 0), 0)) || 0;\n      const freightCharges = parseFloat(o.freightCharges || 0);\n      const taxAmount = parseFloat(o.taxAmount || 0);\n      const grandTotal = parseFloat(o.orderValue || subtotal + freightCharges + taxAmount);\n      const amountWords = `INR ${window.toWords ? window.toWords(Math.floor(grandTotal)) : grandTotal} Only`; // Find customer record for extra details\n\n      const customer = this.state.customers.find(c => c.custshortName === o.customer || c.custname === o.customer) || {};\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card mt-4 p-4 shadow-sm full-height d-flex flex-column\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1202,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1203,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"card-title mb-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1204,\n          columnNumber: 9\n        }\n      }, \"Order Preview - \", o.orderNo), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"flex items-center gap-x-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1205,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-sm btn-primary\",\n        onClick: () => this.loadorderForEdit(o),\n        disabled: o.status !== \"Entered\" && o.status !== \"Awaiting for Approval\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1206,\n          columnNumber: 11\n        }\n      }, \"Edit\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1216,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1217,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1217,\n          columnNumber: 35\n        }\n      }, \"Customer:\"), \" \", o.customer), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1218,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1218,\n          columnNumber: 35\n        }\n      }, \"Date:\"), \" \", o.orderDate), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1219,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1219,\n          columnNumber: 35\n        }\n      }, \"Status:\"), \" \", o.status)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row mb-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1221,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1222,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1223,\n          columnNumber: 11\n        }\n      }, \"Bill To:\"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1223,\n          columnNumber: 26\n        }\n      }), o.billTo || \"-\", /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mt-2\",\n        style: {\n          fontSize: \"0.9em\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1225,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1226,\n          columnNumber: 13\n        }\n      }, \"GSTIN:\"), \" \", customer.gstin || \"-\", /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1226,\n          columnNumber: 50\n        }\n      }), /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1227,\n          columnNumber: 13\n        }\n      }, \"Email:\"), \" \", customer.email || \"-\", /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1227,\n          columnNumber: 50\n        }\n      }), /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1228,\n          columnNumber: 13\n        }\n      }, \"Phone:\"), \" \", customer.phone || \"-\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1231,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1232,\n          columnNumber: 11\n        }\n      }, \"Ship To:\"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1232,\n          columnNumber: 26\n        }\n      }), o.shipTo || \"-\")), /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"mt-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1236,\n          columnNumber: 7\n        }\n      }, \"Line Items\"), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered table-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1237,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        className: \"thead-light\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1238,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1239,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1240,\n          columnNumber: 13\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1241,\n          columnNumber: 13\n        }\n      }, \"Description\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1242,\n          columnNumber: 13\n        }\n      }, \"Qty\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1243,\n          columnNumber: 13\n        }\n      }, \"Unit Price\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1244,\n          columnNumber: 13\n        }\n      }, \"Total\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1247,\n          columnNumber: 9\n        }\n      }, (_o$lineItems2 = o.lineItems) === null || _o$lineItems2 === void 0 ? void 0 : _o$lineItems2.map((item, i) => /*#__PURE__*/React.createElement(\"tr\", {\n        key: i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1249,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1250,\n          columnNumber: 15\n        }\n      }, item.itemCode), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1251,\n          columnNumber: 15\n        }\n      }, item.itemDescription), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1252,\n          columnNumber: 15\n        }\n      }, item.qty), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1253,\n          columnNumber: 15\n        }\n      }, item.unitPrice), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1254,\n          columnNumber: 15\n        }\n      }, item.total))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mt-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1259,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1260,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1260,\n          columnNumber: 12\n        }\n      }, \"Subtotal:\"), \" \", subtotal.toFixed(2)), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1261,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1261,\n          columnNumber: 12\n        }\n      }, \"Freight Charges:\"), \" \", freightCharges.toFixed(2)), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1262,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1262,\n          columnNumber: 12\n        }\n      }, \"Tax Amount:\"), \" \", taxAmount.toFixed(2)), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"h6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1263,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1263,\n          columnNumber: 27\n        }\n      }, \"Grand Total:\"), \" \", grandTotal.toFixed(2)), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"h6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1264,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1264,\n          columnNumber: 27\n        }\n      }, \"Amount in Words:\"), \" \", amountWords)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mt-auto pt-3 text-right \",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1266,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-secondary\",\n        onClick: () => this.setState({\n          previewOrderMode: false\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1267,\n          columnNumber: 9\n        }\n      }, \"Back to List\")));\n    };\n\n    this.renderBreakdownTab = () => {\n      const {\n        breakdownItems,\n        breakdownType,\n        formData\n      } = this.state; // map item totals from lineItems (main product totals)\n\n      const itemTotals = (formData.lineItems || []).reduce((acc, li) => {\n        acc[li.itemCode] = parseFloat(li.total || 0) || 0;\n        return acc;\n      }, {});\n      const sumOfItemTotals = Object.values(itemTotals).reduce((s, v) => s + v, 0); // compute subproducts sum\n\n      const getSubProductsSum = bi => {\n        const mainTotal = itemTotals[bi.productId] || 0;\n        const subs = Array.isArray(bi.subProducts) ? bi.subProducts : [];\n        return subs.reduce((s, sp) => {\n          const val = parseFloat(sp.value || 0) || 0;\n          return s + (breakdownType === \"Percentage\" ? mainTotal * val / 100 : val);\n        }, 0);\n      };\n\n      const canSave = this.isBreakdownValid();\n      const isConverted = (formData === null || formData === void 0 ? void 0 : formData.status) === \"CO Created\"; // 🔑 single flag\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1302,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"h5\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1303,\n          columnNumber: 7\n        }\n      }, \"Milestone Breakdown\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row mb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1305,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1306,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1306,\n          columnNumber: 30\n        }\n      }, \"Quote Value:\"), \" \", formData.quoteValue), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1307,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1307,\n          columnNumber: 30\n        }\n      }, \"After Discount Quote Value:\"), \" \", formData.afterDiscountValue), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1308,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1308,\n          columnNumber: 30\n        }\n      }, \"Tax Amount:\"), \" \", formData.taxAmount), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1309,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1309,\n          columnNumber: 30\n        }\n      }, \"Sum of Item Totals:\"), \" \", sumOfItemTotals.toFixed(2))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row mb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1313,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1314,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1315,\n          columnNumber: 11\n        }\n      }, \"Subproduct Mode\"), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"form-control form-control-sm\",\n        value: breakdownType,\n        onChange: e => this.handleBreakdownTypeChange(e.target.value),\n        disabled: isConverted // disable if converted\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1316,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        value: \"Amount\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1322,\n          columnNumber: 13\n        }\n      }, \"Amount\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"Percentage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1323,\n          columnNumber: 13\n        }\n      }, \"Percentage\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-md-9 text-right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1326,\n          columnNumber: 9\n        }\n      }, !isConverted && /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-primary btn-sm\",\n        onClick: this.addBreakdownFromLineItems,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1328,\n          columnNumber: 13\n        }\n      }, \"+ Add Breakdown\"))), /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1340,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        className: \"thead-light\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1341,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1342,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1343,\n          columnNumber: 13\n        }\n      }, \"S.No\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1344,\n          columnNumber: 13\n        }\n      }, \"ID\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1345,\n          columnNumber: 13\n        }\n      }, \"Desc / Subproduct name\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1346,\n          columnNumber: 13\n        }\n      }, \"SubProduct value (\", breakdownType === \"Percentage\" ? \"%\" : \"₹\", \")\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1347,\n          columnNumber: 13\n        }\n      }, \"Total (\\u20B9)\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1348,\n          columnNumber: 13\n        }\n      }, \"Due Date\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1349,\n          columnNumber: 13\n        }\n      }, \"Action\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1352,\n          columnNumber: 9\n        }\n      }, breakdownItems.map((item, idx) => {\n        const mainItemTotal = itemTotals[item.productId] || 0;\n        const subSum = getSubProductsSum(item);\n        const remaining = mainItemTotal - subSum;\n        const subs = Array.isArray(item.subProducts) ? item.subProducts : [];\n        return /*#__PURE__*/React.createElement(React.Fragment, {\n          key: idx,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1360,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"tr\", {\n          style: {\n            background: \"#eef4ff\"\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1362,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1363,\n            columnNumber: 19\n          }\n        }, item.sno), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1364,\n            columnNumber: 19\n          }\n        }, item.productId), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1365,\n            columnNumber: 19\n          }\n        }, item.desc), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1366,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1367,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1368,\n            columnNumber: 23\n          }\n        }, /*#__PURE__*/React.createElement(\"small\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1368,\n            columnNumber: 28\n          }\n        }, \"Subproducts sum: \", /*#__PURE__*/React.createElement(\"b\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1368,\n            columnNumber: 52\n          }\n        }, subSum.toFixed(2)))), /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1369,\n            columnNumber: 23\n          }\n        }, /*#__PURE__*/React.createElement(\"small\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1370,\n            columnNumber: 25\n          }\n        }, \"Remaining:\", \" \", /*#__PURE__*/React.createElement(\"b\", {\n          style: {\n            color: remaining > 0.01 ? \"red\" : \"green\"\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1372,\n            columnNumber: 27\n          }\n        }, remaining.toFixed(2)))))), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1379,\n            columnNumber: 19\n          }\n        }, mainItemTotal.toFixed(2)), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1380,\n            columnNumber: 19\n          }\n        }), /*#__PURE__*/React.createElement(\"td\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1381,\n            columnNumber: 19\n          }\n        }, !isConverted && /*#__PURE__*/React.createElement(\"div\", {\n          className: \"d-flex\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1383,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"button\", {\n          type: \"button\",\n          className: \"btn btn-sm btn-outline-primary mr-2\",\n          onClick: () => this.handleAddInlineSubProduct(idx),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1384,\n            columnNumber: 23\n          }\n        }, \"+ Add\"), /*#__PURE__*/React.createElement(\"button\", {\n          type: \"button\",\n          className: \"btn btn-sm btn-outline-secondary\",\n          onClick: () => {\n            if (remaining <= 0) return;\n            this.handleAddInlineSubProduct(idx, {\n              name: \"New Product\",\n              value: breakdownType === \"Percentage\" ? (remaining * 100 / (mainItemTotal || 1)).toFixed(2) : remaining.toFixed(2)\n            });\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1389,\n            columnNumber: 23\n          }\n        }, \"Auto-fill\")))), subs.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n          key: `notice-${idx}`,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1410,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"td\", {\n          colSpan: \"6\",\n          className: \"text-center text-muted\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1411,\n            columnNumber: 21\n          }\n        }, \"No subproducts added for this item.\")), subs.map((sp, spIdx) => {\n          const spId = `${item.productId}_${spIdx + 1}`;\n          const rawVal = parseFloat(sp.value || 0) || 0;\n          const spTotal = breakdownType === \"Percentage\" ? mainItemTotal * rawVal / 100 : rawVal;\n          return /*#__PURE__*/React.createElement(\"tr\", {\n            key: spId,\n            style: {\n              background: \"#f9f9f9\"\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1425,\n              columnNumber: 21\n            }\n          }, /*#__PURE__*/React.createElement(\"td\", {\n            className: \"text-muted\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1426,\n              columnNumber: 23\n            }\n          }, \"\\u2014\"), /*#__PURE__*/React.createElement(\"td\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1427,\n              columnNumber: 23\n            }\n          }, spId), /*#__PURE__*/React.createElement(\"td\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1428,\n              columnNumber: 23\n            }\n          }, /*#__PURE__*/React.createElement(\"input\", {\n            type: \"text\",\n            className: \"form-control form-control-sm\",\n            value: sp.name || \"\",\n            onChange: e => this.handleSubProductChange(idx, spIdx, \"name\", e.target.value),\n            placeholder: \"Enter name\",\n            disabled: isConverted,\n            style: {\n              paddingLeft: \"18px\"\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1429,\n              columnNumber: 25\n            }\n          })), /*#__PURE__*/React.createElement(\"td\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1439,\n              columnNumber: 23\n            }\n          }, /*#__PURE__*/React.createElement(\"input\", {\n            type: \"number\",\n            step: \"any\",\n            className: \"form-control form-control-sm\",\n            value: sp.value || \"\",\n            onChange: e => this.handleSubProductChange(idx, spIdx, \"value\", e.target.value),\n            disabled: isConverted,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1440,\n              columnNumber: 25\n            }\n          })), /*#__PURE__*/React.createElement(\"td\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1449,\n              columnNumber: 23\n            }\n          }, spTotal.toFixed(2)), /*#__PURE__*/React.createElement(\"td\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1450,\n              columnNumber: 23\n            }\n          }, /*#__PURE__*/React.createElement(\"input\", {\n            type: \"date\",\n            className: \"form-control form-control-sm\",\n            value: sp.dueDate || \"\",\n            onChange: e => this.handleSubProductChange(idx, spIdx, \"dueDate\", e.target.value),\n            disabled: isConverted,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1451,\n              columnNumber: 23\n            }\n          })), /*#__PURE__*/React.createElement(\"td\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1462,\n              columnNumber: 23\n            }\n          }, !isConverted && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"button\", {\n            type: \"button\",\n            className: \"btn btn-sm btn-danger\",\n            onClick: () => this.handleRemoveSubProduct(idx, spIdx),\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 1465,\n              columnNumber: 27\n            }\n          }, \"-\"))));\n        }));\n      }))), !canSave && !isConverted && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"alert alert-danger\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1483,\n          columnNumber: 9\n        }\n      }, \"Breakdown incomplete \\u2014 for each product the sum of subproduct totals must equal the product total. Save disabled until fixed.\"));\n    };\n\n    this.renderProductOverlay = () => {\n      const {\n        filteredProducts,\n        productOverlaySearch,\n        selectedProductIds,\n        currentPage = 1\n      } = this.state;\n      const itemsPerPage = 10;\n      const filtered = filteredProducts.filter(p => (p.ptshortName || '').toLowerCase().includes(productOverlaySearch.toLowerCase()) || (p.ptdescription || '').toLowerCase().includes(productOverlaySearch.toLowerCase()) || (p.itemCode || '').toLowerCase().includes(productOverlaySearch.toLowerCase()));\n      const totalPages = Math.ceil(filtered.length / itemsPerPage);\n      const paginated = filtered.slice((currentPage - 1) * itemsPerPage, currentPage * itemsPerPage);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay\",\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1503,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1505,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1508,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-overlay-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1509,\n          columnNumber: 11\n        }\n      }, \"Select Products\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex align-items-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1510,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-primary btn-sm mr-2\",\n        type: \"button\",\n        onClick: () => {\n          const selectedProducts = filteredProducts.filter(p => selectedProductIds.includes(p.id));\n          this.setState(prev => ({\n            formData: { ...prev.formData,\n              lineItems: [...prev.formData.lineItems, ...selectedProducts.filter(p => !prev.formData.lineItems.some(item => item.id === p.id)).map(p => ({\n                id: p.id,\n                itemCode: p.productId || '',\n                itemDescription: p.ptdescription || '',\n                itemType: p.itemType || '',\n                materialType: p.materialType || '',\n                onHand: p.onHand || 0,\n                taxGroup: p.taxGroup || '',\n                custPartNo: p.custPartNo || '',\n                hsnCode: p.hsnCode || '',\n                unitPrice: p.unitPrice || 0,\n                qty: 1,\n                total: (p.unitPrice || 0).toFixed(2)\n              }))]\n            },\n            productOverlayVisible: false,\n            selectedProductIds: []\n          }));\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1511,\n          columnNumber: 13\n        }\n      }, \"Add Selected\"), /*#__PURE__*/React.createElement(\"i\", {\n        className: \"mdi mdi-close-box-outline\",\n        style: {\n          fontSize: \"24px\",\n          color: \"#2196F3\",\n          cursor: \"pointer\"\n        },\n        onClick: this.handleOverlayClose,\n        \"aria-label\": \"Close\",\n        type: \"button\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1546,\n          columnNumber: 13\n        }\n      }))), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control mb-2\",\n        placeholder: \"Search products...\",\n        value: productOverlaySearch,\n        onChange: e => this.setState({\n          productOverlaySearch: e.target.value,\n          currentPage: 1\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1556,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          flex: 1,\n          overflowY: 'auto',\n          minHeight: 0\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1564,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered table-sm mb-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1565,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1566,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1567,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1568,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1569,\n          columnNumber: 17\n        }\n      }, \"Item Code\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1570,\n          columnNumber: 17\n        }\n      }, \"Item Desc\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1571,\n          columnNumber: 17\n        }\n      }, \"Item Type\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1572,\n          columnNumber: 17\n        }\n      }, \"Material Type\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1573,\n          columnNumber: 17\n        }\n      }, \"On Hand\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1574,\n          columnNumber: 17\n        }\n      }, \"Tax Grp\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1575,\n          columnNumber: 17\n        }\n      }, \"Cust Part No\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1578,\n          columnNumber: 13\n        }\n      }, paginated.map(p => /*#__PURE__*/React.createElement(\"tr\", {\n        key: p.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1580,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1581,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        checked: selectedProductIds.includes(p.id),\n        onChange: e => {\n          const checked = e.target.checked;\n          this.setState(prev => ({\n            selectedProductIds: checked ? [...prev.selectedProductIds, p.id] : prev.selectedProductIds.filter(id => id !== p.id)\n          }));\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1582,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1595,\n          columnNumber: 19\n        }\n      }, p.productId), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1596,\n          columnNumber: 19\n        }\n      }, p.ptdescription || ''), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1597,\n          columnNumber: 19\n        }\n      }, p.itemType || ''), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1598,\n          columnNumber: 19\n        }\n      }, p.materialType || ''), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1599,\n          columnNumber: 19\n        }\n      }, p.onHand || 0), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1600,\n          columnNumber: 19\n        }\n      }, p.taxGroup || ''), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1601,\n          columnNumber: 19\n        }\n      }, p.custPartNo || ''))), paginated.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1605,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        colSpan: \"8\",\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1606,\n          columnNumber: 19\n        }\n      }, \"No products found\"))))), /*#__PURE__*/React.createElement(\"nav\", {\n        \"aria-label\": \"Product pagination example\",\n        style: {\n          marginTop: 12\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1613,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"pagination justify-content-end mb-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1614,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        className: `page-item ${currentPage === 1 ? \"disabled\" : \"\"}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1615,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"page-link\",\n        \"aria-label\": \"Previous\",\n        onClick: () => this.setState({\n          currentPage: Math.max(currentPage - 1, 1)\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1616,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        \"aria-hidden\": \"true\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1621,\n          columnNumber: 17\n        }\n      }, \"\\xAB\"))), [...Array(totalPages)].map((_, idx) => /*#__PURE__*/React.createElement(\"li\", {\n        key: idx,\n        className: `page-item ${currentPage === idx + 1 ? \"active\" : \"\"}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1625,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"page-link\",\n        onClick: () => this.setState({\n          currentPage: idx + 1\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1626,\n          columnNumber: 17\n        }\n      }, idx + 1))), /*#__PURE__*/React.createElement(\"li\", {\n        className: `page-item ${currentPage === totalPages ? \"disabled\" : \"\"}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1634,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"page-link\",\n        \"aria-label\": \"Next\",\n        onClick: () => this.setState({\n          currentPage: Math.min(currentPage + 1, totalPages)\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1635,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        \"aria-hidden\": \"true\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1640,\n          columnNumber: 17\n        }\n      }, \"\\xBB\")))))));\n    };\n\n    this.renderorderTable = () => /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card mt-4 full-height\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1651,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1652,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex justify-content-between align-items-center mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1653,\n        columnNumber: 8\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      className: \"card-title mb-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1654,\n        columnNumber: 3\n      }\n    }, \"Customer Orders\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex align-items-center\",\n      style: {\n        gap: '10px',\n        width: '40%'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1656,\n        columnNumber: 3\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      className: \"form-control\",\n      placeholder: \"Search by Bill No, Customer, Status, Date...\",\n      value: this.state.searchTerm,\n      onChange: e => this.setState({\n        searchTerm: e.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1657,\n        columnNumber: 5\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-primary\",\n      onClick: () => this.setState({\n        showForm: true\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1664,\n        columnNumber: 5\n      }\n    }, \"Create\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"table-responsive\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1674,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"table\", {\n      className: \"table table-bordered table-hover\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1675,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      className: \"thead-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1676,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      style: {\n        fontSize: '14px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1677,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1678,\n        columnNumber: 17\n      }\n    }, \"Order No\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1679,\n        columnNumber: 17\n      }\n    }, \"Customer\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1680,\n        columnNumber: 17\n      }\n    }, \"Date\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1681,\n        columnNumber: 17\n      }\n    }, \"Ref No\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1682,\n        columnNumber: 17\n      }\n    }, \"Order Value\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1683,\n        columnNumber: 17\n      }\n    }, \"After Discount\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1684,\n        columnNumber: 17\n      }\n    }, \"Status\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1685,\n        columnNumber: 17\n      }\n    }, \"Action\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1688,\n        columnNumber: 13\n      }\n    }, this.state.orders.filter(q => {\n      var _q$orderValue, _q$afterDiscountValue;\n\n      const term = this.state.searchTerm.toLowerCase();\n      if (!term) return true;\n      return (q.orderNo || \"\").toLowerCase().includes(term) || (q.customer || \"\").toLowerCase().includes(term) || (q.status || \"\").toLowerCase().includes(term) || (q.orderDate || \"\").toLowerCase().includes(term) || (q.qrefNo || \"\").toLowerCase().includes(term) || (((_q$orderValue = q.orderValue) === null || _q$orderValue === void 0 ? void 0 : _q$orderValue.toString()) || \"\").toLowerCase().includes(term) || (((_q$afterDiscountValue = q.afterDiscountValue) === null || _q$afterDiscountValue === void 0 ? void 0 : _q$afterDiscountValue.toString()) || \"\").toLowerCase().includes(term);\n    }).map((q, i) => {\n      let statusClass = \"badge-secondary\";\n      if (q.status === \"Awaiting for Approval\") statusClass = \"badge-warning\";else if (q.status === \"CO Created\") statusClass = \"badge-secondary\";else if (q.status === \"Approved\") statusClass = \"badge-success\";else if (q.status === \"Rejected\") statusClass = \"badge-danger\";\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: i,\n        style: {\n          fontSize: '14px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1711,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1712,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-link p-0\",\n        onClick: () => this.loadOrderPreview(q),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1713,\n          columnNumber: 21\n        }\n      }, q.orderNo)), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1720,\n          columnNumber: 19\n        }\n      }, q.customer), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1721,\n          columnNumber: 19\n        }\n      }, q.orderDate), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1722,\n          columnNumber: 19\n        }\n      }, q.qrefNo), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1723,\n          columnNumber: 19\n        }\n      }, q.orderValue), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1724,\n          columnNumber: 19\n        }\n      }, q.afterDiscountValue), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1725,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: `badge ${statusClass}`,\n        style: {\n          fontSize: '14px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1726,\n          columnNumber: 21\n        }\n      }, q.status)), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1728,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"mdi mdi-printer menu-icon\",\n        onClick: () => this.showPDFWithOrg(q, {\n          customers: this.state.customers,\n          products: this.state.products,\n          taxGroups: this.state.taxGroups\n        }, \"ORDER\"),\n        style: {\n          fontSize: '24px',\n          color: '#2196F3',\n          cursor: 'pointer'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1729,\n          columnNumber: 24\n        }\n      })));\n    }), this.state.orders.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1744,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      colSpan: \"6\",\n      className: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1744,\n        columnNumber: 21\n      }\n    }, \"No orders found.\")))))));\n\n    this.renderorderForm = () => {\n      const {\n        formData,\n        overlayType,\n        productOverlayVisible,\n        breakdownItems,\n        breakdownType\n      } = this.state;\n      const isFOB = formData.impExp === 'FOB';\n      const itemTotals = (formData.lineItems || []).reduce((acc, li) => {\n        acc[li.itemCode] = parseFloat(li.total || 0) || 0;\n        return acc;\n      }, {});\n      const sumOfItemTotals = Object.values(itemTotals).reduce((sum, val) => sum + val, 0);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1764,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card full-height\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1765,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          flex: 1,\n          overflowY: 'auto',\n          padding: '24px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1766,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1767,\n          columnNumber: 13\n        }\n      }, \"Order Form\"), /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"nav nav-tabs\",\n        role: \"tablist\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1768,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        className: \"nav-item\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1769,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: `nav-link ${this.state.activeTab === 'co' ? 'active' : ''}`,\n        onClick: () => this.setState({\n          activeTab: 'co'\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1770,\n          columnNumber: 17\n        }\n      }, \"CO Details\")), /*#__PURE__*/React.createElement(\"li\", {\n        className: \"nav-item\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1772,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: `nav-link ${this.state.activeTab === 'commercial' ? 'active' : ''}`,\n        onClick: () => this.setState({\n          activeTab: 'commercial'\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1773,\n          columnNumber: 17\n        }\n      }, \"Commercial Terms\")), /*#__PURE__*/React.createElement(\"li\", {\n        className: \"nav-item\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1775,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: `nav-link ${this.state.activeTab === 'breakdown' ? 'active' : ''}`,\n        onClick: () => this.setState({\n          activeTab: 'breakdown'\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1776,\n          columnNumber: 15\n        }\n      }, \"Breakdown\"))), /*#__PURE__*/React.createElement(\"form\", {\n        className: \"form-sample\",\n        onSubmit: this.handleSubmit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1779,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"tab-content pt-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1780,\n          columnNumber: 15\n        }\n      }, this.state.activeTab === 'co' && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1783,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1784,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1785,\n          columnNumber: 25\n        }\n      }, \"Order No\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.orderNo,\n        onChange: e => this.handleInputChange('orderNo', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1786,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1788,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1789,\n          columnNumber: 25\n        }\n      }, \"Order Date\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"date\",\n        className: \"form-control form-control-sm\",\n        value: formData.orderDate,\n        onChange: e => this.handleInputChange('orderDate', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1790,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1792,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1793,\n          columnNumber: 25\n        }\n      }, \"Order Type\"), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"form-control form-control-sm\",\n        value: formData.orderType,\n        onChange: e => this.handleInputChange('orderType', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1794,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1795,\n          columnNumber: 27\n        }\n      }, \"Standard\"), /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1796,\n          columnNumber: 27\n        }\n      }, \"Manual\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1799,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1800,\n          columnNumber: 25\n        }\n      }, \"Status\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.status,\n        style: {\n          backgroundColor: '#fff'\n        },\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1801,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1804,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1805,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1806,\n          columnNumber: 25\n        }\n      }, \"Customer\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group input-group-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1807,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        placeholder: \"Choose Customer\",\n        ref: this.customerInputRef,\n        value: formData.customer,\n        readOnly: true,\n        onClick: () => this.showOverlay('customer'),\n        style: {\n          cursor: 'pointer'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1808,\n          columnNumber: 27\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group-append\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1818,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-outline-secondary btn-sm\",\n        type: \"button\",\n        onClick: () => this.showOverlay('customer'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1819,\n          columnNumber: 29\n        }\n      }, \"Select\")))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1823,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1824,\n          columnNumber: 25\n        }\n      }, \"IMP/EXP\"), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"form-control form-control-sm\",\n        value: formData.impExp,\n        onChange: e => this.handleInputChange('impExp', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1825,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1830,\n          columnNumber: 27\n        }\n      }, \"None\"), /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1831,\n          columnNumber: 27\n        }\n      }, \"COB\"), /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1832,\n          columnNumber: 27\n        }\n      }, \"FOB\"), /*#__PURE__*/React.createElement(\"option\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1833,\n          columnNumber: 27\n        }\n      }, \"CIF\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1836,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1837,\n          columnNumber: 25\n        }\n      }, \"Ref No.\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.qrefNo,\n        onChange: e => this.handleInputChange('qrefNo', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1838,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1845,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1846,\n          columnNumber: 21\n        }\n      }, \"Choose\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex align-items-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1847,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-check mr-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1848,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"radio\",\n        className: \"form-check-input\",\n        name: \"choose\",\n        id: \"chooseService\",\n        value: \"Service\",\n        checked: formData.choose === 'Service',\n        onChange: e => this.handleChooseChange(e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1849,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(\"label\", {\n        className: \"form-check-label\",\n        htmlFor: \"chooseService\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1853,\n          columnNumber: 25\n        }\n      }, \"Service\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-check mr-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1855,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"radio\",\n        className: \"form-check-input\",\n        name: \"choose\",\n        id: \"chooseProduct\",\n        value: \"Product\",\n        checked: formData.choose === 'Product',\n        onChange: e => this.handleChooseChange(e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1856,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(\"label\", {\n        className: \"form-check-label\",\n        htmlFor: \"chooseProduct\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1860,\n          columnNumber: 25\n        }\n      }, \"Product\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-check\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1862,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"radio\",\n        className: \"form-check-input\",\n        name: \"choose\",\n        id: \"chooseBundle\",\n        value: \"Bundle\",\n        checked: formData.choose === 'Bundle',\n        onChange: e => this.handleChooseChange(e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1863,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(\"label\", {\n        className: \"form-check-label\",\n        htmlFor: \"chooseBundle\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1867,\n          columnNumber: 25\n        }\n      }, \"Service+Product\"))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1872,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1873,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1874,\n          columnNumber: 25\n        }\n      }, \"Currency\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.currency,\n        style: {\n          backgroundColor: '#fff'\n        },\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1875,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1883,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1884,\n          columnNumber: 25\n        }\n      }, \"Conversion Rate\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control form-control-sm\",\n        value: formData.conversionRate,\n        onChange: e => this.handleInputChange('conversionRate', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1885,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1892,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1893,\n          columnNumber: 25\n        }\n      }, \"Tax Amount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.totalTaxAmount,\n        onChange: e => this.handleInputChange('totalTaxAmount', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1894,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1902,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1903,\n          columnNumber: 25\n        }\n      }, \"Order Value\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.orderValue,\n        onChange: e => this.handleInputChange('orderValue', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1904,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1913,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1914,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1915,\n          columnNumber: 23\n        }\n      }, \"Discount %\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: formData.discountPercent,\n        onChange: e => {\n          this.handleInputChange('discountPercent', e.target.value);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1916,\n          columnNumber: 23\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1925,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1926,\n          columnNumber: 21\n        }\n      }, \"Discount Amount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: this.state.formData.discountAmount,\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1927,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1934,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1935,\n          columnNumber: 23\n        }\n      }, \"After Discount - Quote Value\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control\",\n        value: this.state.formData.afterDiscountValue,\n        readOnly: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1936,\n          columnNumber: 23\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between align-items-center mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1944,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"card-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1945,\n          columnNumber: 29\n        }\n      }, \"Line Item\"), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-primary btn-sm\",\n        onClick: () => this.setState({\n          productOverlayVisible: true\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1946,\n          columnNumber: 29\n        }\n      }, \"+ Add Product\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"table-responsive\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1950,\n          columnNumber: 27\n        }\n      }, /*#__PURE__*/React.createElement(\"table\", {\n        className: \"table table-bordered\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1951,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"thead\", {\n        className: \"thead-light\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1952,\n          columnNumber: 31\n        }\n      }, /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1953,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1954,\n          columnNumber: 35\n        }\n      }, \" Item Code \"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1955,\n          columnNumber: 35\n        }\n      }, \" Item Desc \"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1956,\n          columnNumber: 35\n        }\n      }, \" Cust Part No \"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1957,\n          columnNumber: 35\n        }\n      }, \" HSN No \"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1958,\n          columnNumber: 35\n        }\n      }, \" On Hand \"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1959,\n          columnNumber: 35\n        }\n      }, \"Unit Price\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1960,\n          columnNumber: 35\n        }\n      }, \"Quantity\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1961,\n          columnNumber: 35\n        }\n      }, \"Tax Id\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1962,\n          columnNumber: 35\n        }\n      }, \"Item Total\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1963,\n          columnNumber: 35\n        }\n      }, \"Tax amount\"), /*#__PURE__*/React.createElement(\"th\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1964,\n          columnNumber: 35\n        }\n      }, \"Grand Total\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1967,\n          columnNumber: 31\n        }\n      }, formData.lineItems.map((item, idx) => /*#__PURE__*/React.createElement(\"tr\", {\n        key: item.id || idx,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1969,\n          columnNumber: 35\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1970,\n          columnNumber: 37\n        }\n      }, item.itemCode), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1971,\n          columnNumber: 37\n        }\n      }, item.itemDescription), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1972,\n          columnNumber: 37\n        }\n      }, item.custPartNo), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1973,\n          columnNumber: 37\n        }\n      }, item.hsnCode), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1974,\n          columnNumber: 37\n        }\n      }, item.onHand), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1975,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        value: item.unitPrice,\n        onChange: e => this.handleLineItemChange(idx, 'unitPrice', e.target.value),\n        style: {\n          width: 80\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1976,\n          columnNumber: 39\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1983,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        min: \"1\",\n        value: item.qty,\n        onChange: e => this.handleLineItemChange(idx, 'qty', e.target.value),\n        style: {\n          width: 60\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1984,\n          columnNumber: 39\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        style: {\n          verticalAlign: 'middle'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1992,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-sm btn-outline-primary\",\n        onClick: () => this.setState({\n          showTaxOverlay: true,\n          currentTaxIdx: idx\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1993,\n          columnNumber: 39\n        }\n      }, \"Select Tax\"), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          fontSize: '10px',\n          marginTop: '4px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2000,\n          columnNumber: 39\n        }\n      }, (item.taxGroupNames || []).join(', ') || '-')), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2004,\n          columnNumber: 37\n        }\n      }, item.baseTotal || '0.00'), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2005,\n          columnNumber: 39\n        }\n      }, item.taxAmt || '0.00'), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2006,\n          columnNumber: 39\n        }\n      }, item.itemTotal || '0.00'))), formData.lineItems.length === 0 && /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2012,\n          columnNumber: 35\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        colSpan: \"9\",\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2013,\n          columnNumber: 37\n        }\n      }, \"No items\")))))), this.state.activeTab === 'commercial' && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2024,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2025,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2026,\n          columnNumber: 25\n        }\n      }, \"Bill To\"), /*#__PURE__*/React.createElement(\"textarea\", {\n        className: \"form-control form-control-sm\",\n        rows: \"3\",\n        value: formData.billTo,\n        onChange: e => this.handleInputChange('billTo', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2027,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2034,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2035,\n          columnNumber: 25\n        }\n      }, \"Ship To\"), /*#__PURE__*/React.createElement(\"textarea\", {\n        className: \"form-control form-control-sm\",\n        rows: \"3\",\n        value: formData.shipTo,\n        onChange: e => this.handleInputChange('shipTo', e.target.value),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2036,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2044,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2045,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2046,\n          columnNumber: 3\n        }\n      }, \"Despatch Mode\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group input-group-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2047,\n          columnNumber: 3\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        value: formData.despatchMode,\n        readOnly: true,\n        onClick: () => !isFOB && this.showOverlay('despatchMode'),\n        style: {\n          cursor: isFOB ? 'not-allowed' : 'pointer',\n          backgroundColor: '#fff'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2048,\n          columnNumber: 5\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group-append\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2056,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-outline-secondary btn-sm\",\n        type: \"button\",\n        disabled: isFOB,\n        onClick: () => this.showOverlay('despatchMode'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2057,\n          columnNumber: 7\n        }\n      }, \"Select\")))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2069,\n          columnNumber: 1\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2070,\n          columnNumber: 3\n        }\n      }, \"Payment Terms\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group input-group-sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2071,\n          columnNumber: 3\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        value: formData.paymentTerms,\n        readOnly: true,\n        onClick: () => !isFOB && this.showOverlay('paymentTerms'),\n        style: {\n          cursor: isFOB ? 'not-allowed' : 'pointer',\n          backgroundColor: '#fff'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2072,\n          columnNumber: 5\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group-append\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2080,\n          columnNumber: 5\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn btn-outline-secondary btn-sm\",\n        type: \"button\",\n        disabled: isFOB,\n        onClick: () => this.showOverlay('paymentTerms'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2081,\n          columnNumber: 7\n        }\n      }, \"Select\")))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2093,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2094,\n          columnNumber: 25\n        }\n      }, \"Freight Charges\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.freightCharges,\n        onChange: e => this.handleInputChange('freightCharges', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2095,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2104,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2105,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2106,\n          columnNumber: 25\n        }\n      }, \"Tax %\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.taxPercent,\n        onChange: e => this.handleInputChange('taxPercent', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2107,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2115,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2116,\n          columnNumber: 25\n        }\n      }, \"Freight Tax Amount\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.taxAmount,\n        onChange: e => this.handleInputChange('freighttaxAmount', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2117,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group col-md-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2125,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2126,\n          columnNumber: 25\n        }\n      }, \"Packing Charges\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"number\",\n        className: \"form-control form-control-sm\",\n        value: formData.packingCharges,\n        onChange: e => this.handleInputChange('packingCharges', e.target.value),\n        readOnly: isFOB // Read-only if FOB\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2127,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"text-right mt-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2136,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-success\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2137,\n          columnNumber: 23\n        }\n      }, \"Save All Details\"))), this.state.activeTab === 'breakdown' && this.renderBreakdownTab()), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"fixed-card-footer text-right p-3 border-top bg-white\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2144,\n          columnNumber: 14\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-secondary mr-2\",\n        onClick: () => this.setState({\n          showForm: false,\n          editingId: null\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2145,\n          columnNumber: 17\n        }\n      }, \"Cancel\"), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-success \",\n        disabled: !this.isBreakdownValid(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 2152,\n          columnNumber: 4\n        }\n      }, \"Save All Details\"))), overlayType && this.renderOverlay(), productOverlayVisible && this.renderProductOverlay(), this.state.showTaxOverlay && this.renderTaxOverlay())));\n    };\n  }\n\n  getTaxDetailsFromGroup(groupName) {\n    if (!groupName || groupName === 'nill' || groupName === 'more') return {\n      totalPercent: 0,\n      totalAmount: 0\n    };\n    const group = this.state.taxGroups.find(tg => tg.groupName === groupName);\n    if (!group || !Array.isArray(group.lineItems)) return {\n      totalPercent: 0,\n      totalAmount: 0\n    };\n    let totalPercent = 0;\n    let totalAmount = 0;\n    group.lineItems.forEach(item => {\n      if (item.type === 'Percentage') {\n        totalPercent += parseFloat(item.percentOrAmt || 0);\n      } else if (item.type === 'Amount') {\n        totalAmount += parseFloat(item.percentOrAmt || 0);\n      }\n    });\n    return {\n      totalPercent,\n      totalAmount\n    };\n  }\n\n  showPDFWithOrg(order, {\n    customers,\n    products,\n    taxGroups\n  }, type = \"ORDER\") {\n    var _orgSnap$docs$;\n\n    // 1. Fetch org and customer order\n    const orgSnap = getDocs(collection(db, 'businessGroups'));\n    const org = ((_orgSnap$docs$ = orgSnap.docs[0]) === null || _orgSnap$docs$ === void 0 ? void 0 : _orgSnap$docs$.order()) || {};\n    const customer = customers.find(c => c.custshortName === order.customer || c.custname === order.customer) || {};\n    const gstStateMap = {\n      \"01\": \"Jammu & Kashmir\",\n      \"02\": \"Himachal Pradesh\",\n      \"03\": \"Punjab\",\n      \"04\": \"Chandigarh\",\n      \"05\": \"Uttarakhand\",\n      \"06\": \"Haryana\",\n      \"07\": \"Delhi\",\n      \"08\": \"Rajasthan\",\n      \"09\": \"Uttar Pradesh\",\n      \"10\": \"Bihar\",\n      \"11\": \"Sikkim\",\n      \"12\": \"Arunachal Pradesh\",\n      \"13\": \"Nagaland\",\n      \"14\": \"Manipur\",\n      \"15\": \"Mizoram\",\n      \"16\": \"Tripura\",\n      \"17\": \"Meghalaya\",\n      \"18\": \"Assam\",\n      \"19\": \"West Bengal\",\n      \"20\": \"Jharkhand\",\n      \"21\": \"Odisha\",\n      \"22\": \"Chhattisgarh\",\n      \"23\": \"Madhya Pradesh\",\n      \"24\": \"Gujarat\",\n      \"25\": \"Daman and Diu\",\n      \"26\": \"Dadra and Nagar Haveli\",\n      \"27\": \"Maharashtra\",\n      \"28\": \"Andhra Pradesh (Old)\",\n      \"29\": \"Karnataka\",\n      \"30\": \"Goa\",\n      \"31\": \"Lakshadweep\",\n      \"32\": \"Kerala\",\n      \"33\": \"Tamil Nadu\",\n      \"34\": \"Puducherry\",\n      \"35\": \"Andaman and Nicobar Islands\",\n      \"36\": \"Telangana\",\n      \"37\": \"Andhra Pradesh\",\n      \"97\": \"Other Territory\"\n    };\n\n    const getPlaceOfSupply = gstin => {\n      if (!gstin || gstin.length < 2) return '';\n      const code = gstin.substring(0, 2);\n      const state = gstStateMap[code];\n      return state ? `${code} - ${state}` : '';\n    }; // 2. Enrich line items\n\n\n    const enrichedItems = (order.lineItems || []).map(item => {\n      const product = products.find(p => p.productId === item.itemCode) || {};\n      return { ...item,\n        ptshortName: product.ptshortName || '',\n        hsnCode: item.hsnCode || product.hsnCode || '',\n        uom: item.uom || product.stockingUOM || '',\n        taxGroupNames: item.taxGroupNames || (item.taxGroupName ? item.taxGroupName.split(',').map(s => s.trim()) : [])\n      };\n    }); // 3. Totals and conversion\n\n    const isINR = (order.currency || 'INR') === 'INR';\n    const conversionRate = parseFloat(order.conversionRate || 1);\n\n    const convert = amt => isINR ? amt : amt * conversionRate;\n\n    const subtotal = enrichedItems.reduce((sum, item) => sum + (parseFloat(item.unitPrice) || 0) * (parseFloat(item.qty) || 0), 0);\n    const freightCharges = parseFloat(order.freightCharges || 0);\n    const packingCharges = parseFloat(order.packingCharges || 0);\n    const freightTax = parseFloat(order.freighttaxAmount || order.freightTaxAmt || 0);\n    const totalTaxAmount = parseFloat(order.taxAmount || order.taxAmt || 0);\n    const discountAmount = parseFloat(order.discountAmount || 0);\n    const grandTotal = parseFloat(order.afterDiscountValue || order.quoteValue || order.orderValue || order.billValue || subtotal + totalTaxAmount + freightCharges + packingCharges);\n    const subtotalConv = convert(subtotal);\n    const freightChargesConv = convert(freightCharges);\n    const packingChargesConv = convert(packingCharges);\n    const taxAmountConv = convert(totalTaxAmount);\n    const discountAmountConv = convert(discountAmount);\n    const grandTotalConv = convert(grandTotal); // 4. Tax breakdown by group\n\n    let taxGroupDetails = [];\n    let sno = 1;\n    enrichedItems.forEach(item => {\n      const qty = parseFloat(item.qty || 0);\n      const unitPrice = parseFloat(item.unitPrice || 0);\n      const base = qty * unitPrice;\n      (item.taxGroupNames || []).forEach(tgName => {\n        const group = (taxGroups || []).find(g => g.groupName === tgName);\n\n        if (group) {\n          group.lineItems.forEach(li => {\n            let taxAmt = li.type === 'Amount' ? parseFloat(li.percentOrAmt || 0) : base * parseFloat(li.percentOrAmt || 0) / 100;\n            taxGroupDetails.push({\n              sno: sno++,\n              group: tgName,\n              peramt: `${li.percentOrAmt}${li.type === 'Amount' ? '' : '%'}`,\n              taxAmt: convert(taxAmt).toFixed(2)\n            });\n          });\n        }\n      });\n\n      if (freightTax > 0) {\n        taxGroupDetails.push({\n          sno: sno++,\n          group: \"Freight Tax\",\n          peramt: \"-\",\n          taxAmt: convert(freightTax).toFixed(2)\n        });\n      }\n    }); // 5. Build HTML for PDF\n\n    const container = document.createElement('div');\n    container.id = 'pdf-preview-container';\n    container.style.width = '794px';\n    container.style.padding = '40px';\n    container.style.fontFamily = 'Arial'; // Dynamic columns\n\n    const numCols = isINR ? 8 : 7;\n    container.innerHTML = `\n    <div style=\"display:flex; justify-content:space-between; align-items:center;\">\n      <img src=\"${org.logoUrl || ''}\" style=\"height:50px;\" />\n      <div style=\"font-size:18px; font-weight:bold;\">${type === \"QUOTE\" ? \"QUOTATION\" : type === \"ORDER\" ? \"CUSTOMER ORDER\" : type === \"BILL\" ? \"INVOICE\" : \"BILL\"}</div>\n    </div>\n    <hr/>\n    <div style=\"display:flex; justify-content:space-between; font-size:11px;\">\n      <div style=\"line-height:1.5; width:50%;\">\n        <b>${org.bgName || ''}</b><br/>\n        ${org.address || ''}<br/>\n        <b>Email:</b> ${org.email || ''}<br/>\n        <b>Website:</b> ${org.website || ''}<br/>\n        <b>GSTIN:</b> ${org.gstin || ''}<br/>\n        <b>Mobile:</b> ${org.mobile || ''}<br/>\n        <b>CIN:</b> ${org.cin || ''}\n      </div>\n      <table style=\"font-size:11px; text-align:left;\">\n        <tr><td><b>No</b></td><td>: ${order.quoteNo || order.orderNo || order.invoiceNo || order.cobillingNo || order.billNo || ''}</td></tr>\n        <tr><td><b>Date</b></td><td>: ${order.quoteDate || order.orderDate || order.invoiceDate || order.cobillingDate || order.billDate || ''}</td></tr>\n        <tr><td><b>Currency</b></td><td>: ${order.currency || 'INR'}</td></tr>\n        <tr><td><b>Despatch</b></td><td>: ${order.despatchMode || ''}</td></tr>\n      </table>\n    </div>\n    <div style=\"margin-top:15px; display:flex; justify-content:space-between; font-size:11px;\">\n      <div style=\"width:48%;\">\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Bill To</b>\n        <div style=\"border:1px solid #ccc; padding:6px;\">\n         <b>${order.customer || ''}</b><br/>\n          ${(order.billTo || '').replace(/\\n/g, '<br/>')}\n        </div>\n        <div style=\"font-size:10px; margin-top:6px;\">\n            <b>GSTIN:</b> ${customer.gstin || ''}<br/>\n            <b>Email:</b> ${customer.email || ''}<br/>\n            <b>Contact:</b> ${customer.contactPerson || ''}<br/>\n            <b>Phone:</b> ${customer.phone || ''}\n        </div>\n      </div>\n      <div style=\"width:48%;\">\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Ship To</b>\n        <div style=\"border:1px solid #ccc; padding:6px;\">\n         <b>${order.customer || ''}</b><br/>\n          ${(order.shipTo || '').replace(/\\n/g, '<br/>')}\n        </div>\n        <div style=\"font-size:10px; margin-top:6px;\">\n          <b>Place of Supply:</b> ${getPlaceOfSupply(customer.gstin || '')}\n        </div>\n      </div>\n    </div>\n    <table style=\"width:100%; border-collapse:collapse; font-size:12px; border:1px solid #011b56; margin-top:20px;\">\n      <thead>\n        <tr style=\"background-color:#f0f0f0; text-align:center;\">\n          <th style=\"border:1px solid #011b56;\">Item Code</th>\n          <th style=\"border:1px solid #011b56;\">Description</th>\n          <th style=\"border:1px solid #011b56;\">HSN</th>\n          <th style=\"border:1px solid #011b56;\">UOM</th>\n          <th style=\"border:1px solid #011b56;\">Qty</th>\n          <th style=\"border:1px solid #011b56;\">Unit Price</th>\n          ${isINR ? `<th style=\"border:1px solid #011b56;\">GST%</th>` : ''}\n          <th style=\"border:1px solid #011b56;\">Item Total</th>\n        </tr>\n      </thead>\n      <tbody>\n        ${enrichedItems.map(item => {\n      const gstLabel = item.taxGroupNames && item.taxGroupNames.length ? item.taxGroupNames.join(', ') : item.taxGroupName || item.taxId || '-';\n      const rawTotal = item.total ? item.total : item.qty && item.unitPrice ? item.qty * item.unitPrice : 0;\n      return `\n            <tr>\n              <td style=\"border:1px solid #011b56;\">${item.itemCode || '-'}</td>\n              <td style=\"border:1px solid #011b56;\">${item.itemDescription || item.itemDesc || '-'}</td>\n              <td style=\"border:1px solid #011b56;\">${item.hsnCode || '-'}</td>\n              <td style=\"border:1px solid #011b56;\">${item.uom || '-'}</td>\n              <td style=\"border:1px solid #011b56;\">${item.qty || 0}</td>\n              <td style=\"border:1px solid #011b56;\">${convert(item.unitPrice).toFixed(2)}</td>\n              ${isINR ? `<td style=\"border:1px solid #011b56;\">${gstLabel}</td>` : ''}\n              <td style=\"border:1px solid #011b56;\">${convert(rawTotal).toFixed(2)}</td>\n            </tr>`;\n    }).join('')}\n      </tbody>\n      <tfoot>\n        <tr>\n          <td colspan=\"${numCols - 1}\" style=\"text-align:right; border:1px solid #011b56;\"><b>Subtotal</b></td>\n          <td style=\"border:1px solid #011b56;\"><b>${subtotalConv.toFixed(2)}</b></td>\n        </tr>\n        ${taxAmountConv > 0 ? `\n        <tr>\n          <td colspan=\"${numCols - 1}\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td>\n          <td style=\"border:1px solid #011b56;\"><b>${taxAmountConv.toFixed(2)}</b></td>\n        </tr>` : ''}\n        ${discountAmountConv > 0 ? `\n        <tr>\n          <td colspan=\"${numCols - 1}\" style=\"text-align:right; border:1px solid #011b56;\"><b>Discount Amount</b></td>\n          <td style=\"border:1px solid #011b56;\"><b>${discountAmountConv.toFixed(2)}</b></td>\n        </tr>` : ''}\n        <tr>\n          <td colspan=\"${numCols - 1}\" style=\"text-align:right; border:1px solid #011b56;\"><b>Grand Total</b></td>\n          <td style=\"border:1px solid #011b56;\"><b>${grandTotalConv.toFixed(2)}</b></td>\n        </tr>\n      </tfoot>\n    </table>\n    <div style=\"margin-top:8px; font-size:11px;\"><b>Amount in Words:</b> ${isINR ? `INR ${toWords(Math.floor(grandTotalConv))} Only` : `${order.currency} ${toWords(Math.floor(grandTotalConv))} Only`}</div>\n    <div style=\"margin-top:20px; text-align:right; font-size:10px;\">Printed on ${new Date().toLocaleString()}</div>\n  `;\n    document.body.appendChild(container);\n    const canvas = html2canvas(container, {\n      scale: 2,\n      useCORS: true\n    });\n    const imgData = canvas.toDataURL('image/png');\n    const pdf = new jsPDF('p', 'pt', 'a4');\n    const width = 595.28;\n    const height = canvas.height * width / canvas.width;\n    pdf.addImage(imgData, 'PNG', 0, 0, width, height);\n    document.body.removeChild(container); // 6. Tax Breakdown page (if INR)\n\n    if (isINR && taxGroupDetails.length > 0) {\n      pdf.addPage();\n      let taxRows = taxGroupDetails.map(row => `\n      <tr>\n        <td style=\"border:1px solid #011b56;\">${row.sno}</td>\n        <td style=\"border:1px solid #011b56;\">${row.group}</td>\n        <td style=\"border:1px solid #011b56;\">${row.peramt}</td>\n        <td style=\"border:1px solid #011b56;\">${row.taxAmt}</td>\n      </tr>`).join('');\n      let taxHtml = `<div style=\"font-family:Arial; padding:40px; width:100%;\">\n      <h2 style=\"margin-bottom:20px; font-size:20px;\">Tax Breakdown</h2>\n      <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:13px;\">\n        <thead>\n          <tr style=\"background:#f4f6fa;\">\n            <th style=\"border:1px solid #011b56;\">S.No</th>\n            <th style=\"border:1px solid #011b56;\">Tax Group</th>\n            <th style=\"border:1px solid #011b56;\">Per/Amt</th>\n            <th style=\"border:1px solid #011b56;\">Tax Amt</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${taxRows}\n          <tr>\n            <td colspan=\"3\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td>\n            <td style=\"border:1px solid #011b56;\"><b>${taxAmountConv.toFixed(2)}</b></td>\n          </tr>\n          ${discountAmountConv > 0 ? `\n          <tr>\n            <td colspan=\"3\" style=\"text-align:right; border:1px solid #011b56;\"><b>Discount Amount</b></td>\n            <td style=\"border:1px solid #011b56;\"><b>${discountAmountConv.toFixed(2)}</b></td>\n          </tr>` : ''}\n        </tbody>\n      </table>\n    </div>`;\n      const taxContainer = document.createElement('div');\n      taxContainer.innerHTML = taxHtml;\n      document.body.appendChild(taxContainer);\n      const taxCanvas = html2canvas(taxContainer, {\n        scale: 1.5,\n        useCORS: true\n      });\n      const taxImg = taxCanvas.toDataURL('image/png');\n      pdf.addImage(taxImg, 'PNG', 0, 0, width, taxCanvas.height * width / taxCanvas.width);\n      document.body.removeChild(taxContainer);\n    }\n\n    pdf.setFontSize(11);\n    pdf.text(`For ${org.bgName || ''}`, width - 200, 780);\n    pdf.text('Authorized Signatory', width - 200, 800); // 7. Show PDF\n\n    const blob = pdf.output('blob');\n    const url = URL.createObjectURL(blob);\n    const newWin = window.open();\n    newWin.document.write(`\n    <html><head><title>${type} PDF Preview</title></head>\n    <body style=\"margin:0;\">\n      <iframe width=\"100%\" height=\"100%\" style=\"border:none;\" src=\"${url}\"></iframe>\n    </body></html>\n  `);\n    newWin.document.close();\n  }\n\n  componentDidMount() {\n    bsCustomFileInput.init();\n    this.fetchorders();\n    this.fetchCustomers();\n    this.fetchProducts().then(() => this.filterProductsByCategory());\n    this.fetchDespatchModes();\n    this.fetchPaymentTerms();\n    this.fetchTaxGroups(); // If navigated with route state (history.push with state), open form\n\n    const navState = this.props.location && this.props.location.state || {};\n    const openFormFromNav = navState.openForm === true;\n\n    if (navState.openForm && navState.editId) {\n      const orderToEdit = this.state.orders.find(o => o.id === navState.editId);\n\n      if (orderToEdit) {\n        this.setState(prev => ({\n          formData: { ...prev.formData,\n            ...orderToEdit,\n            editingId: orderToEdit.id\n          },\n          showForm: true\n        }), this.calculateOrderTotals);\n      }\n    }\n\n    const quoteFromSession = sessionStorage.getItem('quoteToConvert');\n\n    if (quoteFromSession && !this.state.showForm) {\n      const quote = JSON.parse(quoteFromSession);\n      sessionStorage.removeItem('quoteToConvert');\n      const lineItems = (quote.lineItems || []).map(item => {\n        const qty = parseFloat(item.qty || 1);\n        const unitPrice = parseFloat(item.unitPrice || 0);\n        const baseTotal = qty * unitPrice;\n        let percent = 0;\n        let amount = 0;\n        (item.taxGroupNames || item.taxGroup ? item.taxGroupNames || [item.taxGroup] : []).forEach(groupName => {\n          const group = (this.state.taxGroups || []).find(t => t.groupName === groupName);\n\n          if (group && Array.isArray(group.lineItems)) {\n            group.lineItems.forEach(comp => {\n              const val = parseFloat(comp.percentOrAmt || 0);\n              if (comp.type === 'Percentage') percent += val;\n              if (comp.type === 'Amount') amount += val;\n            });\n          }\n        });\n        const taxAmt = baseTotal * percent / 100 + amount;\n        const itemTotal = baseTotal + taxAmt;\n        return { ...item,\n          qty,\n          unitPrice,\n          taxAmt: taxAmt.toFixed(2),\n          itemTotal: itemTotal.toFixed(2)\n        };\n      }); // discount calculations\n\n      const quoteValue = parseFloat(quote.quoteValue || 0) || lineItems.reduce((s, li) => s + parseFloat(li.itemTotal || 0), 0);\n      const discountPercent = parseFloat(quote.discountPercent || 0) || 0;\n      const discountAmount = quoteValue * discountPercent / 100;\n      const afterDiscountValue = quoteValue - discountAmount; // Set form state and open form\n\n      this.setState(prev => ({\n        formData: { ...prev.formData,\n          ...quote,\n          showForm: true,\n          editingId: null,\n          previewOrderMode: false,\n          orderNo: `CO${1000 + prev.orders.length}`,\n          orderDate: new Date().toISOString().split('T')[0],\n          status: 'Entered',\n          orderType: 'Standard',\n          orderValue: lineItems.reduce((s, li) => s + parseFloat(li.itemTotal || 0), 0).toFixed(2),\n          discountPercent,\n          discountAmount: discountAmount.toFixed(2),\n          afterDiscountValue: afterDiscountValue.toFixed(2),\n          lineItems,\n          quoteNo: quote.quoteNo || '',\n          qrefNo: quote.quoteNo || ''\n        },\n        breakdownItems: Array.isArray(quote.breakdownItems) ? quote.breakdownItems : [],\n        showForm: true\n      }), () => {\n        this.calculateOrderTotals();\n      });\n      return;\n    } // if nav state requested open form (without session)\n\n\n    if (openFormFromNav && !this.state.showForm) {\n      // toggle an empty order form ready to be filled\n      this.toggleOrderForm(); // ensure totals initialized\n\n      this.calculateOrderTotals();\n    }\n\n    if (navState.openForm && !navState.editId && !quoteFromSession) {\n      this.toggleOrderForm();\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    // Customer details auto-fill\n    if (this.state.showForm && this.state.customers.length > 0 && this.state.formData.customer && (prevState.formData.customer !== this.state.formData.customer || !this.state.formData.billTo && !this.state.formData.shipTo)) {\n      const customerObj = this.state.customers.find(c => c.custname === this.state.formData.customer || c.custcode === this.state.formData.customer);\n\n      if (customerObj) {\n        this.setState(prev => ({\n          formData: { ...prev.formData,\n            billTo: this.formatAddress(customerObj.billTo),\n            shipTo: this.formatAddress(customerObj.shipTo),\n            currency: customerObj.currency || '' // paymentTerms: customerObj.paymentTerms || '', // No auto-fill for payment terms\n            // despatchMode: customerObj.despatchMode || '' // No auto-fill for despatch mode\n\n          }\n        }));\n      }\n    } // Freight and Tax calculation based on impExp\n\n\n    const {\n      impExp,\n      freightCharges,\n      taxPercent,\n      packingCharges,\n      lineItems\n    } = this.state.formData;\n\n    if (['None', 'CIF'].includes(impExp)) {\n      const freight = parseFloat(freightCharges) || 0;\n      const tax = parseFloat(taxPercent) || 0;\n      const packing = parseFloat(packingCharges) || 0;\n      const taxAmount = freight * tax / 100;\n      const lineTotal = lineItems.reduce((sum, item) => {\n        const total = parseFloat(item.itemTotal) || 0;\n        return sum + total;\n      }, 0);\n      const orderValue = lineTotal + freight + packing;\n\n      if (this.state.formData.taxAmount !== taxAmount.toFixed(2) || this.state.formData.orderValue !== orderValue.toFixed(2)) {\n        this.setState(prev => ({\n          formData: { ...prev.formData,\n            taxAmount: taxAmount.toFixed(2),\n            orderValue: orderValue.toFixed(2)\n          }\n        }));\n      }\n    } else if (impExp === 'FOB') {\n      if (this.state.formData.freightCharges !== '' || this.state.formData.taxPercent !== '' || this.state.formData.taxAmount !== '' || this.state.formData.packingCharges !== '') {\n        this.setState(prev => ({\n          formData: { ...prev.formData,\n            freightCharges: '',\n            taxPercent: '',\n            taxAmount: '',\n            packingCharges: '',\n            orderValue: ''\n          }\n        }));\n      }\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container-fluid\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 2168,\n        columnNumber: 7\n      }\n    }, this.state.previewOrderMode ? this.renderOrderPreview() : this.state.showForm ? this.renderorderForm() : this.renderorderTable());\n  }\n\n}\n\nexport default withRouter(Order);","map":{"version":3,"sources":["C:/Users/College/admin/StarAdmin-Free-React-Admin-Template-master/template/demo_1/src/app/sales/salestransactions/order/Order.js"],"names":["React","Component","Form","bsCustomFileInput","db","collection","getDocs","addDoc","doc","updateDoc","serverTimestamp","html2canvas","jsPDF","toWords","withRouter","numberToWords","num","a","b","Math","floor","Order","state","activeTab","breakdownItems","orders","customers","products","despatchModes","paymentTerms","showForm","editingId","overlayType","overlaySearch","productOverlayVisible","productOverlaySearch","selectedProductIds","taxGroups","showTaxOverlay","currentTaxIdx","breakdownType","searchTerm","formData","orderNo","orderDate","Date","toISOString","split","orderType","customer","status","choose","qrefNo","impExp","currency","conversionRate","taxAmount","orderValue","discountPercent","discountAmount","afterDiscountValue","billTo","shipTo","despatchMode","freightCharges","freighttaxAmount","taxPercent","packingCharges","lineItems","customerInputRef","createRef","formatAddress","addr","address","city","country","filter","Boolean","join","zip","handleOverlayClose","setState","currentTaxLineIdx","calculateOrderTotals","freight","parseFloat","packing","taxOnFreight","includes","lineTotal","itemTaxTotal","updatedLineItems","map","item","qty","unitPrice","baseTotal","groupNames","taxGroupNames","length","taxGroup","percent","amount","forEach","groupName","group","find","t","Array","isArray","comp","val","percentOrAmt","type","taxAmt","itemTotalWithTax","toFixed","itemTotal","totalTaxAmount","prev","handleDiscountChange","field","value","quoteValue","handleChooseChange","filterProductsByCategory","filteredProducts","p","category","fetchTaxGroups","snap","data","docs","id","fetchorders","sort","dateA","createdAt","toDate","dateB","reverse","fetchCustomers","fetchProducts","fetchDespatchModes","fetchPaymentTerms","handleInputChange","handleBreakdownChange","idx","items","handleBreakdownTypeChange","handleAddInlineSubProduct","breakdownIdx","initial","subProducts","defaultSP","name","push","handleRemoveSubProduct","biIdx","spIdx","splice","handleSubProductChange","sp","getSubProductsSum","bi","itemTotals","reduce","acc","li","itemCode","total","mainTotal","productId","subs","s","isBreakdownValid","TOL","subSum","abs","handleLineItemChange","updatedItems","handleSubmit","e","preventDefault","alert","payload","orderDocId","updatedAt","docRef","quoteNo","quoteSnap","quoteDoc","q","previewOrderMode","getEmptyOrderForm","loadOrderPreview","order","selectedOrder","loadorderForEdit","current","toggleOrderForm","initialFormData","toggleTaxGroupSelection","lineIdx","isChecked","g","showOverlay","hideOverlay","selectOverlayValue","currencies","d","cur","c","code","custname","custcode","renderOverlay","getFilteredRows","list","nameKey","codeKey","toLowerCase","handleSelect","title","headers","rows","fontSize","color","cursor","target","maxHeight","overflowY","h","i","j","custshortName","shortName","renderTaxOverlay","selected","Set","background","tg","has","checked","component","renderOrderPreview","o","subtotal","sum","grandTotal","amountWords","window","gstin","email","phone","itemDescription","renderBreakdownTab","sumOfItemTotals","Object","values","v","canSave","isConverted","addBreakdownFromLineItems","mainItemTotal","remaining","sno","desc","spId","rawVal","spTotal","paddingLeft","dueDate","renderProductOverlay","currentPage","itemsPerPage","filtered","ptshortName","ptdescription","totalPages","ceil","paginated","slice","display","alignItems","justifyContent","selectedProducts","some","itemType","materialType","onHand","custPartNo","hsnCode","flex","minHeight","marginTop","max","_","min","renderorderTable","gap","width","term","toString","statusClass","showPDFWithOrg","renderorderForm","isFOB","padding","backgroundColor","verticalAlign","getTaxDetailsFromGroup","totalPercent","totalAmount","orgSnap","org","gstStateMap","getPlaceOfSupply","substring","enrichedItems","product","uom","stockingUOM","taxGroupName","trim","isINR","convert","amt","freightTax","freightTaxAmt","billValue","subtotalConv","freightChargesConv","packingChargesConv","taxAmountConv","discountAmountConv","grandTotalConv","taxGroupDetails","base","tgName","peramt","container","document","createElement","style","fontFamily","numCols","innerHTML","logoUrl","bgName","website","mobile","cin","invoiceNo","cobillingNo","billNo","quoteDate","invoiceDate","cobillingDate","billDate","replace","contactPerson","gstLabel","taxId","rawTotal","itemDesc","toLocaleString","body","appendChild","canvas","scale","useCORS","imgData","toDataURL","pdf","height","addImage","removeChild","addPage","taxRows","row","taxHtml","taxContainer","taxCanvas","taxImg","setFontSize","text","blob","output","url","URL","createObjectURL","newWin","open","write","close","componentDidMount","init","then","navState","props","location","openFormFromNav","openForm","editId","orderToEdit","quoteFromSession","sessionStorage","getItem","quote","JSON","parse","removeItem","componentDidUpdate","prevProps","prevState","customerObj","tax","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Form } from 'react-bootstrap';\r\nimport bsCustomFileInput from 'bs-custom-file-input';\r\nimport { db } from '../../../../firebase';\r\nimport { collection, getDocs, addDoc, doc, updateDoc ,serverTimestamp} from 'firebase/firestore';\r\nimport html2canvas from 'html2canvas';\r\nimport { jsPDF } from 'jspdf'; \r\nimport { toWords } from \"number-to-words\";\r\nimport { withRouter } from 'react-router-dom';\r\nconst numberToWords = (num) => {\r\n  const a = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine',\r\n    'Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen',\r\n    'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];\r\n  const b = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];\r\n\r\n  if (num === 0) return 'Zero';\r\n  if (num < 20) return a[num];\r\n  if (num < 100) return b[Math.floor(num / 10)] + ' ' + a[num % 10];\r\n  if (num < 1000)\r\n    return a[Math.floor(num / 100)] + ' Hundred ' + numberToWords(num % 100);\r\n  if (num < 100000)\r\n    return numberToWords(Math.floor(num / 1000)) + ' Thousand ' + numberToWords(num % 1000);\r\n  return 'Amount too large';\r\n};\r\n\r\nclass Order extends Component {\r\n  state = {\r\n    activeTab: 'co',\r\n    breakdownItems: [],\r\n    orders: [],\r\n    customers: [],\r\n    products: [],\r\n    despatchModes: [],\r\n    paymentTerms: [],\r\n    showForm: false,\r\n    editingId: null,\r\n    overlayType: '',\r\n    overlaySearch: '',\r\n    productOverlayVisible: false,\r\n    productOverlaySearch: '',\r\n    selectedProductIds: [],\r\n    taxGroups: [],\r\n    showTaxOverlay: false,\r\n    currentTaxIdx: null,\r\n     breakdownType: 'Amount', \r\n     searchTerm:'',\r\n    formData: {\r\n      orderNo: '',\r\n      orderDate: new Date().toISOString().split('T')[0],\r\n      orderType: 'Standard',\r\n      customer: '',\r\n      status: 'Entered', \r\n      choose: 'Service',\r\n      qrefNo: '',\r\n      impExp: 'None',\r\n      currency: '',\r\n      conversionRate: '',\r\n      taxAmount: '',\r\n      orderValue: '',\r\n      discountPercent: 0,\r\n      discountAmount: 0,\r\n      afterDiscountValue: 0,\r\n      billTo: '',\r\n      shipTo: '',\r\n      despatchMode: 'By Air',\r\n      paymentTerms: '',\r\n      freightCharges: '',\r\n      freighttaxAmount: '',\r\n      taxPercent: '',\r\n      packingCharges: '',\r\n      lineItems: [],\r\n    }\r\n  };\r\n  customerInputRef = React.createRef();\r\n\r\n  formatAddress = (addr) => {\r\n    if (!addr) return '';\r\n    if (typeof addr === 'string') return addr;\r\n    return [\r\n      addr.address,\r\n      [addr.city, addr.state, addr.country].filter(Boolean).join(', '),\r\n      addr.zip\r\n    ].filter(Boolean).join('\\n');\r\n  };\r\n\r\nhandleOverlayClose = () => {\r\n  this.setState({\r\n    overlayType: '',\r\n    overlaySearch: '',\r\n    productOverlayVisible: false,\r\n    showTaxOverlay: false,\r\n    currentTaxLineIdx: null,\r\n    selectedProductIds: [],\r\n  });\r\n};\r\n\r\n\r\n   getTaxDetailsFromGroup(groupName) {\r\n    if (!groupName || groupName === 'nill' || groupName === 'more') return { totalPercent: 0, totalAmount: 0 };\r\n\r\n    const group = this.state.taxGroups.find(tg => tg.groupName === groupName);\r\n    if (!group || !Array.isArray(group.lineItems)) return { totalPercent: 0, totalAmount: 0 };\r\n\r\n    let totalPercent = 0;\r\n    let totalAmount = 0;\r\n\r\n    group.lineItems.forEach(item => {\r\n      if (item.type === 'Percentage') {\r\n        totalPercent += parseFloat(item.percentOrAmt || 0);\r\n      } else if (item.type === 'Amount') {\r\n        totalAmount += parseFloat(item.percentOrAmt || 0);\r\n      }\r\n    });\r\n\r\n    return { totalPercent, totalAmount };\r\n  }\r\n\r\n\r\ncalculateOrderTotals = () => {\r\n  const { impExp, freightCharges, taxPercent, packingCharges, lineItems } = this.state.formData;\r\n\r\n  const freight = parseFloat(freightCharges) || 0;\r\n  const packing = parseFloat(packingCharges) || 0;\r\n  let taxOnFreight = 0;\r\n  if (['None', 'CIF'].includes(impExp)) {\r\n    taxOnFreight = (freight * (parseFloat(taxPercent) || 0)) / 100;\r\n  }\r\n\r\n  let lineTotal = 0;      // sum of base totals (without tax)\r\n  let itemTaxTotal = 0;   // sum of line taxes\r\n\r\n  const updatedLineItems = (lineItems || []).map(item => {\r\n    const qty = parseFloat(item.qty || 0);\r\n    const unitPrice = parseFloat(item.unitPrice || 0);\r\n    const baseTotal = qty * unitPrice;\r\n\r\n    // tax group(s)\r\n    const groupNames = (item.taxGroupNames && item.taxGroupNames.length) ? item.taxGroupNames : (item.taxGroup ? [item.taxGroup] : []);\r\n    let percent = 0;\r\n    let amount = 0;\r\n\r\n    groupNames.forEach(groupName => {\r\n      const group = this.state.taxGroups.find(t => t.groupName === groupName);\r\n      if (group && Array.isArray(group.lineItems)) {\r\n        group.lineItems.forEach(comp => {\r\n          const val = parseFloat(comp.percentOrAmt || 0);\r\n          if (comp.type === 'Percentage') percent += val;\r\n          if (comp.type === 'Amount') amount += val;\r\n        });\r\n      }\r\n    });\r\n\r\n    const taxAmt = (baseTotal * percent) / 100 + amount;\r\n    const itemTotalWithTax = baseTotal + taxAmt;\r\n\r\n    // accumulate totals\r\n    lineTotal += baseTotal;\r\n    itemTaxTotal += taxAmt;\r\n\r\n    return {\r\n      ...item,\r\n      qty,\r\n      unitPrice,\r\n      baseTotal: baseTotal.toFixed(2),\r\n      taxAmt: taxAmt.toFixed(2),\r\n      itemTotal: itemTotalWithTax.toFixed(2)\r\n    };\r\n  });\r\n\r\n  const totalTaxAmount = itemTaxTotal + taxOnFreight;\r\n  const orderValue = lineTotal + itemTaxTotal + freight + packing + taxOnFreight;\r\n\r\n  this.setState(prev => ({\r\n    formData: {\r\n      ...prev.formData,\r\n      lineItems: updatedLineItems,\r\n      totalTaxAmount: totalTaxAmount.toFixed(2),\r\n      orderValue: orderValue.toFixed(2)\r\n    }\r\n  }));\r\n};\r\n\r\n\r\n\r\nhandleDiscountChange = (field, value) => {\r\n  let { formData } = this.state;\r\n  formData[field] = value;\r\n\r\n  const quoteValue = parseFloat(formData.quoteValue || 0);\r\n  const discountPercent = parseFloat(formData.discountPercent || 0);\r\n  const discountAmount = (quoteValue * discountPercent) / 100;\r\n  const afterDiscountValue = quoteValue - discountAmount;\r\n\r\n  formData.discountAmount = discountAmount;\r\n  formData.afterDiscountValue = afterDiscountValue;\r\n\r\n  this.setState({ formData });\r\n};\r\n\r\nhandleChooseChange = (value) => {\r\n  this.setState(prev => ({\r\n    formData: { ...prev.formData, choose: value }\r\n  }), this.filterProductsByCategory);\r\n};\r\n\r\n// Filtering logic\r\nfilterProductsByCategory = () => {\r\n  const { choose } = this.state.formData;\r\n  let filteredProducts = [];\r\n  if (choose === \"Service\") {\r\n    filteredProducts = this.state.products.filter(p => p.category === \"Service\");\r\n  } else if (choose === \"Product\") {\r\n    filteredProducts = this.state.products.filter(p => p.category === \"Product\");\r\n  } else if (choose === \"Bundle\") {\r\n    filteredProducts = this.state.products; // All products\r\n  }\r\n  this.setState({ filteredProducts });\r\n};\r\nshowPDFWithOrg(order, { customers, products, taxGroups }, type = \"ORDER\") {\r\n  // 1. Fetch org and customer order\r\n  const orgSnap = getDocs(collection(db, 'businessGroups'));\r\n  const org = orgSnap.docs[0]?.order() || {};\r\n  const customer = customers.find(\r\n    c => c.custshortName === order.customer || c.custname === order.customer\r\n  ) || {};\r\n\r\n   const gstStateMap = {\r\n    \"01\": \"Jammu & Kashmir\", \"02\": \"Himachal Pradesh\", \"03\": \"Punjab\", \"04\": \"Chandigarh\",\r\n    \"05\": \"Uttarakhand\", \"06\": \"Haryana\", \"07\": \"Delhi\", \"08\": \"Rajasthan\", \"09\": \"Uttar Pradesh\",\r\n    \"10\": \"Bihar\", \"11\": \"Sikkim\", \"12\": \"Arunachal Pradesh\", \"13\": \"Nagaland\", \"14\": \"Manipur\",\r\n    \"15\": \"Mizoram\", \"16\": \"Tripura\", \"17\": \"Meghalaya\", \"18\": \"Assam\", \"19\": \"West Bengal\",\r\n    \"20\": \"Jharkhand\", \"21\": \"Odisha\", \"22\": \"Chhattisgarh\", \"23\": \"Madhya Pradesh\", \"24\": \"Gujarat\",\r\n    \"25\": \"Daman and Diu\", \"26\": \"Dadra and Nagar Haveli\", \"27\": \"Maharashtra\", \"28\": \"Andhra Pradesh (Old)\",\r\n    \"29\": \"Karnataka\", \"30\": \"Goa\", \"31\": \"Lakshadweep\", \"32\": \"Kerala\", \"33\": \"Tamil Nadu\",\r\n    \"34\": \"Puducherry\", \"35\": \"Andaman and Nicobar Islands\", \"36\": \"Telangana\", \"37\": \"Andhra Pradesh\",\r\n    \"97\": \"Other Territory\"\r\n  };\r\n   const getPlaceOfSupply = (gstin) => {\r\n    if (!gstin || gstin.length < 2) return '';\r\n    const code = gstin.substring(0, 2);\r\n    const state = gstStateMap[code];\r\n    return state ? `${code} - ${state}` : '';\r\n  };\r\n\r\n  // 2. Enrich line items\r\n  const enrichedItems = (order.lineItems || []).map(item => {\r\n    const product = products.find(p => p.productId === item.itemCode) || {};\r\n    return {\r\n      ...item,\r\n      ptshortName: product.ptshortName || '',\r\n      hsnCode: item.hsnCode || product.hsnCode || '',\r\n      uom: item.uom || product.stockingUOM || '',\r\n      taxGroupNames: item.taxGroupNames || (item.taxGroupName ? item.taxGroupName.split(',').map(s => s.trim()) : [])\r\n    };\r\n  });\r\n\r\n  // 3. Totals and conversion\r\n  const isINR = (order.currency || 'INR') === 'INR';\r\n  const conversionRate = parseFloat(order.conversionRate || 1);\r\n  const convert = (amt) => isINR ? amt : amt * conversionRate;\r\n\r\n  const subtotal = enrichedItems.reduce((sum, item) => sum + ((parseFloat(item.unitPrice) || 0) * (parseFloat(item.qty) || 0)), 0);\r\n  const freightCharges = parseFloat(order.freightCharges || 0);\r\n  const packingCharges = parseFloat(order.packingCharges || 0);\r\n  const freightTax = parseFloat(order.freighttaxAmount || order.freightTaxAmt || 0);\r\n  const totalTaxAmount = parseFloat(order.taxAmount || order.taxAmt || 0);\r\n  const discountAmount = parseFloat(order.discountAmount || 0);\r\n  const grandTotal = parseFloat(order.afterDiscountValue || order.quoteValue || order.orderValue || order.billValue || subtotal + totalTaxAmount + freightCharges + packingCharges);\r\n\r\n  const subtotalConv = convert(subtotal);\r\n  const freightChargesConv = convert(freightCharges);\r\n  const packingChargesConv = convert(packingCharges);\r\n  const taxAmountConv = convert(totalTaxAmount);\r\n  const discountAmountConv = convert(discountAmount);\r\n  const grandTotalConv = convert(grandTotal);\r\n\r\n  // 4. Tax breakdown by group\r\n  let taxGroupDetails = [];\r\n  let sno = 1;\r\n  enrichedItems.forEach(item => {\r\n    const qty = parseFloat(item.qty || 0);\r\n    const unitPrice = parseFloat(item.unitPrice || 0);\r\n    const base = qty * unitPrice;\r\n    (item.taxGroupNames || []).forEach(tgName => {\r\n      const group = (taxGroups || []).find(g => g.groupName === tgName);\r\n      if (group) {\r\n        group.lineItems.forEach(li => {\r\n          let taxAmt = li.type === 'Amount'\r\n            ? parseFloat(li.percentOrAmt || 0)\r\n            : (base * parseFloat(li.percentOrAmt || 0)) / 100;\r\n          taxGroupDetails.push({\r\n            sno: sno++,\r\n            group: tgName,\r\n            peramt: `${li.percentOrAmt}${li.type === 'Amount' ? '' : '%'}`,\r\n            taxAmt: convert(taxAmt).toFixed(2)\r\n          });\r\n        });\r\n      }\r\n    });\r\n    if (freightTax > 0) {\r\n      taxGroupDetails.push({\r\n        sno: sno++,\r\n        group: \"Freight Tax\",\r\n        peramt: \"-\",\r\n        taxAmt: convert(freightTax).toFixed(2)\r\n      });\r\n    }\r\n  });\r\n\r\n  // 5. Build HTML for PDF\r\n  const container = document.createElement('div');\r\n  container.id = 'pdf-preview-container';\r\n  container.style.width = '794px';\r\n  container.style.padding = '40px';\r\n  container.style.fontFamily = 'Arial';\r\n\r\n  // Dynamic columns\r\n  const numCols = isINR ? 8 : 7;\r\n\r\n  container.innerHTML = `\r\n    <div style=\"display:flex; justify-content:space-between; align-items:center;\">\r\n      <img src=\"${org.logoUrl || ''}\" style=\"height:50px;\" />\r\n      <div style=\"font-size:18px; font-weight:bold;\">${type === \"QUOTE\" ? \"QUOTATION\" : type === \"ORDER\" ? \"CUSTOMER ORDER\" : type === \"BILL\" ? \"INVOICE\" : \"BILL\"}</div>\r\n    </div>\r\n    <hr/>\r\n    <div style=\"display:flex; justify-content:space-between; font-size:11px;\">\r\n      <div style=\"line-height:1.5; width:50%;\">\r\n        <b>${org.bgName || ''}</b><br/>\r\n        ${org.address || ''}<br/>\r\n        <b>Email:</b> ${org.email || ''}<br/>\r\n        <b>Website:</b> ${org.website || ''}<br/>\r\n        <b>GSTIN:</b> ${org.gstin || ''}<br/>\r\n        <b>Mobile:</b> ${org.mobile || ''}<br/>\r\n        <b>CIN:</b> ${org.cin || ''}\r\n      </div>\r\n      <table style=\"font-size:11px; text-align:left;\">\r\n        <tr><td><b>No</b></td><td>: ${order.quoteNo || order.orderNo || order.invoiceNo || order.cobillingNo || order.billNo || ''}</td></tr>\r\n        <tr><td><b>Date</b></td><td>: ${order.quoteDate || order.orderDate || order.invoiceDate || order.cobillingDate || order.billDate || ''}</td></tr>\r\n        <tr><td><b>Currency</b></td><td>: ${order.currency || 'INR'}</td></tr>\r\n        <tr><td><b>Despatch</b></td><td>: ${order.despatchMode || ''}</td></tr>\r\n      </table>\r\n    </div>\r\n    <div style=\"margin-top:15px; display:flex; justify-content:space-between; font-size:11px;\">\r\n      <div style=\"width:48%;\">\r\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Bill To</b>\r\n        <div style=\"border:1px solid #ccc; padding:6px;\">\r\n         <b>${order.customer || ''}</b><br/>\r\n          ${(order.billTo || '').replace(/\\n/g, '<br/>')}\r\n        </div>\r\n        <div style=\"font-size:10px; margin-top:6px;\">\r\n            <b>GSTIN:</b> ${customer.gstin || ''}<br/>\r\n            <b>Email:</b> ${customer.email || ''}<br/>\r\n            <b>Contact:</b> ${customer.contactPerson || ''}<br/>\r\n            <b>Phone:</b> ${customer.phone || ''}\r\n        </div>\r\n      </div>\r\n      <div style=\"width:48%;\">\r\n        <b style=\"background:#011b56; color:#fff; display:block; padding:4px;\">Ship To</b>\r\n        <div style=\"border:1px solid #ccc; padding:6px;\">\r\n         <b>${order.customer || ''}</b><br/>\r\n          ${(order.shipTo || '').replace(/\\n/g, '<br/>')}\r\n        </div>\r\n        <div style=\"font-size:10px; margin-top:6px;\">\r\n          <b>Place of Supply:</b> ${getPlaceOfSupply(customer.gstin || '')}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <table style=\"width:100%; border-collapse:collapse; font-size:12px; border:1px solid #011b56; margin-top:20px;\">\r\n      <thead>\r\n        <tr style=\"background-color:#f0f0f0; text-align:center;\">\r\n          <th style=\"border:1px solid #011b56;\">Item Code</th>\r\n          <th style=\"border:1px solid #011b56;\">Description</th>\r\n          <th style=\"border:1px solid #011b56;\">HSN</th>\r\n          <th style=\"border:1px solid #011b56;\">UOM</th>\r\n          <th style=\"border:1px solid #011b56;\">Qty</th>\r\n          <th style=\"border:1px solid #011b56;\">Unit Price</th>\r\n          ${isINR ? `<th style=\"border:1px solid #011b56;\">GST%</th>` : ''}\r\n          <th style=\"border:1px solid #011b56;\">Item Total</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        ${enrichedItems.map(item => {\r\n          const gstLabel = (item.taxGroupNames && item.taxGroupNames.length)\r\n            ? item.taxGroupNames.join(', ')\r\n            : (item.taxGroupName || item.taxId || '-');\r\n          const rawTotal = item.total ? item.total : (item.qty && item.unitPrice ? item.qty * item.unitPrice : 0);\r\n          return `\r\n            <tr>\r\n              <td style=\"border:1px solid #011b56;\">${item.itemCode || '-'}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.itemDescription || item.itemDesc || '-'}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.hsnCode || '-'}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.uom || '-'}</td>\r\n              <td style=\"border:1px solid #011b56;\">${item.qty || 0}</td>\r\n              <td style=\"border:1px solid #011b56;\">${convert(item.unitPrice).toFixed(2)}</td>\r\n              ${isINR ? `<td style=\"border:1px solid #011b56;\">${gstLabel}</td>` : ''}\r\n              <td style=\"border:1px solid #011b56;\">${convert(rawTotal).toFixed(2)}</td>\r\n            </tr>`;\r\n        }).join('')}\r\n      </tbody>\r\n      <tfoot>\r\n        <tr>\r\n          <td colspan=\"${numCols - 1}\" style=\"text-align:right; border:1px solid #011b56;\"><b>Subtotal</b></td>\r\n          <td style=\"border:1px solid #011b56;\"><b>${subtotalConv.toFixed(2)}</b></td>\r\n        </tr>\r\n        ${taxAmountConv > 0 ? `\r\n        <tr>\r\n          <td colspan=\"${numCols - 1}\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td>\r\n          <td style=\"border:1px solid #011b56;\"><b>${taxAmountConv.toFixed(2)}</b></td>\r\n        </tr>` : ''}\r\n        ${discountAmountConv > 0 ? `\r\n        <tr>\r\n          <td colspan=\"${numCols - 1}\" style=\"text-align:right; border:1px solid #011b56;\"><b>Discount Amount</b></td>\r\n          <td style=\"border:1px solid #011b56;\"><b>${discountAmountConv.toFixed(2)}</b></td>\r\n        </tr>` : ''}\r\n        <tr>\r\n          <td colspan=\"${numCols - 1}\" style=\"text-align:right; border:1px solid #011b56;\"><b>Grand Total</b></td>\r\n          <td style=\"border:1px solid #011b56;\"><b>${grandTotalConv.toFixed(2)}</b></td>\r\n        </tr>\r\n      </tfoot>\r\n    </table>\r\n    <div style=\"margin-top:8px; font-size:11px;\"><b>Amount in Words:</b> ${isINR ? `INR ${toWords(Math.floor(grandTotalConv))} Only` : `${order.currency} ${toWords(Math.floor(grandTotalConv))} Only`}</div>\r\n    <div style=\"margin-top:20px; text-align:right; font-size:10px;\">Printed on ${new Date().toLocaleString()}</div>\r\n  `;\r\n\r\n  document.body.appendChild(container);\r\n  const canvas =  html2canvas(container, { scale: 2, useCORS: true });\r\n  const imgData = canvas.toDataURL('image/png');\r\n  const pdf = new jsPDF('p', 'pt', 'a4');\r\n  const width = 595.28;\r\n  const height = canvas.height * width / canvas.width;\r\n  pdf.addImage(imgData, 'PNG', 0, 0, width, height);\r\n  document.body.removeChild(container);\r\n\r\n  // 6. Tax Breakdown page (if INR)\r\n  if (isINR && taxGroupDetails.length > 0) {\r\n    pdf.addPage();\r\n    let taxRows = taxGroupDetails.map(row => `\r\n      <tr>\r\n        <td style=\"border:1px solid #011b56;\">${row.sno}</td>\r\n        <td style=\"border:1px solid #011b56;\">${row.group}</td>\r\n        <td style=\"border:1px solid #011b56;\">${row.peramt}</td>\r\n        <td style=\"border:1px solid #011b56;\">${row.taxAmt}</td>\r\n      </tr>`).join('');\r\n\r\n    let taxHtml = `<div style=\"font-family:Arial; padding:40px; width:100%;\">\r\n      <h2 style=\"margin-bottom:20px; font-size:20px;\">Tax Breakdown</h2>\r\n      <table style=\"width:100%; border-collapse:collapse; margin-top:20px; font-size:13px;\">\r\n        <thead>\r\n          <tr style=\"background:#f4f6fa;\">\r\n            <th style=\"border:1px solid #011b56;\">S.No</th>\r\n            <th style=\"border:1px solid #011b56;\">Tax Group</th>\r\n            <th style=\"border:1px solid #011b56;\">Per/Amt</th>\r\n            <th style=\"border:1px solid #011b56;\">Tax Amt</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          ${taxRows}\r\n          <tr>\r\n            <td colspan=\"3\" style=\"text-align:right; border:1px solid #011b56;\"><b>Total Tax Amount</b></td>\r\n            <td style=\"border:1px solid #011b56;\"><b>${taxAmountConv.toFixed(2)}</b></td>\r\n          </tr>\r\n          ${discountAmountConv > 0 ? `\r\n          <tr>\r\n            <td colspan=\"3\" style=\"text-align:right; border:1px solid #011b56;\"><b>Discount Amount</b></td>\r\n            <td style=\"border:1px solid #011b56;\"><b>${discountAmountConv.toFixed(2)}</b></td>\r\n          </tr>` : ''}\r\n        </tbody>\r\n      </table>\r\n    </div>`;\r\n\r\n    const taxContainer = document.createElement('div');\r\n    taxContainer.innerHTML = taxHtml;\r\n    document.body.appendChild(taxContainer);\r\n\r\n    const taxCanvas = html2canvas(taxContainer, { scale: 1.5, useCORS: true });\r\n    const taxImg = taxCanvas.toDataURL('image/png');\r\n    pdf.addImage(taxImg, 'PNG', 0, 0, width, taxCanvas.height * width / taxCanvas.width);\r\n\r\n    document.body.removeChild(taxContainer);\r\n  }\r\n\r\n  pdf.setFontSize(11);\r\n  pdf.text(`For ${org.bgName || ''}`, width - 200, 780);\r\n  pdf.text('Authorized Signatory', width - 200, 800);\r\n\r\n  // 7. Show PDF\r\n  const blob = pdf.output('blob');\r\n  const url = URL.createObjectURL(blob);\r\n  const newWin = window.open();\r\n  newWin.document.write(`\r\n    <html><head><title>${type} PDF Preview</title></head>\r\n    <body style=\"margin:0;\">\r\n      <iframe width=\"100%\" height=\"100%\" style=\"border:none;\" src=\"${url}\"></iframe>\r\n    </body></html>\r\n  `);\r\n  newWin.document.close();\r\n}\r\ncomponentDidMount() {\r\n  bsCustomFileInput.init();\r\n  this.fetchorders();\r\n  this.fetchCustomers();\r\n  this.fetchProducts().then(() => this.filterProductsByCategory());\r\n  this.fetchDespatchModes();\r\n  this.fetchPaymentTerms();\r\n  this.fetchTaxGroups();\r\n\r\n  // If navigated with route state (history.push with state), open form\r\n  const navState = (this.props.location && this.props.location.state) || {};\r\n  const openFormFromNav = navState.openForm === true;\r\n  if (navState.openForm && navState.editId) {\r\n    const orderToEdit = this.state.orders.find(o => o.id === navState.editId);\r\n    if (orderToEdit) {\r\n      this.setState(prev => ({\r\n        formData: {\r\n          ...prev.formData,\r\n          ...orderToEdit,\r\n          editingId: orderToEdit.id,\r\n        },\r\n        showForm: true,\r\n      }), this.calculateOrderTotals);\r\n    }\r\n  }\r\n  const quoteFromSession = sessionStorage.getItem('quoteToConvert');\r\n  if (quoteFromSession && !this.state.showForm) {\r\n    const quote = JSON.parse(quoteFromSession);\r\n    sessionStorage.removeItem('quoteToConvert');\r\n\r\n    const lineItems = (quote.lineItems || []).map(item => {\r\n      const qty = parseFloat(item.qty || 1);\r\n      const unitPrice = parseFloat(item.unitPrice || 0);\r\n      const baseTotal = qty * unitPrice;\r\n      let percent = 0;\r\n      let amount = 0;\r\n      (item.taxGroupNames || item.taxGroup ? (item.taxGroupNames || [item.taxGroup]) : []).forEach(groupName => {\r\n        const group = (this.state.taxGroups || []).find(t => t.groupName === groupName);\r\n        if (group && Array.isArray(group.lineItems)) {\r\n          group.lineItems.forEach(comp => {\r\n            const val = parseFloat(comp.percentOrAmt || 0);\r\n            if (comp.type === 'Percentage') percent += val;\r\n            if (comp.type === 'Amount') amount += val;\r\n          });\r\n        }\r\n      });\r\n\r\n      const taxAmt = (baseTotal * percent) / 100 + amount;\r\n      const itemTotal = baseTotal + taxAmt;\r\n\r\n      return {\r\n        ...item,\r\n        qty,\r\n        unitPrice,\r\n        taxAmt: taxAmt.toFixed(2),\r\n        itemTotal: itemTotal.toFixed(2)\r\n      };\r\n    });\r\n\r\n    // discount calculations\r\n    const quoteValue = parseFloat(quote.quoteValue || 0) || lineItems.reduce((s, li) => s + parseFloat(li.itemTotal || 0), 0);\r\n    const discountPercent = parseFloat(quote.discountPercent || 0) || 0;\r\n    const discountAmount = (quoteValue * discountPercent) / 100;\r\n    const afterDiscountValue = quoteValue - discountAmount;\r\n\r\n    // Set form state and open form\r\n    this.setState(prev => ({\r\n      formData: {\r\n        ...prev.formData,\r\n        ...quote,\r\n        showForm: true,\r\n        editingId: null,\r\n        previewOrderMode: false,\r\n        orderNo: `CO${1000 + prev.orders.length}`,\r\n        orderDate: new Date().toISOString().split('T')[0],\r\n        status: 'Entered',\r\n        orderType: 'Standard',\r\n        orderValue: lineItems.reduce((s, li) => s + parseFloat(li.itemTotal || 0), 0).toFixed(2),\r\n        discountPercent,\r\n        discountAmount: discountAmount.toFixed(2),\r\n        afterDiscountValue: afterDiscountValue.toFixed(2),\r\n        lineItems,\r\n        quoteNo: quote.quoteNo || '',\r\n        qrefNo: quote.quoteNo || ''\r\n      },\r\n      breakdownItems: Array.isArray(quote.breakdownItems) ? quote.breakdownItems : [],\r\n      showForm: true\r\n    }), () => {\r\n      this.calculateOrderTotals();\r\n    });\r\n\r\n    return;\r\n  }\r\n\r\n  // if nav state requested open form (without session)\r\n  if (openFormFromNav && !this.state.showForm) {\r\n    // toggle an empty order form ready to be filled\r\n    this.toggleOrderForm();\r\n    // ensure totals initialized\r\n    this.calculateOrderTotals();\r\n  }\r\n  if (navState.openForm && !navState.editId && !quoteFromSession) {\r\n    this.toggleOrderForm();\r\n  }\r\n}\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    // Customer details auto-fill\r\n    if (\r\n      this.state.showForm &&\r\n      this.state.customers.length > 0 &&\r\n      this.state.formData.customer &&\r\n      (prevState.formData.customer !== this.state.formData.customer ||\r\n       (!this.state.formData.billTo && !this.state.formData.shipTo))\r\n    ) {\r\n      const customerObj = this.state.customers.find(\r\n        c => c.custname === this.state.formData.customer || c.custcode === this.state.formData.customer\r\n      );\r\n      if (customerObj) {\r\n        this.setState(prev => ({\r\n          formData: {\r\n            ...prev.formData,\r\n            billTo: this.formatAddress(customerObj.billTo),\r\n            shipTo: this.formatAddress(customerObj.shipTo),\r\n            currency: customerObj.currency || '',\r\n            // paymentTerms: customerObj.paymentTerms || '', // No auto-fill for payment terms\r\n            // despatchMode: customerObj.despatchMode || '' // No auto-fill for despatch mode\r\n          }\r\n        }));\r\n      }\r\n    }\r\n\r\n    // Freight and Tax calculation based on impExp\r\n    const { impExp, freightCharges, taxPercent,packingCharges, lineItems } = this.state.formData;\r\n    if (['None', 'CIF'].includes(impExp)) {\r\n      const freight = parseFloat(freightCharges) || 0;\r\n      const tax = parseFloat(taxPercent) || 0;\r\n      const packing = parseFloat(packingCharges) || 0;\r\n\r\n      const taxAmount = (freight * tax) / 100;\r\n\r\n      const lineTotal = lineItems.reduce((sum, item) => {\r\n  const total = parseFloat(item.itemTotal) || 0;\r\n  return sum + total;\r\n}, 0);\r\n\r\nconst orderValue = lineTotal + freight + packing;\r\n\r\n      if (\r\n    this.state.formData.taxAmount !== taxAmount.toFixed(2) ||\r\n    this.state.formData.orderValue !== orderValue.toFixed(2)\r\n  ) {\r\n    this.setState(prev => ({\r\n      formData: {\r\n        ...prev.formData,\r\n        taxAmount: taxAmount.toFixed(2),\r\n        orderValue: orderValue.toFixed(2)\r\n      }\r\n    }));\r\n  }\r\n} else if (impExp === 'FOB') {\r\n  if (\r\n    this.state.formData.freightCharges !== '' ||\r\n    this.state.formData.taxPercent !== '' ||\r\n    this.state.formData.taxAmount !== '' ||\r\n    this.state.formData.packingCharges !== ''\r\n  ) {\r\n    this.setState(prev => ({\r\n      formData: {\r\n        ...prev.formData,\r\n        freightCharges: '',\r\n        taxPercent: '',\r\n        taxAmount: '',\r\n        packingCharges: '',\r\n        orderValue: ''\r\n      }\r\n    }));\r\n  }\r\n\r\n    }\r\n  }\r\nfetchTaxGroups = async () => {\r\n  const snap = await getDocs(collection(db, 'taxGroups'));\r\n  const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n  this.setState({ taxGroups: data });\r\n};\r\n\r\n  fetchorders = async () => {\r\n    const snap = await getDocs(collection(db, 'orders'));\r\n    const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    data.sort((a,b)=>{\r\n      const dateA = new Date(a.orderDate || a.createdAt?.toDate?.() || a.createdAt || 0);\r\n      const dateB = new Date(b.orderDate || b.createdAt?.toDate?.() || b.createdAt || 0);\r\n      return dateA - dateB;\r\n    });\r\n    this.setState({ orders: data.reverse() });\r\n  };\r\n\r\n  fetchCustomers = async () => {\r\n    const snap = await getDocs(collection(db, 'customers'));\r\n    const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    this.setState({ customers: data });\r\n  };\r\n\r\n  fetchProducts = async () => {\r\n  const snap = await getDocs(collection(db, 'products'));\r\n  const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n  this.setState({ products: data, filteredProducts: data }, this.filterProductsByCategory);\r\n};\r\n  fetchDespatchModes = async () => {\r\n  const snap = await getDocs(collection(db, 'modes'));\r\n  const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n  this.setState({ despatchModes: data });\r\n};\r\n\r\nfetchPaymentTerms = async () => {\r\n  const snap = await getDocs(collection(db, 'paymentTerms'));\r\n  const data = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n  this.setState({ paymentTerms: data });\r\n};\r\n\r\n\r\n  handleInputChange = (field, value) => {\r\n  this.setState(prev => ({\r\n    formData: { ...prev.formData, [field]: value }\r\n  }), () => {\r\n    if (field === 'discountPercent') this.calculateOrderTotals();\r\n  });\r\n};\r\n  handleBreakdownChange = (idx, field, value) => {\r\n  this.setState(prev => {\r\n    const items = [...prev.breakdownItems];\r\n    items[idx][field] = value;\r\n    return { breakdownItems: items };\r\n  });\r\n};\r\n\r\n handleBreakdownTypeChange = (val) => {\r\n    this.setState({ breakdownType: val });\r\n  };\r\n\r\n  handleAddInlineSubProduct = (breakdownIdx, initial = null) => {\r\n    this.setState(prev => {\r\n      const items = [...prev.breakdownItems];\r\n      const item = items[breakdownIdx] ? { ...items[breakdownIdx] } : null;\r\n      if (!item) return {};\r\n      const subProducts = Array.isArray(item.subProducts) ? [...item.subProducts] : [];\r\n      const defaultSP = { name: '', value: '' };\r\n      subProducts.push(initial ? { ...defaultSP, ...initial } : defaultSP);\r\n      item.subProducts = subProducts;\r\n      items[breakdownIdx] = item;\r\n      return { breakdownItems: items };\r\n    });\r\n  };\r\n    handleRemoveSubProduct = (biIdx, spIdx) => {\r\n    this.setState(prev => {\r\n      const items = [...prev.breakdownItems];\r\n      if (!items[biIdx]) return {};\r\n      const item = { ...items[biIdx] };\r\n      const subProducts = Array.isArray(item.subProducts) ? [...item.subProducts] : [];\r\n      subProducts.splice(spIdx, 1);\r\n      item.subProducts = subProducts;\r\n      items[biIdx] = item;\r\n      return { breakdownItems: items };\r\n    });\r\n  };\r\n  handleSubProductChange = (biIdx, spIdx, field, value) => {\r\n    this.setState(prev => {\r\n      const items = [...prev.breakdownItems];\r\n      if (!items[biIdx]) return {};\r\n      const item = { ...items[biIdx] };\r\n      const subProducts = Array.isArray(item.subProducts) ? [...item.subProducts] : [];\r\n      const sp = { ...subProducts[spIdx], [field]: value };\r\n      subProducts[spIdx] = sp;\r\n      item.subProducts = subProducts;\r\n      items[biIdx] = item;\r\n      return { breakdownItems: items };\r\n    });\r\n  };\r\n  getSubProductsSum = (bi) => {\r\n    const { breakdownType, formData } = this.state;\r\n    const itemTotals = (formData.lineItems || []).reduce((acc, li) => {\r\n      acc[li.itemCode] = parseFloat(li.total || 0) || 0;\r\n      return acc;\r\n    }, {});\r\n    const mainTotal = itemTotals[bi.productId] || 0;\r\n    const subs = Array.isArray(bi.subProducts) ? bi.subProducts : [];\r\n    return subs.reduce((s, sp) => {\r\n      const val = parseFloat(sp.value || 0) || 0;\r\n      if (breakdownType === 'Percentage') {\r\n        return s + (mainTotal * val / 100);\r\n      }\r\n      return s + val;\r\n    }, 0);\r\n  };\r\n   isBreakdownValid = () => {\r\n    const { breakdownItems, formData } = this.state;\r\n    const itemTotals = (formData.lineItems || []).reduce((acc, li) => {\r\n      acc[li.itemCode] = parseFloat(li.total || 0) || 0;\r\n      return acc;\r\n    }, {});\r\n    const TOL = 0.01;\r\n    for (let bi of breakdownItems) {\r\n      const mainTotal = itemTotals[bi.productId] || 0;\r\n      if (mainTotal > 0) {\r\n        const subSum = this.getSubProductsSum(bi);\r\n        if (Math.abs(subSum - mainTotal) > TOL) return false;\r\n      }\r\n    }\r\n    return true;\r\n  };\r\n\r\nhandleLineItemChange = (idx, field, value) => {\r\n  const updatedItems = [...this.state.formData.lineItems];\r\n  updatedItems[idx] = { ...updatedItems[idx], [field]: value };\r\n\r\n  // recalc tax & totals for this line\r\n  const qty = parseFloat(updatedItems[idx].qty || 0);\r\n  const unitPrice = parseFloat(updatedItems[idx].unitPrice || 0);\r\n  const baseTotal = qty * unitPrice;\r\n\r\n  let percent = 0;\r\n  let amount = 0;\r\n  (updatedItems[idx].taxGroupNames || []).forEach(groupName => {\r\n    const group = this.state.taxGroups.find(t => t.groupName === groupName);\r\n    if (group && Array.isArray(group.lineItems)) {\r\n      group.lineItems.forEach(comp => {\r\n        const val = parseFloat(comp.percentOrAmt || 0);\r\n        if (comp.type === 'Percentage') percent += val;\r\n        if (comp.type === 'Amount') amount += val;\r\n      });\r\n    }\r\n  });\r\n\r\n  const taxAmt = (baseTotal * percent) / 100 + amount;\r\n  updatedItems[idx].taxAmt = taxAmt.toFixed(2);\r\n  updatedItems[idx].itemTotal = (baseTotal + taxAmt).toFixed(2);\r\n\r\n  // update state + recalc full totals\r\n  this.setState(prev => ({\r\n    formData: { ...prev.formData, lineItems: updatedItems }\r\n  }), this.calculateOrderTotals);\r\n};\r\n\r\n\r\nhandleSubmit = async (e) => {\r\n  e.preventDefault();\r\n  const { editingId, formData, orders, breakdownItems } = this.state;\r\n  if (!formData.customer) return alert(\"Customer is required\");\r\n  if (formData.lineItems.length === 0) return alert(\"At least one line item is required\");\r\n\r\n  formData.breakdownItems = breakdownItems;\r\n  const payload = {\r\n    ...formData,\r\n    status: \"Awaiting for Approval\", // Always set to Awaiting for Approval on save\r\n    breakdownItems: this.state.breakdownItems || []\r\n  };\r\n\r\n  let orderDocId = editingId;\r\n  if (editingId) {\r\n  await updateDoc(doc(db, \"orders\", editingId), {\r\n    ...formData,\r\n    breakdownItems,\r\n    status: \"Awaiting for Approval\",\r\n    updatedAt: serverTimestamp()\r\n  });\r\n  orderDocId = editingId;\r\n} else {\r\n  formData.orderNo = `CO${1000 + orders.length}`;\r\n  const docRef = await addDoc(collection(db, \"orders\"), {\r\n    ...formData,\r\n    status: \"Awaiting for Approval\",\r\n    createdAt: serverTimestamp()\r\n  });\r\n  // Save the docId back into the document\r\n  await updateDoc(docRef, { id: docRef.id });\r\n  orderDocId = docRef.id;\r\n}\r\n\r\n\r\n  // If this order was created from a quote, update quote status now\r\n  if (formData.quoteNo) {\r\n    const quoteSnap = await getDocs(collection(db, \"quotes\"));\r\n    const quoteDoc = quoteSnap.docs.find(q => q.data().quoteNo === formData.quoteNo);\r\n    if (quoteDoc) {\r\n      await updateDoc(doc(db, \"quotes\", quoteDoc.id), { status: \"CO Created\" });\r\n    }\r\n  }\r\n\r\n  this.setState({ showForm: false, editingId: null, previewOrderMode: false, formData: this.getEmptyOrderForm() });\r\n  this.fetchorders();\r\n};\r\n\r\n// Helper to reset formData\r\ngetEmptyOrderForm = () => ({\r\n  orderNo: '',\r\n  orderDate: new Date().toISOString().split('T')[0],\r\n  orderType: 'Standard',\r\n  customer: '',\r\n  status: 'Entered',\r\n  choose: 'Service',\r\n  qrefNo: '',\r\n  impExp: 'None',\r\n  currency: '',\r\n  conversionRate: '',\r\n  taxAmount: '',\r\n  orderValue: '',\r\n  discountPercent: 0,\r\n  discountAmount: 0,\r\n  afterDiscountValue: 0,\r\n  billTo: '',\r\n  shipTo: '',\r\n  despatchMode: 'By Air',\r\n  paymentTerms: '',\r\n  freightCharges: '',\r\n  freighttaxAmount: '',\r\n  taxPercent: '',\r\n  packingCharges: '',\r\n  lineItems: [],\r\n});\r\n\r\nloadOrderPreview = (order) => {\r\n  this.setState({\r\n    selectedOrder: order,\r\n    previewOrderMode: true\r\n  });\r\n};\r\n\r\nloadorderForEdit = (order) => {\r\n  this.setState({\r\n    formData: {\r\n      ...order,\r\n      lineItems: Array.isArray(order.lineItems) ? order.lineItems : []\r\n    },\r\n    breakdownItems: Array.isArray(order.breakdownItems) ? order.breakdownItems : [],\r\n    editingId: order.id,\r\n    showForm: true,\r\n    previewOrderMode: false, // <-- Ensure preview mode is off\r\n    activeTab: 'co'\r\n  }, () => {\r\n    if (this.customerInputRef.current) {\r\n      this.customerInputRef.current.value = order.customer;\r\n    }\r\n  });\r\n};\r\n\r\ntoggleOrderForm = () => {\r\n  this.setState(prev => ({\r\n    showForm: !prev.showForm,\r\n    formData: {\r\n      ...this.initialFormData, // however you reset it\r\n      orderNo: `CO${1000 + prev.orders.length}`,\r\n      orderDate: new Date().toISOString().split('T')[0],\r\n      status: 'Entered',\r\n      lineItems: []\r\n    }\r\n  }), this.calculateOrderTotals);\r\n};\r\n\r\n\r\n\r\n\r\ntoggleTaxGroupSelection = (groupName, lineIdx, isChecked) => {\r\n  const formData = { ...this.state.formData };\r\n  const item = formData.lineItems[lineIdx];\r\n\r\n  if (!item.taxGroupNames) item.taxGroupNames = [];\r\n\r\n  if (isChecked) {\r\n    if (!item.taxGroupNames.includes(groupName)) {\r\n      item.taxGroupNames.push(groupName);\r\n    }\r\n  } else {\r\n    item.taxGroupNames = item.taxGroupNames.filter(g => g !== groupName);\r\n  }\r\n\r\n  this.setState({ formData }, () => this.calculateOrderTotals());\r\n};\r\n\r\n  showOverlay = (type) => this.setState({ overlayType: type, overlaySearch: '' });\r\n  hideOverlay = () => this.setState({ overlayType: '', overlaySearch: '' });\r\n\r\n  selectOverlayValue = async(value) => {\r\n    if (this.state.overlayType === 'customer') {\r\n      let conversionRate='';\r\n      if(value.currency && value.currency !== 'INR'){\r\n        const snap=await getDocs(collection(db,'currencies'));\r\n        const currencies=snap.docs.map(d =>({id:d.id, ...d.data()}));\r\n        const cur=currencies.find(c => c.code === value.currency);\r\n        conversionRate=cur?cur.conversionRate:'';\r\n      }\r\n      this.setState(prev => ({\r\n        formData: {\r\n          ...prev.formData,\r\n          customer: value.custname || value.custcode || '', // Use custname or custcode\r\n          billTo: this.formatAddress(value.billTo),\r\n          shipTo: this.formatAddress(value.shipTo),\r\n          currency: value.currency || '',\r\n          conversionRate: conversionRate,\r\n        },\r\n        overlayType: '',\r\n        overlaySearch: ''\r\n      }), () => {\r\n        if (this.customerInputRef.current) {\r\n          this.customerInputRef.current.value = value.custname || value.custcode || '';\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n\r\n renderOverlay = () => {\r\n  const { overlayType, overlaySearch, customers, despatchModes, paymentTerms } = this.state;\r\n\r\n  const getFilteredRows = (list, nameKey = 'name', codeKey = 'shortName') =>\r\n    list.filter(item =>\r\n      (item[nameKey] || '').toLowerCase().includes((overlaySearch || '').toLowerCase()) ||\r\n      (item[codeKey] || '').toLowerCase().includes((overlaySearch || '').toLowerCase())\r\n    );\r\n\r\n  const handleSelect = (item) => {\r\n    if (overlayType === 'customer') {\r\n      this.selectOverlayValue(item);\r\n    } else if (overlayType === 'despatchMode') {\r\n      this.setState(prev => ({\r\n        formData: {\r\n          ...prev.formData,\r\n          despatchMode: item.name\r\n        },\r\n        overlayType: '',\r\n        overlaySearch: ''\r\n      }));\r\n    } else if (overlayType === 'paymentTerms') {\r\n      this.setState(prev => ({\r\n        formData: {\r\n          ...prev.formData,\r\n          paymentTerms: item.name\r\n        },\r\n        overlayType: '',\r\n        overlaySearch: ''\r\n      }));\r\n    }\r\n  };\r\n\r\n  let title = '';\r\n  let headers = [];\r\n  let rows = [];\r\n\r\n  if (overlayType === 'customer') {\r\n    title = 'Select Customer';\r\n    headers = ['Name', 'Code', 'Short Name'];\r\n    rows = getFilteredRows(customers, 'custname', 'custcode');\r\n  } else if (overlayType === 'despatchMode') {\r\n    title = 'Select Despatch Mode';\r\n    headers = ['Name'];\r\n    rows = getFilteredRows(despatchModes);\r\n  } else if (overlayType === 'paymentTerms') {\r\n    title = 'Select Payment Terms';\r\n    headers = ['Name'];\r\n    rows = getFilteredRows(paymentTerms);\r\n  } else {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"custom-overlay\">\r\n      <div className=\"custom-overlay-content\">\r\n        <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n        <div className=\"custom-overlay-title\">{title}</div>\r\n        <i className='mdi mdi-close-box-outline'\r\n        style={{ fontSize: \"24px\", color: \"#2196F3\", cursor: \"pointer\" }} \r\n            onClick={this.handleOverlayClose}\r\n            aria-label=\"Close\"\r\n            type=\"button\"\r\n          >\r\n          </i>\r\n        </div>\r\n        <input\r\n          type=\"text\"\r\n          className=\"form-control mb-2\"\r\n          placeholder={`Search ${overlayType}...`}\r\n          value={overlaySearch}\r\n          onChange={e => this.setState({ overlaySearch: e.target.value })}\r\n        />\r\n        <div style={{ maxHeight: 300, overflowY: 'auto' }}>\r\n          <table className=\"table table-bordered table-sm\">\r\n            <thead>\r\n              <tr>\r\n                {headers.map((h, i) => <th key={i}>{h}</th>)}\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {rows.map((item, i) => (\r\n                <tr key={item.id || i} onClick={() => handleSelect(item)} style={{ cursor: 'pointer' }}>\r\n                  {headers.map((h, j) => (\r\n                    <td key={j}>\r\n                      {overlayType === 'customer'\r\n                        ? h === 'Name' ? item.custname\r\n                          : h === 'Code' ? item.custcode\r\n                          : item.custshortName\r\n                        : h === 'Name' ? item.name\r\n                          : item.shortName}\r\n                    </td>\r\n                  ))}\r\n                </tr>\r\n              ))}\r\n              {rows.length === 0 && (\r\n                <tr>\r\n                  <td colSpan={headers.length} className=\"text-center\">No records found</td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nrenderTaxOverlay = () => {\r\n  const { taxGroups, currentTaxIdx, formData } = this.state;\r\n  if (currentTaxIdx === null) return null;\r\n\r\n  const item = formData.lineItems[currentTaxIdx];\r\n  const selected = new Set(item.taxGroupNames || []);\r\n\r\n  return (\r\n     <div className=\"custom-overlay\">\r\n      <div className=\"custom-overlay-content\">\r\n        <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n          <div className=\"custom-overlay-title\">Select Tax Groups</div>\r\n          <div>\r\n            <button\r\n              className=\"btn btn-primary btn-sm mr-2\"\r\n              onClick={() => this.setState({ showTaxOverlay: false })}\r\n              type=\"button\"\r\n            >\r\n              Submit\r\n            </button>\r\n            <i className=\"mdi mdi-close-box-outline\"\r\n              style={{ fontSize: \"24px\", color: \"#2196F3\", cursor: \"pointer\" }} \r\n              onClick={this.handleOverlayClose}\r\n              aria-label=\"Close\"\r\n              type=\"button\"\r\n            >\r\n            </i>\r\n          </div>\r\n          </div>\r\n      <table className=\"table table-sm table-bordered\">\r\n<thead style={{ background: '#f4f6fa' }}>\r\n            <tr>\r\n              <th></th>\r\n              <th>Group</th>\r\n              <th>Components</th>\r\n              <th>%</th>\r\n              </tr>\r\n        </thead>\r\n        <tbody>\r\n          {taxGroups.map(tg => (\r\n            <tr key={tg.groupName}>\r\n              <td>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={selected.has(tg.groupName)}\r\n                  onChange={e =>\r\n                    this.toggleTaxGroupSelection(tg.groupName, currentTaxIdx, e.target.checked)\r\n                  }\r\n                />\r\n              </td>\r\n              <td>{tg.groupName}</td>\r\n              <td>{tg.lineItems.map(li => li.component).join(', ')}</td>\r\n              <td>{tg.lineItems.map(li => li.percentOrAmt).join(', ')}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nrenderOrderPreview = () => {\r\n  const o = this.state.selectedOrder;\r\n  if (!o) return null;\r\n\r\n  const subtotal = o.lineItems?.reduce(\r\n    (sum, item) => sum + (parseFloat(item.total) || 0),\r\n    0\r\n  ) || 0;\r\n\r\n  const freightCharges = parseFloat(o.freightCharges || 0);\r\n  const taxAmount = parseFloat(o.taxAmount || 0);\r\n  const grandTotal = parseFloat(o.orderValue || subtotal + freightCharges + taxAmount);\r\n\r\n  const amountWords = `INR ${window.toWords\r\n    ? window.toWords(Math.floor(grandTotal))\r\n    : grandTotal} Only`;\r\n\r\n  // Find customer record for extra details\r\n  const customer = this.state.customers.find(\r\n    c => c.custshortName === o.customer || c.custname === o.customer\r\n  ) || {};\r\n\r\n  return (\r\n    <div className=\"card mt-4 p-4 shadow-sm full-height d-flex flex-column\">\r\n      <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n        <h4 className=\"card-title mb-0\">Order Preview - {o.orderNo}</h4>\r\n        <div className=\"flex items-center gap-x-4\">\r\n          <button\r\n          className=\"btn btn-sm btn-primary\"\r\n          onClick={() => this.loadorderForEdit(o)}\r\n          disabled={o.status !== \"Entered\" && o.status !== \"Awaiting for Approval\"}\r\n        >\r\n          Edit\r\n        </button>\r\n          \r\n        </div>\r\n      </div>\r\n      <div className=\"row mb-3\">\r\n        <div className=\"col-md-4\"><b>Customer:</b> {o.customer}</div>\r\n        <div className=\"col-md-4\"><b>Date:</b> {o.orderDate}</div>\r\n        <div className=\"col-md-4\"><b>Status:</b> {o.status}</div>\r\n      </div>\r\n      <div className=\"row mb-4\">\r\n        <div className=\"col-md-6\">\r\n          <b>Bill To:</b><br />\r\n          {o.billTo || \"-\"}\r\n          <div className=\"mt-2\" style={{ fontSize: \"0.9em\" }}>\r\n            <b>GSTIN:</b> {customer.gstin || \"-\"}<br />\r\n            <b>Email:</b> {customer.email || \"-\"}<br />\r\n            <b>Phone:</b> {customer.phone || \"-\"}\r\n          </div>\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <b>Ship To:</b><br />\r\n          {o.shipTo || \"-\"}\r\n        </div>\r\n      </div>\r\n      <h5 className=\"mt-2\">Line Items</h5>\r\n      <table className=\"table table-bordered table-sm\">\r\n        <thead className=\"thead-light\">\r\n          <tr>\r\n            <th>Item Code</th>\r\n            <th>Description</th>\r\n            <th>Qty</th>\r\n            <th>Unit Price</th>\r\n            <th>Total</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {o.lineItems?.map((item, i) => (\r\n            <tr key={i}>\r\n              <td>{item.itemCode}</td>\r\n              <td>{item.itemDescription}</td>\r\n              <td>{item.qty}</td>\r\n              <td>{item.unitPrice}</td>\r\n              <td>{item.total}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n      <div className=\"mt-3\">\r\n        <p><b>Subtotal:</b> {subtotal.toFixed(2)}</p>\r\n        <p><b>Freight Charges:</b> {freightCharges.toFixed(2)}</p>\r\n        <p><b>Tax Amount:</b> {taxAmount.toFixed(2)}</p>\r\n        <p className=\"h6\"><b>Grand Total:</b> {grandTotal.toFixed(2)}</p>\r\n        <p className=\"h6\"><b>Amount in Words:</b> {amountWords}</p>\r\n      </div>\r\n      <div className=\"mt-auto pt-3 text-right \">\r\n        <button\r\n          className=\"btn btn-secondary\"\r\n          onClick={() => this.setState({ previewOrderMode: false })}\r\n        >\r\n          Back to List\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nrenderBreakdownTab = () => {\r\n  const { breakdownItems, breakdownType, formData } = this.state;\r\n\r\n  // map item totals from lineItems (main product totals)\r\n  const itemTotals = (formData.lineItems || []).reduce((acc, li) => {\r\n    acc[li.itemCode] = parseFloat(li.total || 0) || 0;\r\n    return acc;\r\n  }, {});\r\n  const sumOfItemTotals = Object.values(itemTotals).reduce((s, v) => s + v, 0);\r\n\r\n  // compute subproducts sum\r\n  const getSubProductsSum = (bi) => {\r\n    const mainTotal = itemTotals[bi.productId] || 0;\r\n    const subs = Array.isArray(bi.subProducts) ? bi.subProducts : [];\r\n    return subs.reduce((s, sp) => {\r\n      const val = parseFloat(sp.value || 0) || 0;\r\n      return s + (breakdownType === \"Percentage\" ? (mainTotal * val / 100) : val);\r\n    }, 0);\r\n  };\r\n\r\n  const canSave = this.isBreakdownValid();\r\n  const isConverted = formData?.status === \"CO Created\"; // 🔑 single flag\r\n\r\n  return (\r\n    <div>\r\n      <h5>Milestone Breakdown</h5>\r\n\r\n      <div className=\"row mb-2\">\r\n        <div className=\"col\"><b>Quote Value:</b> {formData.quoteValue}</div>\r\n        <div className=\"col\"><b>After Discount Quote Value:</b> {formData.afterDiscountValue}</div>\r\n        <div className=\"col\"><b>Tax Amount:</b> {formData.taxAmount}</div>\r\n        <div className=\"col\"><b>Sum of Item Totals:</b> {sumOfItemTotals.toFixed(2)}</div>\r\n      </div>\r\n\r\n      {/* Mode selector + Add Breakdown button */}\r\n      <div className=\"row mb-2\">\r\n        <div className=\"col-md-3\">\r\n          <label>Subproduct Mode</label>\r\n          <select\r\n            className=\"form-control form-control-sm\"\r\n            value={breakdownType}\r\n            onChange={e => this.handleBreakdownTypeChange(e.target.value)}\r\n            disabled={isConverted} // disable if converted\r\n          >\r\n            <option value=\"Amount\">Amount</option>\r\n            <option value=\"Percentage\">Percentage</option>\r\n          </select>\r\n        </div>\r\n        <div className=\"col-md-9 text-right\">\r\n          {!isConverted && (\r\n            <button\r\n              type=\"button\"\r\n              className=\"btn btn-primary btn-sm\"\r\n              onClick={this.addBreakdownFromLineItems}\r\n            >\r\n              + Add Breakdown\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* ===== Table ===== */}\r\n      <table className=\"table table-bordered\">\r\n        <thead className=\"thead-light\">\r\n          <tr>\r\n            <th>S.No</th>\r\n            <th>ID</th>\r\n            <th>Desc / Subproduct name</th>\r\n            <th>SubProduct value ({breakdownType === \"Percentage\" ? \"%\" : \"₹\"})</th>\r\n            <th>Total (₹)</th>\r\n            <th>Due Date</th>\r\n            <th>Action</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {breakdownItems.map((item, idx) => {\r\n            const mainItemTotal = itemTotals[item.productId] || 0;\r\n            const subSum = getSubProductsSum(item);\r\n            const remaining = mainItemTotal - subSum;\r\n            const subs = Array.isArray(item.subProducts) ? item.subProducts : [];\r\n\r\n            return (\r\n              <React.Fragment key={idx}>\r\n                {/* parent product row */}\r\n                <tr style={{ background: \"#eef4ff\" }}>\r\n                  <td>{item.sno}</td>\r\n                  <td>{item.productId}</td>\r\n                  <td>{item.desc}</td>\r\n                  <td>\r\n                    <div>\r\n                      <div><small>Subproducts sum: <b>{subSum.toFixed(2)}</b></small></div>\r\n                      <div>\r\n                        <small>\r\n                          Remaining:{\" \"}\r\n                          <b style={{ color: remaining > 0.01 ? \"red\" : \"green\" }}>\r\n                            {remaining.toFixed(2)}\r\n                          </b>\r\n                        </small>\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                  <td>{mainItemTotal.toFixed(2)}</td>\r\n                  <td></td>\r\n                  <td>\r\n                  {!isConverted && (\r\n                    <div className=\"d-flex\">\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"btn btn-sm btn-outline-primary mr-2\"\r\n                        onClick={() => this.handleAddInlineSubProduct(idx)}\r\n                      >+ Add</button>\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"btn btn-sm btn-outline-secondary\"\r\n                        onClick={() => {\r\n                          if (remaining <= 0) return;\r\n                          this.handleAddInlineSubProduct(idx, {\r\n                            name: \"New Product\",\r\n                            value: breakdownType === \"Percentage\"\r\n                              ? ((remaining * 100) / (mainItemTotal || 1)).toFixed(2)\r\n                              : remaining.toFixed(2)\r\n                          });\r\n                        }}\r\n                      >Auto-fill</button>\r\n                      \r\n                    </div>\r\n                  )}\r\n                </td>\r\n                </tr>\r\n\r\n                {/* subproduct rows */}\r\n                {subs.length === 0 && (\r\n                  <tr key={`notice-${idx}`}>\r\n                    <td colSpan=\"6\" className=\"text-center text-muted\">\r\n                      No subproducts added for this item.\r\n                    </td>\r\n                  </tr>\r\n                )}\r\n\r\n                {subs.map((sp, spIdx) => {\r\n                  const spId = `${item.productId}_${spIdx + 1}`;\r\n                  const rawVal = parseFloat(sp.value || 0) || 0;\r\n                  const spTotal = breakdownType === \"Percentage\"\r\n                    ? (mainItemTotal * rawVal / 100)\r\n                    : rawVal;\r\n\r\n                  return (\r\n                    <tr key={spId} style={{ background: \"#f9f9f9\" }}>\r\n                      <td className=\"text-muted\">—</td>\r\n                      <td>{spId}</td>\r\n                      <td>\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={sp.name || \"\"}\r\n                          onChange={(e) => this.handleSubProductChange(idx, spIdx, \"name\", e.target.value)}\r\n                          placeholder=\"Enter name\"\r\n                          disabled={isConverted}\r\n                          style={{ paddingLeft: \"18px\" }}\r\n                        />\r\n                      </td>\r\n                      <td>\r\n                        <input\r\n                          type=\"number\"\r\n                          step=\"any\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={sp.value || \"\"}\r\n                          onChange={(e) => this.handleSubProductChange(idx, spIdx, \"value\", e.target.value)}\r\n                          disabled={isConverted}\r\n                        />\r\n                      </td>\r\n                      <td>{spTotal.toFixed(2)}</td>\r\n                      <td>\r\n                      <input\r\n                        type=\"date\"\r\n                        className=\"form-control form-control-sm\"\r\n                        value={sp.dueDate || \"\"}\r\n                        onChange={(e) =>\r\n                          this.handleSubProductChange(idx, spIdx, \"dueDate\", e.target.value)\r\n                        }\r\n                        disabled={isConverted}\r\n                      />\r\n                    </td>\r\n\r\n                      <td>\r\n                      {!isConverted && (\r\n                        <>\r\n                          <button\r\n                            type=\"button\"\r\n                            className=\"btn btn-sm btn-danger\"\r\n                            onClick={() => this.handleRemoveSubProduct(idx, spIdx)}\r\n                          >-</button>\r\n                        </>\r\n                      )}\r\n                    </td>\r\n                    </tr>\r\n                  );\r\n                })}\r\n              </React.Fragment>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n\r\n      {!canSave && !isConverted && (\r\n        <div className=\"alert alert-danger\">\r\n          Breakdown incomplete — for each product the sum of subproduct totals\r\n          must equal the product total. Save disabled until fixed.\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\nrenderProductOverlay = () => {\r\n  const { filteredProducts, productOverlaySearch, selectedProductIds, currentPage = 1 } = this.state;\r\n  const itemsPerPage = 10;\r\n  const filtered = filteredProducts.filter(p =>\r\n    (p.ptshortName || '').toLowerCase().includes(productOverlaySearch.toLowerCase()) ||\r\n    (p.ptdescription || '').toLowerCase().includes(productOverlaySearch.toLowerCase()) ||\r\n    (p.itemCode || '').toLowerCase().includes(productOverlaySearch.toLowerCase())\r\n  );\r\n  const totalPages = Math.ceil(filtered.length / itemsPerPage);\r\n  const paginated = filtered.slice((currentPage - 1) * itemsPerPage, currentPage * itemsPerPage);\r\n\r\n  return (\r\n    <div className=\"custom-overlay\" \r\n    style={{ display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\r\n      <div\r\n        className=\"custom-overlay-content\"\r\n      >\r\n        <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n          <div className=\"custom-overlay-title\">Select Products</div>\r\n          <div className=\"d-flex align-items-center\">\r\n            <button\r\n              className=\"btn btn-primary btn-sm mr-2\"\r\n              type=\"button\"\r\n              onClick={() => {\r\n                const selectedProducts = filteredProducts.filter(p => selectedProductIds.includes(p.id));\r\n                this.setState(prev => ({\r\n                  formData: {\r\n                    ...prev.formData,\r\n                    lineItems: [\r\n                      ...prev.formData.lineItems,\r\n                      ...selectedProducts\r\n                        .filter(p => !prev.formData.lineItems.some(item => item.id === p.id))\r\n                        .map(p => ({\r\n                          id: p.id,\r\n                          itemCode: p.productId || '',\r\n                          itemDescription: p.ptdescription || '',\r\n                          itemType: p.itemType || '',\r\n                          materialType: p.materialType || '',\r\n                          onHand: p.onHand || 0,\r\n                          taxGroup: p.taxGroup || '',\r\n                          custPartNo: p.custPartNo || '',\r\n                          hsnCode: p.hsnCode || '',\r\n                          unitPrice: p.unitPrice || 0,\r\n                          qty: 1,\r\n                          total: (p.unitPrice || 0).toFixed(2)\r\n                        }))\r\n                    ]\r\n                  },\r\n                  productOverlayVisible: false,\r\n                  selectedProductIds: []\r\n                }));\r\n              }}\r\n            >\r\n              Add Selected\r\n            </button>\r\n            <i\r\n              className=\"mdi mdi-close-box-outline\"\r\n              style={{ fontSize: \"24px\", color: \"#2196F3\", cursor: \"pointer\" }}\r\n              onClick={this.handleOverlayClose}\r\n              aria-label=\"Close\"\r\n              type=\"button\"\r\n            ></i>\r\n          </div>\r\n        </div>\r\n        {/* Search */}\r\n        <input\r\n          type=\"text\"\r\n          className=\"form-control mb-2\"\r\n          placeholder=\"Search products...\"\r\n          value={productOverlaySearch}\r\n          onChange={e => this.setState({ productOverlaySearch: e.target.value, currentPage: 1 })}\r\n        />\r\n        {/* Table in scrollable area */}\r\n        <div style={{ flex: 1, overflowY: 'auto', minHeight: 0 }}>\r\n          <table className=\"table table-bordered table-sm mb-0\">\r\n            <thead>\r\n              <tr>\r\n                <th></th>\r\n                <th>Item Code</th>\r\n                <th>Item Desc</th>\r\n                <th>Item Type</th>\r\n                <th>Material Type</th>\r\n                <th>On Hand</th>\r\n                <th>Tax Grp</th>\r\n                <th>Cust Part No</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {paginated.map(p => (\r\n                <tr key={p.id}>\r\n                  <td>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={selectedProductIds.includes(p.id)}\r\n                      onChange={e => {\r\n                        const checked = e.target.checked;\r\n                        this.setState(prev => ({\r\n                          selectedProductIds: checked\r\n                            ? [...prev.selectedProductIds, p.id]\r\n                            : prev.selectedProductIds.filter(id => id !== p.id)\r\n                        }));\r\n                      }}\r\n                    />\r\n                  </td>\r\n                  <td>{p.productId}</td>\r\n                  <td>{p.ptdescription || ''}</td>\r\n                  <td>{p.itemType || ''}</td>\r\n                  <td>{p.materialType || ''}</td>\r\n                  <td>{p.onHand || 0}</td>\r\n                  <td>{p.taxGroup || ''}</td>\r\n                  <td>{p.custPartNo || ''}</td>\r\n                </tr>\r\n              ))}\r\n              {paginated.length === 0 && (\r\n                <tr>\r\n                  <td colSpan=\"8\" className=\"text-center\">No products found</td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        {/* Pagination at the bottom */}\r\n        <nav aria-label=\"Product pagination example\" style={{ marginTop: 12 }}>\r\n          <ul className=\"pagination justify-content-end mb-0\">\r\n            <li className={`page-item ${currentPage === 1 ? \"disabled\" : \"\"}`}>\r\n              <button\r\n                className=\"page-link\"\r\n                aria-label=\"Previous\"\r\n                onClick={() => this.setState({ currentPage: Math.max(currentPage - 1, 1) })}\r\n              >\r\n                <span aria-hidden=\"true\">&laquo;</span>\r\n              </button>\r\n            </li>\r\n            {[...Array(totalPages)].map((_, idx) => (\r\n              <li key={idx} className={`page-item ${currentPage === idx + 1 ? \"active\" : \"\"}`}>\r\n                <button\r\n                  className=\"page-link\"\r\n                  onClick={() => this.setState({ currentPage: idx + 1 })}\r\n                >\r\n                  {idx + 1}\r\n                </button>\r\n              </li>\r\n            ))}\r\n            <li className={`page-item ${currentPage === totalPages ? \"disabled\" : \"\"}`}>\r\n              <button\r\n                className=\"page-link\"\r\n                aria-label=\"Next\"\r\n                onClick={() => this.setState({ currentPage: Math.min(currentPage + 1, totalPages) })}\r\n              >\r\n                <span aria-hidden=\"true\">&raquo;</span>\r\n              </button>\r\n            </li>\r\n          </ul>\r\n        </nav>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n  renderorderTable = () => (\r\n    <div className=\"card mt-4 full-height\">\r\n      <div className=\"card-body\">\r\n       <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n  <h4 className=\"card-title mb-0\">Customer Orders</h4>\r\n\r\n  <div className=\"d-flex align-items-center\" style={{ gap: '10px', width: '40%' }}>\r\n    <input\r\n      type=\"text\"\r\n      className=\"form-control\"\r\n      placeholder=\"Search by Bill No, Customer, Status, Date...\"\r\n      value={this.state.searchTerm}\r\n      onChange={(e) => this.setState({ searchTerm: e.target.value })}\r\n    />\r\n    <button\r\n    type=\"button\"\r\n      className=\"btn btn-primary\"\r\n      onClick={() => this.setState({ showForm: true })}\r\n    >\r\n     Create\r\n    </button>\r\n  </div>\r\n</div>\r\n\r\n        <div className=\"table-responsive\">\r\n          <table className=\"table table-bordered table-hover\">\r\n            <thead className=\"thead-light\">\r\n              <tr style={{ fontSize: '14px' }}>\r\n                <th>Order No</th>\r\n                <th>Customer</th>\r\n                <th>Date</th>\r\n                <th>Ref No</th>\r\n                <th>Order Value</th>\r\n                <th>After Discount</th>\r\n                <th>Status</th>\r\n                <th>Action</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {this.state.orders\r\n              .filter((q)=>{\r\n                 const term = this.state.searchTerm.toLowerCase();\r\n                 if (!term) return true;\r\n                 return (\r\n                  (q.orderNo || \"\").toLowerCase().includes(term) ||\r\n                  (q.customer || \"\").toLowerCase().includes(term) ||\r\n                  (q.status || \"\").toLowerCase().includes(term) ||\r\n                  (q.orderDate || \"\").toLowerCase().includes(term) ||\r\n                  (q.qrefNo || \"\").toLowerCase().includes(term) ||\r\n                  (q.orderValue?.toString() || \"\").toLowerCase().includes(term) ||\r\n                  (q.afterDiscountValue?.toString() || \"\").toLowerCase().includes(term)\r\n                 );\r\n                }).map((q, i) => {\r\n\r\n                let statusClass = \"badge-secondary\";\r\n                if( q.status === \"Awaiting for Approval\") statusClass=\"badge-warning\";\r\n                else if(q.status === \"CO Created\") statusClass=\"badge-secondary\";\r\n                else if(q.status === \"Approved\") statusClass=\"badge-success\";\r\n                else if(q.status === \"Rejected\") statusClass=\"badge-danger\";\r\n\r\n                return(\r\n                  <tr key={i} style={{ fontSize: '14px' }}>\r\n                  <td>\r\n                    <button\r\n                     className=\"btn btn-link p-0\" \r\n                     onClick={() => this.loadOrderPreview(q)}>\r\n                    {q.orderNo}\r\n                  </button>\r\n\r\n                  </td>\r\n                  <td>{q.customer}</td>\r\n                  <td>{q.orderDate}</td>\r\n                  <td>{q.qrefNo}</td>\r\n                  <td>{q.orderValue}</td>\r\n                  <td>{q.afterDiscountValue}</td>\r\n                  <td>\r\n                    <label className={`badge ${statusClass}`}\r\n                    style={{fontSize: '14px'}}>{q.status}</label></td>\r\n                    <td>\r\n                       <i\r\n                      className=\"mdi mdi-printer menu-icon\"\r\n                      onClick={() => this.showPDFWithOrg(q, {\r\n                        customers: this.state.customers,\r\n                        products: this.state.products,\r\n                        taxGroups: this.state.taxGroups\r\n                      }, \"ORDER\")}\r\n                      style={{ fontSize: '24px', color: '#2196F3', cursor: 'pointer' }}\r\n                      ></i>\r\n                      </td>\r\n                  \r\n                </tr>\r\n                );\r\n              })}\r\n                    {this.state.orders.length === 0 && (\r\n                <tr><td colSpan=\"6\" className=\"text-center\">No orders found.</td></tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  renderorderForm = () => {\r\n    const { formData, overlayType, productOverlayVisible,breakdownItems,breakdownType } = this.state;\r\n    const isFOB = formData.impExp === 'FOB';\r\n      const itemTotals = (formData.lineItems || []).reduce((acc, li) => {\r\n      acc[li.itemCode] = parseFloat(li.total || 0) || 0;\r\n      return acc;\r\n    }, {});\r\n    const sumOfItemTotals = Object.values(itemTotals).reduce((sum, val) => sum + val, 0);\r\n\r\n\r\n    return (\r\n      <div>\r\n        <div className=\"card full-height\">\r\n          <div style={{ flex: 1, overflowY: 'auto', padding: '24px' }}>\r\n            <h4 className=\"mb-3\">Order Form</h4>\r\n            <ul className=\"nav nav-tabs\" role=\"tablist\">\r\n              <li className=\"nav-item\">\r\n                <button type=\"button\" className={`nav-link ${this.state.activeTab === 'co' ? 'active' : ''}`} onClick={() => this.setState({ activeTab: 'co' })}>CO Details</button>\r\n              </li>\r\n              <li className=\"nav-item\">\r\n                <button type=\"button\" className={`nav-link ${this.state.activeTab === 'commercial' ? 'active' : ''}`} onClick={() => this.setState({ activeTab: 'commercial' })}>Commercial Terms</button>\r\n              </li>\r\n              <li className=\"nav-item\">\r\n              <button type=\"button\" className={`nav-link ${this.state.activeTab === 'breakdown' ? 'active' : ''}`} onClick={() => this.setState({ activeTab: 'breakdown' })}>Breakdown</button>\r\n            </li>\r\n            </ul>\r\n            <form className=\"form-sample\" onSubmit={this.handleSubmit}>\r\n              <div className=\"tab-content pt-3\">\r\n                {this.state.activeTab === 'co' && (\r\n                  <>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Order No</label>\r\n                        <input type=\"text\" className=\"form-control form-control-sm\" value={formData.orderNo} onChange={(e) => this.handleInputChange('orderNo', e.target.value)} />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Order Date</label>\r\n                        <input type=\"date\" className=\"form-control form-control-sm\" value={formData.orderDate} onChange={(e) => this.handleInputChange('orderDate', e.target.value)} />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Order Type</label>\r\n                        <select className=\"form-control form-control-sm\" value={formData.orderType} onChange={(e) => this.handleInputChange('orderType', e.target.value)}>\r\n                          <option>Standard</option>\r\n                          <option>Manual</option>\r\n                        </select>\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Status</label>\r\n                        <input type=\"text\" className=\"form-control form-control-sm\" value={formData.status}   style={{ backgroundColor: '#fff' }} readOnly />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Customer</label>\r\n                        <div className=\"input-group input-group-sm\">\r\n                          <input\r\n                            type=\"text\"\r\n                            className=\"form-control\"\r\n                            placeholder=\"Choose Customer\"\r\n                            ref={this.customerInputRef}\r\n                            value={formData.customer}\r\n                            readOnly\r\n                            onClick={() => this.showOverlay('customer')}\r\n                            style={{ cursor: 'pointer' }}\r\n                          />\r\n                          <div className=\"input-group-append\">\r\n                            <button className=\"btn btn-outline-secondary btn-sm\" type=\"button\" onClick={() => this.showOverlay('customer')}>Select</button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>IMP/EXP</label>\r\n                        <select\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.impExp}\r\n                          onChange={(e) => this.handleInputChange('impExp', e.target.value)}\r\n                        >\r\n                          <option>None</option>\r\n                          <option>COB</option>\r\n                          <option>FOB</option>\r\n                          <option>CIF</option>\r\n                        </select>\r\n                      </div>\r\n                      <div className=\"form-group col-md-2\">\r\n                        <label>Ref No.</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.qrefNo}\r\n                          onChange={(e) => this.handleInputChange('qrefNo', e.target.value)}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                    <label>Choose</label>\r\n                    <div className=\"d-flex align-items-center\">\r\n                      <div className=\"form-check mr-4\">\r\n                        <input type=\"radio\" className=\"form-check-input\" name=\"choose\" id=\"chooseService\" value=\"Service\"\r\n                          checked={formData.choose === 'Service'}\r\n                          onChange={e => this.handleChooseChange(e.target.value)}\r\n                        />\r\n                        <label className=\"form-check-label\" htmlFor=\"chooseService\">Service</label>\r\n                      </div>\r\n                      <div className=\"form-check mr-4\">\r\n                        <input type=\"radio\" className=\"form-check-input\" name=\"choose\" id=\"chooseProduct\" value=\"Product\"\r\n                          checked={formData.choose === 'Product'}\r\n                          onChange={e => this.handleChooseChange(e.target.value)}\r\n                        />\r\n                        <label className=\"form-check-label\" htmlFor=\"chooseProduct\">Product</label>\r\n                      </div>\r\n                      <div className=\"form-check\">\r\n                        <input type=\"radio\" className=\"form-check-input\" name=\"choose\" id=\"chooseBundle\" value=\"Bundle\"\r\n                          checked={formData.choose === 'Bundle'}\r\n                          onChange={e => this.handleChooseChange(e.target.value)}\r\n                        />\r\n                        <label className=\"form-check-label\" htmlFor=\"chooseBundle\">Service+Product</label>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Currency</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.currency}\r\n                          style={{ backgroundColor: '#fff' }}\r\n                          readOnly\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Conversion Rate</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.conversionRate}\r\n                          onChange={(e) => this.handleInputChange('conversionRate', e.target.value)}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Tax Amount</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.totalTaxAmount}\r\n                          onChange={(e) => this.handleInputChange('totalTaxAmount', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-3\">\r\n                        <label>Order Value</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.orderValue}\r\n                          onChange={(e) => this.handleInputChange('orderValue', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-4\">\r\n                      <label>Discount %</label>\r\n                      <input\r\n                        type=\"number\"\r\n                        className='form-control'\r\n                        value={formData.discountPercent}\r\n                        onChange={e => {\r\n                          this.handleInputChange('discountPercent', e.target.value);\r\n                        }}\r\n                      />\r\n                    </div>\r\n                    <div className=\"form-group col-md-4\">\r\n                    <label>Discount Amount</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      className=\"form-control\"\r\n                      value={this.state.formData.discountAmount}\r\n                      readOnly\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group col-md-4\">\r\n                      <label>After Discount - Quote Value</label>\r\n                      <input\r\n                        type=\"number\"\r\n                        className=\"form-control\"\r\n                        value={this.state.formData.afterDiscountValue}\r\n                        readOnly\r\n                      />\r\n                    </div>\r\n                </div>\r\n                          <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n                            <h4 className=\"card-title\">Line Item</h4>\r\n                            <button type=\"button\" className=\"btn btn-primary btn-sm\" onClick={() => this.setState({ productOverlayVisible: true })}>\r\n                              + Add Product\r\n                            </button>\r\n                          </div>\r\n                          <div className=\"table-responsive\">\r\n                            <table className=\"table table-bordered\">\r\n                              <thead className=\"thead-light\">\r\n                                <tr >\r\n                                  <th> Item Code </th>\r\n                                  <th> Item Desc </th>\r\n                                  <th> Cust Part No </th>\r\n                                  <th> HSN No </th>\r\n                                  <th> On Hand </th> \r\n                                  <th>Unit Price</th>\r\n                                  <th>Quantity</th>\r\n                                  <th>Tax Id</th>\r\n                                  <th>Item Total</th>\r\n                                  <th>Tax amount</th>\r\n                                  <th>Grand Total</th>\r\n                                </tr>\r\n                              </thead>\r\n                              <tbody>\r\n                                {formData.lineItems.map((item, idx) => (\r\n                                  <tr key={item.id || idx}>\r\n                                    <td>{item.itemCode}</td>\r\n                                    <td>{item.itemDescription}</td>\r\n                                    <td>{item.custPartNo}</td>\r\n                                    <td>{item.hsnCode}</td>\r\n                                    <td>{item.onHand}</td>\r\n                                    <td>\r\n                                      <input\r\n                                        type=\"number\"\r\n                                        value={item.unitPrice}\r\n                                        onChange={e => this.handleLineItemChange(idx, 'unitPrice', e.target.value)}\r\n                                        style={{ width: 80 }}\r\n                                      />\r\n                                    </td>\r\n                                    <td>\r\n                                      <input\r\n                                        type=\"number\"\r\n                                        min=\"1\"\r\n                                        value={item.qty}\r\n                                        onChange={e => this.handleLineItemChange(idx, 'qty', e.target.value)}\r\n                                        style={{ width: 60 }}\r\n                                      />\r\n                                    </td>\r\n                                    <td style={{ verticalAlign: 'middle' }}>\r\n                                      <button\r\n                                        type=\"button\"\r\n                                        className=\"btn btn-sm btn-outline-primary\"\r\n                                        onClick={() => this.setState({ showTaxOverlay: true, currentTaxIdx: idx })}\r\n                                      >\r\n                                        Select Tax\r\n                                      </button>\r\n                                      <div style={{ fontSize: '10px', marginTop: '4px' }}>\r\n                                        {(item.taxGroupNames || []).join(', ') || '-'}\r\n                                      </div>\r\n                                    </td>\r\n                                    <td>{item.baseTotal || '0.00'}</td>\r\n                                      <td>{item.taxAmt || '0.00'}</td>\r\n                                      <td>{item.itemTotal || '0.00'}</td>\r\n\r\n                                     \r\n                                  </tr>\r\n                                ))}\r\n                                {formData.lineItems.length === 0 && (\r\n                                  <tr>\r\n                                    <td colSpan=\"9\" className=\"text-center\">No items</td>\r\n                                  </tr>\r\n                                )}\r\n                              </tbody>\r\n                            </table>\r\n                          </div>\r\n                      \r\n                  </>\r\n                )}\r\n                {this.state.activeTab === 'commercial' && (\r\n                  <>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-6\">\r\n                        <label>Bill To</label>\r\n                        <textarea\r\n                          className=\"form-control form-control-sm\"\r\n                          rows=\"3\"\r\n                          value={formData.billTo}\r\n                          onChange={(e) => this.handleInputChange('billTo', e.target.value)}\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-6\">\r\n                        <label>Ship To</label>\r\n                        <textarea\r\n                          className=\"form-control form-control-sm\"\r\n                          rows=\"3\"\r\n                          value={formData.shipTo}\r\n                          onChange={(e) => this.handleInputChange('shipTo', e.target.value)}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                    <div className=\"form-group col-md-4\">\r\n  <label>Despatch Mode</label>\r\n  <div className=\"input-group input-group-sm\">\r\n    <input\r\n      type=\"text\"\r\n      className=\"form-control\"\r\n      value={formData.despatchMode}\r\n      readOnly\r\n      onClick={() => !isFOB && this.showOverlay('despatchMode')}\r\n      style={{ cursor: isFOB ? 'not-allowed' : 'pointer', backgroundColor: '#fff' }}\r\n    />\r\n    <div className=\"input-group-append\">\r\n      <button\r\n        className=\"btn btn-outline-secondary btn-sm\"\r\n        type=\"button\"\r\n        disabled={isFOB}\r\n        onClick={() => this.showOverlay('despatchMode')}\r\n      >\r\n        Select\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div className=\"form-group col-md-4\">\r\n  <label>Payment Terms</label>\r\n  <div className=\"input-group input-group-sm\">\r\n    <input\r\n      type=\"text\"\r\n      className=\"form-control\"\r\n      value={formData.paymentTerms}\r\n      readOnly\r\n      onClick={() => !isFOB && this.showOverlay('paymentTerms')}\r\n      style={{ cursor: isFOB ? 'not-allowed' : 'pointer', backgroundColor: '#fff' }}\r\n    />\r\n    <div className=\"input-group-append\">\r\n      <button\r\n        className=\"btn btn-outline-secondary btn-sm\"\r\n        type=\"button\"\r\n        disabled={isFOB}\r\n        onClick={() => this.showOverlay('paymentTerms')}\r\n      >\r\n        Select\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Freight Charges</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.freightCharges}\r\n                          onChange={(e) => this.handleInputChange('freightCharges', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Tax %</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.taxPercent}\r\n                          onChange={(e) => this.handleInputChange('taxPercent', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Freight Tax Amount</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.taxAmount}\r\n                          onChange={(e) => this.handleInputChange('freighttaxAmount', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                      <div className=\"form-group col-md-4\">\r\n                        <label>Packing Charges</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          className=\"form-control form-control-sm\"\r\n                          value={formData.packingCharges}\r\n                          onChange={(e) => this.handleInputChange('packingCharges', e.target.value)}\r\n                          readOnly={isFOB} // Read-only if FOB\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"text-right mt-3\">\r\n                      <button type=\"submit\" className=\"btn btn-success\">Save All Details</button>\r\n                    </div>\r\n                  </>\r\n                )}\r\n                 {this.state.activeTab === 'breakdown' && (this.renderBreakdownTab())}\r\n              </div>\r\n\r\n             <div className=\"fixed-card-footer text-right p-3 border-top bg-white\">\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"btn btn-secondary mr-2\"\r\n                  onClick={() => this.setState({ showForm: false, editingId: null })}\r\n                >\r\n                  Cancel\r\n                </button>\r\n   <button type=\"submit\" className=\"btn btn-success \" disabled={!this.isBreakdownValid()}>Save All Details</button>\r\n\r\n              </div>\r\n            </form>\r\n            {overlayType && this.renderOverlay()}\r\n            {productOverlayVisible && this.renderProductOverlay()}\r\n            {this.state.showTaxOverlay && this.renderTaxOverlay()}\r\n          </div>\r\n           \r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"container-fluid\">\r\n        {this.state.previewOrderMode ? this.renderOrderPreview() : (this.state.showForm ? this.renderorderForm() : this.renderorderTable())}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Order);\r\n"]},"metadata":{},"sourceType":"module"}