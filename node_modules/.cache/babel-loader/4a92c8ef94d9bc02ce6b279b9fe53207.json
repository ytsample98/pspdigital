{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\College\\\\admin\\\\StarAdmin-Free-React-Admin-Template-master\\\\template\\\\demo_1\\\\src\\\\app\\\\inventory\\\\invmaster\\\\CurrencyPage.js\";\nimport React, { Component } from 'react';\nimport { db } from '../../../firebase';\nimport { collection, addDoc, getDocs, updateDoc, deleteDoc, doc } from 'firebase/firestore';\n\nclass CurrencyPage extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      currencies: [],\n      formData: {\n        name: '',\n        code: '',\n        conversionRate: ''\n      },\n      editingId: null,\n      loading: false\n    };\n\n    this.componentDidMount = async () => {\n      this.fetchCurrencies();\n    };\n\n    this.fetchCurrencies = async () => {\n      const snap = await getDocs(collection(db, 'currencies'));\n      const currencies = snap.docs.map(d => ({\n        id: d.id,\n        ...d.data()\n      }));\n      this.setState({\n        currencies\n      });\n    };\n\n    this.syncLiveRates = async () => {\n      try {\n        this.setState({\n          loading: true\n        });\n        const res = await fetch('https://api.exchangerate.host/latest?base=INR&cors=true');\n        const data = await res.json();\n\n        if (!data.rates) {\n          alert('Failed to fetch live rates');\n          return;\n        }\n\n        const allRates = Object.entries(data.rates).map(([code, rate]) => ({\n          code,\n          name: code,\n          conversionRate: rate,\n          base: 'INR'\n        })); // Remove old before re-syncing (optional, to avoid duplicates)\n\n        const existingSnap = await getDocs(collection(db, 'currencies'));\n        const deletePromises = existingSnap.docs.map(d => deleteDoc(doc(db, 'currencies', d.id)));\n        await Promise.all(deletePromises); // Add all fresh rates\n\n        await Promise.all(allRates.map(cur => addDoc(collection(db, 'currencies'), cur)));\n        alert('Live rates synced successfully (Base: INR)');\n        this.fetchCurrencies();\n      } catch (err) {\n        console.error('Sync failed:', err);\n        alert('Error syncing live rates. Check internet/CORS.');\n      } finally {\n        this.setState({\n          loading: false\n        });\n      }\n    };\n\n    this.handleChange = e => {\n      const {\n        name,\n        value\n      } = e.target;\n      this.setState({\n        formData: { ...this.state.formData,\n          [name]: value\n        }\n      });\n    };\n\n    this.handleSubmit = async e => {\n      e.preventDefault();\n      const {\n        name,\n        code,\n        conversionRate\n      } = this.state.formData;\n      if (!name || !code || !conversionRate) return alert('Fill all fields');\n\n      if (this.state.editingId) {\n        await updateDoc(doc(db, 'currencies', this.state.editingId), {\n          name,\n          code,\n          conversionRate: parseFloat(conversionRate),\n          base: 'INR'\n        });\n        alert('Updated!');\n      } else {\n        await addDoc(collection(db, 'currencies'), {\n          name,\n          code,\n          conversionRate: parseFloat(conversionRate),\n          base: 'INR'\n        });\n        alert('Added!');\n      }\n\n      this.setState({\n        formData: {\n          name: '',\n          code: '',\n          conversionRate: ''\n        },\n        editingId: null\n      });\n      this.fetchCurrencies();\n    };\n\n    this.handleEdit = cur => {\n      this.setState({\n        formData: {\n          name: cur.name,\n          code: cur.code,\n          conversionRate: cur.conversionRate\n        },\n        editingId: cur.id\n      });\n    };\n\n    this.handleDelete = async id => {\n      if (window.confirm('Delete this currency?')) {\n        await deleteDoc(doc(db, 'currencies', id));\n        this.fetchCurrencies();\n      }\n    };\n  }\n\n  render() {\n    const {\n      currencies,\n      formData,\n      loading\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container mt-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex justify-content-between align-items-center mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 11\n      }\n    }, \"Currency Master (Base: INR)\"), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.syncLiveRates,\n      className: \"btn btn-success btn-sm\",\n      disabled: loading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }\n    }, loading ? 'Syncing...' : 'Sync Live Rates')), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      className: \"mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row g-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      className: \"form-control\",\n      name: \"name\",\n      placeholder: \"Currency Name\",\n      value: formData.name,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      className: \"form-control\",\n      name: \"code\",\n      placeholder: \"Code (USD)\",\n      value: formData.code,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"number\",\n      step: \"0.0001\",\n      className: \"form-control\",\n      name: \"conversionRate\",\n      placeholder: \"Rate vs INR\",\n      value: formData.conversionRate,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-primary w-100\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 15\n      }\n    }, this.state.editingId ? 'Update' : 'Add')))), /*#__PURE__*/React.createElement(\"table\", {\n      className: \"table table-sm table-bordered\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 15\n      }\n    }, \"#\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 15\n      }\n    }, \"Currency\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 15\n      }\n    }, \"Code\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 15\n      }\n    }, \"Rate (1 unit = ? INR)\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 15\n      }\n    }, \"Action\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 11\n      }\n    }, currencies.length > 0 ? currencies.map((c, i) => /*#__PURE__*/React.createElement(\"tr\", {\n      key: c.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 19\n      }\n    }, i + 1), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 19\n      }\n    }, c.name), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 19\n      }\n    }, c.code), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 19\n      }\n    }, c.conversionRate), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-sm btn-info me-2\",\n      onClick: () => this.handleEdit(c),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 21\n      }\n    }, \"Edit\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-sm btn-danger\",\n      onClick: () => this.handleDelete(c.id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 21\n      }\n    }, \"Delete\")))) : /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      colSpan: \"5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 19\n      }\n    }, \"No data found\")))));\n  }\n\n}\n\nexport default CurrencyPage;","map":{"version":3,"sources":["C:/Users/College/admin/StarAdmin-Free-React-Admin-Template-master/template/demo_1/src/app/inventory/invmaster/CurrencyPage.js"],"names":["React","Component","db","collection","addDoc","getDocs","updateDoc","deleteDoc","doc","CurrencyPage","state","currencies","formData","name","code","conversionRate","editingId","loading","componentDidMount","fetchCurrencies","snap","docs","map","d","id","data","setState","syncLiveRates","res","fetch","json","rates","alert","allRates","Object","entries","rate","base","existingSnap","deletePromises","Promise","all","cur","err","console","error","handleChange","e","value","target","handleSubmit","preventDefault","parseFloat","handleEdit","handleDelete","window","confirm","render","length","c","i"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { db } from '../../../firebase';\r\nimport { collection, addDoc, getDocs, updateDoc, deleteDoc, doc } from 'firebase/firestore';\r\n\r\nclass CurrencyPage extends Component {\r\n  state = {\r\n    currencies: [],\r\n    formData: { name: '', code: '', conversionRate: '' },\r\n    editingId: null,\r\n    loading: false,\r\n  };\r\n\r\n  componentDidMount = async () => {\r\n    this.fetchCurrencies();\r\n  };\r\n\r\n  fetchCurrencies = async () => {\r\n    const snap = await getDocs(collection(db, 'currencies'));\r\n    const currencies = snap.docs.map(d => ({ id: d.id, ...d.data() }));\r\n    this.setState({ currencies });\r\n  };\r\n\r\nsyncLiveRates = async () => {\r\n  try {\r\n    this.setState({ loading: true });\r\n    const res = await fetch('https://api.exchangerate.host/latest?base=INR&cors=true');\r\n    const data = await res.json();\r\n\r\n    if (!data.rates) {\r\n      alert('Failed to fetch live rates');\r\n      return;\r\n    }\r\n\r\n    const allRates = Object.entries(data.rates).map(([code, rate]) => ({\r\n      code,\r\n      name: code,\r\n      conversionRate: rate,\r\n      base: 'INR',\r\n    }));\r\n\r\n    // Remove old before re-syncing (optional, to avoid duplicates)\r\n    const existingSnap = await getDocs(collection(db, 'currencies'));\r\n    const deletePromises = existingSnap.docs.map(d => deleteDoc(doc(db, 'currencies', d.id)));\r\n    await Promise.all(deletePromises);\r\n\r\n    // Add all fresh rates\r\n    await Promise.all(allRates.map(cur => addDoc(collection(db, 'currencies'), cur)));\r\n\r\n    alert('Live rates synced successfully (Base: INR)');\r\n    this.fetchCurrencies();\r\n  } catch (err) {\r\n    console.error('Sync failed:', err);\r\n    alert('Error syncing live rates. Check internet/CORS.');\r\n  } finally {\r\n    this.setState({ loading: false });\r\n  }\r\n};\r\n\r\n  handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    this.setState({ formData: { ...this.state.formData, [name]: value } });\r\n  };\r\n\r\n  handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const { name, code, conversionRate } = this.state.formData;\r\n    if (!name || !code || !conversionRate) return alert('Fill all fields');\r\n\r\n    if (this.state.editingId) {\r\n      await updateDoc(doc(db, 'currencies', this.state.editingId), {\r\n        name, code, conversionRate: parseFloat(conversionRate), base: 'INR'\r\n      });\r\n      alert('Updated!');\r\n    } else {\r\n      await addDoc(collection(db, 'currencies'), {\r\n        name, code, conversionRate: parseFloat(conversionRate), base: 'INR'\r\n      });\r\n      alert('Added!');\r\n    }\r\n\r\n    this.setState({ formData: { name: '', code: '', conversionRate: '' }, editingId: null });\r\n    this.fetchCurrencies();\r\n  };\r\n\r\n  handleEdit = (cur) => {\r\n    this.setState({ formData: { name: cur.name, code: cur.code, conversionRate: cur.conversionRate }, editingId: cur.id });\r\n  };\r\n\r\n  handleDelete = async (id) => {\r\n    if (window.confirm('Delete this currency?')) {\r\n      await deleteDoc(doc(db, 'currencies', id));\r\n      this.fetchCurrencies();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { currencies, formData, loading } = this.state;\r\n\r\n    return (\r\n      <div className=\"container mt-3\">\r\n        <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n          <h4>Currency Master (Base: INR)</h4>\r\n          <button\r\n            onClick={this.syncLiveRates}\r\n            className=\"btn btn-success btn-sm\"\r\n            disabled={loading}\r\n          >\r\n            {loading ? 'Syncing...' : 'Sync Live Rates'}\r\n          </button>\r\n        </div>\r\n\r\n        {/* Manual Form */}\r\n        <form onSubmit={this.handleSubmit} className=\"mb-3\">\r\n          <div className=\"row g-2\">\r\n            <div className=\"col-md-3\">\r\n              <input\r\n                type=\"text\"\r\n                className=\"form-control\"\r\n                name=\"name\"\r\n                placeholder=\"Currency Name\"\r\n                value={formData.name}\r\n                onChange={this.handleChange}\r\n              />\r\n            </div>\r\n            <div className=\"col-md-2\">\r\n              <input\r\n                type=\"text\"\r\n                className=\"form-control\"\r\n                name=\"code\"\r\n                placeholder=\"Code (USD)\"\r\n                value={formData.code}\r\n                onChange={this.handleChange}\r\n              />\r\n            </div>\r\n            <div className=\"col-md-2\">\r\n              <input\r\n                type=\"number\"\r\n                step=\"0.0001\"\r\n                className=\"form-control\"\r\n                name=\"conversionRate\"\r\n                placeholder=\"Rate vs INR\"\r\n                value={formData.conversionRate}\r\n                onChange={this.handleChange}\r\n              />\r\n            </div>\r\n            <div className=\"col-md-2\">\r\n              <button className=\"btn btn-primary w-100\">\r\n                {this.state.editingId ? 'Update' : 'Add'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n\r\n        {/* Table */}\r\n        <table className=\"table table-sm table-bordered\">\r\n          <thead>\r\n            <tr>\r\n              <th>#</th>\r\n              <th>Currency</th>\r\n              <th>Code</th>\r\n              <th>Rate (1 unit = ? INR)</th>\r\n              <th>Action</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {currencies.length > 0 ? (\r\n              currencies.map((c, i) => (\r\n                <tr key={c.id}>\r\n                  <td>{i + 1}</td>\r\n                  <td>{c.name}</td>\r\n                  <td>{c.code}</td>\r\n                  <td>{c.conversionRate}</td>\r\n                  <td>\r\n                    <button\r\n                      className=\"btn btn-sm btn-info me-2\"\r\n                      onClick={() => this.handleEdit(c)}\r\n                    >Edit</button>\r\n                    <button\r\n                      className=\"btn btn-sm btn-danger\"\r\n                      onClick={() => this.handleDelete(c.id)}\r\n                    >Delete</button>\r\n                  </td>\r\n                </tr>\r\n              ))\r\n            ) : (\r\n              <tr><td colSpan=\"5\">No data found</td></tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CurrencyPage;\r\n"]},"metadata":{},"sourceType":"module"}